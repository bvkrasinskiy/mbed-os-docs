<!DOCTYPE html>
<html>
    
<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto__values_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:22:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        
        <meta charset="utf-8"/>
        <title>Mbed OS Reference | crypto_values.h Source File</title>
        <link href="../static/css/vendor/foundation-6.2.4.min.mbed-cache-4c48f6c816971070eb1e4eca75f0ec30.css" rel="stylesheet"/>
        <link href="search/search.css" rel="stylesheet"/>
        <link href="../static/css/app.mbed-cache-a44289fe9f5ca07036a335d6ad7ed8ad.css" rel="stylesheet"/>
        <script src="../static/js/vendor/jquery-3.2.1.min.mbed-cache-c9f5aeeca3ad37bf2aa006139b935f0a.js"></script>
        <script src="dynsections.js"></script>
        <script src="search/searchdata.js"></script>
        <script src="search/search.js"></script>
        <script>
            $(document).ready(function() {
                init_search();
            });
        </script>
    
        

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1447836-8');
ga('require', 'GTM-WXMLD4S')
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl+'&gtm_auth=SMYNPwM0ICsV00c1ZHETqQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M6FZ495');</script>


    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:971746,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>



<!-- Favicons -->
<link rel="apple-touch-icon" sizes="57x57" href="../../../../static/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../../static/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../../static/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../../static/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../../static/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../../static/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../../../static/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../../../static/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../../../static/img/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../../../static/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../static/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../../../static/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../static/img/favicons/favicon-16x16.png">
<link rel="manifest" href="https://os.mbed.com/static/img/favicons/manifest.json">
<link rel="shortcut icon" href="https://os.mbed.com/static/img/favicon.ico?">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">

<link rel="stylesheet" href="../../../../static/CACHE/css/output.811e2930ab34.css" type="text/css">

<link href="../../../../static/docs/css/doc_viewer.css" rel="stylesheet">
<link href="../../../../static/fonts.css" rel="stylesheet">
<link href="../../../../static/docs-nav-and-footer1b26.css?v2" rel="stylesheet">


<link rel="canonical" href="_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto__values_8h_source.html">
<script src="../../../../static/mbed-nav-vertical-menu.js"></script>


    </head>
    <body>
        








<div class="mbed-nav">
    <div class="mbed-nav__mobile-menu-control">
        <i class="mbed-nav__mobile-menu-control-open fas fa-bars fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-close fas fa-times is-hidden fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-back fas fa-angle-left is-hidden fa-fw"></i>
    </div>
    <div class="mbed-nav__logo">
        <a href="https://os.mbed.com/">
            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#logo"></use></svg>
        </a>
    </div>
    <div class="mbed-nav__menu">

        <!-- Main menu -->
        <nav class="mbed-nav__main-menu">
            <ul class="mbed-nav__dropdown-menu">
                <li class="has-dropdown">
                    Overview

                    <div class="mbed-nav__dropdown-menu-content">

                        <!-- Overview dropdown menu -->
                        <div class="mbed-nav__overview-menu">
                            <section>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <div>
                                                <p>Mbed OS</p>
                                                <p>The open source OS for Cortex-M devices</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link-detail">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <div>
                                                <p>Keil Studio Cloud</p>
                                                <p>Arm's IDE for IoT, embedded and Mbed development</p>
                                            </div>
                                         </a>
                                     </li>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <div>
                                                <p>Mbed Studio</p>
                                                <p>Download the desktop IDE for Mbed OS</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link-detail">

                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <div>
                                               <p>Mbed CLI</p>
                                               <p>Command line access to Mbed tools and services</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Security and Connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <div>
                                                <p>Mbed TLS and Mbed Crypto</p>
                                                <p>Industry standard TLS stack and crypto library</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <div>
                                                <p>Connectivity</p>
                                                <p>BLE, WiFi, Cellular, LoRaWAN and more</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </li>
                <li class="has-dropdown">
                    Hardware

                    <!-- Hardware dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__hardware-dropdown">
                            <ul class="mbed-nav__hardware-menu">
                                <li>
                                    <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                        <div>
                                            <p>Boards</p>
                                            <p>Build your Mbed projects with development boards for Arm Cortex processors and MCUs</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                        <div>
                                            <p>Modules</p>
                                            <p>Modules include a MCU, connectivity and onboard memory, making them ideal for designing IoT products for mass production</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                        <div>
                                            <p>Components</p>
                                            <p>The component database hosts libraries for different sensors, actuators, radios, inputs, middleware and IoT services</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                        <div>
                                            <p>Hardware overview & Mbed Enabled</p>
                                            <p>Learn about hardware support for Mbed, as well as the Mbed Enabled program, which identifies Mbed compatible products</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                        <div>
                                            <p>Mbed HDK</p>
                                            <p>Reference designs, schematics and board layouts to develop production hardware and Mbed-compatible development boards</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li class="has-dropdown">
                    Documentation

                    <!-- Documentation dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__documentation-dropdown">
                            <ul class="mbed-nav__documentation-menu">
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a>
                                </li>
                                <li>
                                    <a
                                        href="https://developer.arm.com/documentation/102497/latest/Arm-Keil-Studio-Cloud">
                                        Keil Studio
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li class="has-dropdown">
                    Community

                    <!-- Community dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__community-dropdown">
                            <ul class="mbed-nav__community-menu">
                                <li>
                                    <a href="https://forums.mbed.com/">Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a>
                                </li>
                                <li>
                                    <a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/support/">Report a problem</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://os.mbed.com/blog/">Blog</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="mbed-nav__user-controls">
        <div class="mbed-nav__user-controls-top">
            <div class="mbed-nav__search">
                <form id="mbed-nav__search-box" class="is-hidden" action="https://os.mbed.com/search" method="GET">
                    <div class="mbed-nav__search-box">
                        <input type="search" name="q" placeholder="Search...">
                        <button type="submit">
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                        </button>
                    </div>
                </form>
                <i class="mbed-nav__search-close fas fa-times is-hidden"></i>
                <svg class="mbed-nav__search-open stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
            </div>
            <a class="mbed-nav__cta" href="https://studio.keil.arm.com/mbed" target="_blank">
                Keil Studio Cloud
            </a>

            
                
                <nav class="mbed-nav__logged-out-nav">
                    <ul class="mbed-nav__dropdown-menu">
                        <li>
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#profile"></use></svg>

                            <!-- Logged out dropdown menu -->
                            <div class="mbed-nav__dropdown-menu-content">
                                <div class="mbed-nav__logged-out-dropdown">
                                    <ul class="mbed-nav__logged-out-menu">
                                        <li><a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto__values_8h_source.html">Log in or Sign up</a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </nav>
                
            
        </div>
    </div>
    <div class="mbed-nav__spacer"></div>
</div>
<div class="mbed-nav__mobile-menu-cover is-hidden">
    <div class="mbed-nav__mobile-menu">

        <div id="mbed-nav__main-menu-mobile">
            <div class="mbed-nav__user-controls-mobile">
                <div class="mbed-nav__user-controls-top-mobile">
                    <form action="https://os.mbed.com/search" method="GET">
                        <div class="mbed-nav__search-box mbed-nav__search-box--light">
                            <input type="search" name="q" placeholder="Search...">
                            <button type="submit">
                                <svg class="stroke-dark-grey"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                            </button>
                        </div>
                    </form>
                    
                        
                        <a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto__values_8h_source.html">Log in or Sign up</a>
                        
                    
                </div>
            </div>

            <ul class="mbed-nav__side-menu">
                <li>
                    <input type="checkbox" name="accordion-toggle" id="overview-accordion">
                    <label for="overview-accordion">Overview</label>
                    <div class="accordion_content">
                        <ul class="overview-menu-mobile">
                            <li>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <p>Mbed OS</p>
                                        </a>
                                    </li>
                                    

                                </ul>
                            </li>
                            <li>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <p>Mbed Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <p>Keil Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <p>Mbed CLI</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Security and connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <p>Mbed TLS and Mbed Crypto</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <p>Connectivity</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="hardware-accordion">
                    <label for="hardware-accordion">Hardware</label>
                    <div class="accordion_content">
                        <ul>
                            <li>
                                <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                    <p>Boards</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                    <p>Modules</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                    <p>Components</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                    <p>Hardware overview & Mbed Enabled</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                    <p>Mbed HDK</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="documentation-accordion">
                    <label for="documentation-accordion">Documentation</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a></li>
                            <li>
                              <a
                                href="https://developer.arm.com/documentation/102497/1-5/Arm-Keil-Studio/?utm_source=mbed_com&amp;utm_medium=nav_docs_link&amp;utm_campaign=mbed_com_promo">
                                Keil Studio
                              </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="community-accordion">
                    <label for="community-accordion">Community</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://forums.mbed.com/">Forum</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a></li>
                            <li><a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a></li>
                            <li><a href="https://os.mbed.com/support/">Report a problem</a></li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/blog/">Blog</a></li>
            </ul>
        </div>

        
    </div>
</div>



<div class="version-picker-container">
    
    <select class="version-picker" onchange="goToVersion(this.value)">
        
            <option
                value="v6.16"
                selected
            >
                v6.16
            </option>
        
            <option
                value="v6.15"
                
            >
                v6.15
            </option>
        
            <option
                value="v6.14"
                
            >
                v6.14
            </option>
        
            <option
                value="v6.13"
                
            >
                v6.13
            </option>
        
            <option
                value="v6.12"
                
            >
                v6.12
            </option>
        
            <option
                value="v6.11"
                
            >
                v6.11
            </option>
        
            <option
                value="v6.10"
                
            >
                v6.10
            </option>
        
            <option
                value="v6.9"
                
            >
                v6.9
            </option>
        
            <option
                value="v6.8"
                
            >
                v6.8
            </option>
        
            <option
                value="v6.7"
                
            >
                v6.7
            </option>
        
            <option
                value="v6.6"
                
            >
                v6.6
            </option>
        
            <option
                value="v6.5"
                
            >
                v6.5
            </option>
        
            <option
                value="v5.15"
                
            >
                v5.15
            </option>
        
    </select>
    

    <div class="contact-us">
        Mistake on this page?
        
            <br>
            <a href="https://github.com/ARMmbed/mbed-os-5-docs/issues">
                Report an issue in GitHub
                <i class="fab fa-github"></i>
            </a>
            or
            <a href="mailto:mbed-support@arm.com">
                email us
                <i class="fas fa-envelope"></i>
            </a>
        
    </div>
</div>

<script>
    function goToVersion(version) {
        window.location.href = window.location.href.replace(
            "v6.16",
            version
        )
    }
</script>

        
        <div class="topbar" id="top">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div class="tabs" id="navrow1">
    <ul class="tablist">
      <li><a href="index.html"><span>Main Page</span></a></li>
      <li><a href="pages.html"><span>Related Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div class="MSearchBoxInactive" id="MSearchBox">
        <span class="left">
          <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png"/>
          <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
          </span><span class="right">
            <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png"/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2" id="navrow2">
    <ul class="tablist">
      <li><a href="files.html"><span>File List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="navpath" id="nav-path">
  <ul>
<li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_d00fafdb9414f6e624fcf4d73ffde065.html">platform</a></li><li class="navelem"><a class="el" href="dir_a72924067aea8bbead751f11070268f4.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_007a19531d3d09289f9f9c2cf309e91b.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_f848b01736a8144ccc7db772a4ca6d7a.html">TARGET_TFM</a></li><li class="navelem"><a class="el" href="dir_807bd2952b6f786fae221e48f236bdf3.html">TARGET_TFM_LATEST</a></li><li class="navelem"><a class="el" href="dir_2bce1ae48bbcac941003fbb8c1ded815.html">include</a></li><li class="navelem"><a class="el" href="dir_5f1072194fb5e8d4ad3d7d2a1e7a914b.html">psa</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TARGET_TFM/TARGET_TFM_LATEST/include/psa/crypto_values.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> <span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> <span class="comment"> * Copyright (c) 2018-2021, Arm Limited. All rights reserved.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span> <span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span> <span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span> <span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span> <span class="comment"> */</span><span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span> <span class="comment">/**</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span> <span class="comment"> * \file psa/crypto_values.h</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span> <span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span> <span class="comment"> * \brief PSA cryptography module: macros to build and analyze integer values.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span> <span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span> <span class="comment"> * \note This file may not be included directly. Applications must</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span> <span class="comment"> * include psa/crypto.h. Drivers must include the appropriate driver</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span> <span class="comment"> * header file.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span> <span class="comment"> *</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span> <span class="comment"> * This file contains portable definitions of macros to build and analyze</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span> <span class="comment"> * values of integral types that encode properties of cryptographic keys,</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span> <span class="comment"> * designations of cryptographic algorithms, and error codes returned by</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span> <span class="comment"> * the library.</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span> <span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span> <span class="comment"> * This header file only defines preprocessor macros.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span> <span class="comment"> */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span> </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span> <span class="preprocessor">#ifndef PSA_CRYPTO_VALUES_H</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span> <span class="preprocessor">#define PSA_CRYPTO_VALUES_H</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span> </div><div class="line"><a name="l00027"></a><span class="lineno">   27</span> <span class="preprocessor">#include "mbedtls_svc_key_id.h"</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span> <span class="comment"></span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span> <span class="comment">/** \defgroup error Error codes</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span> <span class="comment"> * @{</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span> <span class="comment"> */</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span> </div><div class="line"><a name="l00033"></a><span class="lineno">   33</span> <span class="comment">/* PSA error codes */</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span> <span class="comment"></span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span> <span class="comment">/** The action was completed successfully. */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span> <span class="preprocessor">#ifndef PSA_SUCCESS</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1">   37</a></span> <span class="preprocessor">#define PSA_SUCCESS ((psa_status_t)0)</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span> <span class="comment"></span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span> <span class="comment">/** An error occurred that does not correspond to any defined</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span> <span class="comment"> * failure cause.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span> <span class="comment"> *</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span> <span class="comment"> * Implementations may use this error code if none of the other standard</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span> <span class="comment"> * error codes are applicable. */</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="group__error.html#ga8bfafd6baac18ce5d3192d1de256238f">   45</a></span> <span class="preprocessor">#define PSA_ERROR_GENERIC_ERROR         ((psa_status_t)-132)</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span> <span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span> <span class="comment">/** The requested operation or a parameter is not supported</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span> <span class="comment"> * by this implementation.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span> <span class="comment"> *</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span> <span class="comment"> * Implementations should return this error code when an enumeration</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span> <span class="comment"> * parameter such as a key type, algorithm, etc. is not recognized.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span> <span class="comment"> * If a combination of parameters is recognized and identified as</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span> <span class="comment"> * not valid, return #PSA_ERROR_INVALID_ARGUMENT instead. */</span></div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd">   54</a></span> <span class="preprocessor">#define PSA_ERROR_NOT_SUPPORTED         ((psa_status_t)-134)</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span> <span class="comment"></span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span> <span class="comment">/** The requested action is denied by a policy.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span> <span class="comment"> *</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span> <span class="comment"> * Implementations should return this error code when the parameters</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span> <span class="comment"> * are recognized as valid and supported, and a policy explicitly</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span> <span class="comment"> * denies the requested operation.</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span> <span class="comment"> *</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span> <span class="comment"> * If a subset of the parameters of a function call identify a</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span> <span class="comment"> * forbidden operation, and another subset of the parameters are</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span> <span class="comment"> * not valid or not supported, it is unspecified whether the function</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span> <span class="comment"> * returns #PSA_ERROR_NOT_PERMITTED, #PSA_ERROR_NOT_SUPPORTED or</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span> <span class="comment"> * #PSA_ERROR_INVALID_ARGUMENT. */</span></div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1">   67</a></span> <span class="preprocessor">#define PSA_ERROR_NOT_PERMITTED         ((psa_status_t)-133)</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span> <span class="comment"></span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span> <span class="comment">/** An output buffer is too small.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span> <span class="comment"> *</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span> <span class="comment"> * Applications can call the \c PSA_xxx_SIZE macro listed in the function</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span> <span class="comment"> * description to determine a sufficient buffer size.</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span> <span class="comment"> *</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span> <span class="comment"> * Implementations should preferably return this error code only</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span> <span class="comment"> * in cases when performing the operation with a larger output</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span> <span class="comment"> * buffer would succeed. However implementations may return this</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span> <span class="comment"> * error if a function has invalid or unsupported parameters in addition</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span> <span class="comment"> * to the parameters that determine the necessary output buffer size. */</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8">   79</a></span> <span class="preprocessor">#define PSA_ERROR_BUFFER_TOO_SMALL      ((psa_status_t)-138)</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span> <span class="comment"></span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span> <span class="comment">/** Asking for an item that already exists</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span> <span class="comment"> *</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span> <span class="comment"> * Implementations should return this error, when attempting</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span> <span class="comment"> * to write an item (like a key) that already exists. */</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="group__error.html#gaf2b34cc87edc72f3ba90071a08210d20">   85</a></span> <span class="preprocessor">#define PSA_ERROR_ALREADY_EXISTS        ((psa_status_t)-139)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span> <span class="comment"></span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span> <span class="comment">/** Asking for an item that doesn't exist</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span> <span class="comment"> *</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span> <span class="comment"> * Implementations should return this error, if a requested item (like</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span> <span class="comment"> * a key) does not exist. */</span></div><div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="group__error.html#ga18646babb2ae6cbde02ea3828bbd9141">   91</a></span> <span class="preprocessor">#define PSA_ERROR_DOES_NOT_EXIST        ((psa_status_t)-140)</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span> <span class="comment"></span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span> <span class="comment">/** The requested action cannot be performed in the current state.</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span> <span class="comment"> *</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span> <span class="comment"> * Multipart operations return this error when one of the</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span> <span class="comment"> * functions is called out of sequence. Refer to the function</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span> <span class="comment"> * descriptions for permitted sequencing of functions.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span> <span class="comment"> *</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span> <span class="comment"> * Implementations shall not return this error code to indicate</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span> <span class="comment"> * that a key either exists or not,</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span> <span class="comment"> * but shall instead return #PSA_ERROR_ALREADY_EXISTS or #PSA_ERROR_DOES_NOT_EXIST</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span> <span class="comment"> * as applicable.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span> <span class="comment"> *</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span> <span class="comment"> * Implementations shall not return this error code to indicate that a</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span> <span class="comment"> * key identifier is invalid, but shall return #PSA_ERROR_INVALID_HANDLE</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span> <span class="comment"> * instead. */</span></div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84">  107</a></span> <span class="preprocessor">#define PSA_ERROR_BAD_STATE             ((psa_status_t)-137)</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span> <span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span> <span class="comment">/** The parameters passed to the function are invalid.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span> <span class="comment"> *</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span> <span class="comment"> * Implementations may return this error any time a parameter or</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span> <span class="comment"> * combination of parameters are recognized as invalid.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span> <span class="comment"> *</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span> <span class="comment"> * Implementations shall not return this error code to indicate that a</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span> <span class="comment"> * key identifier is invalid, but shall return #PSA_ERROR_INVALID_HANDLE</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span> <span class="comment"> * instead.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span> <span class="comment"> */</span></div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f">  118</a></span> <span class="preprocessor">#define PSA_ERROR_INVALID_ARGUMENT      ((psa_status_t)-135)</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span> <span class="comment"></span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span> <span class="comment">/** There is not enough runtime memory.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span> <span class="comment"> *</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span> <span class="comment"> * If the action is carried out across multiple security realms, this</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span> <span class="comment"> * error can refer to available memory in any of the security realms. */</span></div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5">  124</a></span> <span class="preprocessor">#define PSA_ERROR_INSUFFICIENT_MEMORY   ((psa_status_t)-141)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span> <span class="comment"></span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span> <span class="comment">/** There is not enough persistent storage.</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span> <span class="comment"> *</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span> <span class="comment"> * Functions that modify the key storage return this error code if</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span> <span class="comment"> * there is insufficient storage space on the host media. In addition,</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span> <span class="comment"> * many functions that do not otherwise access storage may return this</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span> <span class="comment"> * error code if the implementation requires a mandatory log entry for</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span> <span class="comment"> * the requested action and the log storage space is full. */</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="group__error.html#ga897a45eb206a6f6b7be7ffbe36f0d766">  133</a></span> <span class="preprocessor">#define PSA_ERROR_INSUFFICIENT_STORAGE  ((psa_status_t)-142)</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span> <span class="comment"></span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span> <span class="comment">/** There was a communication failure inside the implementation.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span> <span class="comment"> *</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span> <span class="comment"> * This can indicate a communication failure between the application</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span> <span class="comment"> * and an external cryptoprocessor or between the cryptoprocessor and</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span> <span class="comment"> * an external volatile or persistent memory. A communication failure</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span> <span class="comment"> * may be transient or permanent depending on the cause.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span> <span class="comment"> *</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span> <span class="comment"> * \warning If a function returns this error, it is undetermined</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span> <span class="comment"> * whether the requested action has completed or not. Implementations</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span> <span class="comment"> * should return #PSA_SUCCESS on successful completion whenever</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span> <span class="comment"> * possible, however functions may return #PSA_ERROR_COMMUNICATION_FAILURE</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span> <span class="comment"> * if the requested action was completed successfully in an external</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span> <span class="comment"> * cryptoprocessor but there was a breakdown of communication before</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span> <span class="comment"> * the cryptoprocessor could report the status to the application.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span> <span class="comment"> */</span></div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7">  150</a></span> <span class="preprocessor">#define PSA_ERROR_COMMUNICATION_FAILURE ((psa_status_t)-145)</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span> <span class="comment"></span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span> <span class="comment">/** There was a storage failure that may have led to data loss.</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span> <span class="comment"> *</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span> <span class="comment"> * This error indicates that some persistent storage is corrupted.</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span> <span class="comment"> * It should not be used for a corruption of volatile memory</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span> <span class="comment"> * (use #PSA_ERROR_CORRUPTION_DETECTED), for a communication error</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span> <span class="comment"> * between the cryptoprocessor and its external storage (use</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span> <span class="comment"> * #PSA_ERROR_COMMUNICATION_FAILURE), or when the storage is</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span> <span class="comment"> * in a valid state but is full (use #PSA_ERROR_INSUFFICIENT_STORAGE).</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span> <span class="comment"> *</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span> <span class="comment"> * Note that a storage failure does not indicate that any data that was</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span> <span class="comment"> * previously read is invalid. However this previously read data may no</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span> <span class="comment"> * longer be readable from storage.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span> <span class="comment"> *</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span> <span class="comment"> * When a storage failure occurs, it is no longer possible to ensure</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span> <span class="comment"> * the global integrity of the keystore. Depending on the global</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span> <span class="comment"> * integrity guarantees offered by the implementation, access to other</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span> <span class="comment"> * data may or may not fail even if the data is still readable but</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span> <span class="comment"> * its integrity cannot be guaranteed.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span> <span class="comment"> *</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span> <span class="comment"> * Implementations should only use this error code to report a</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span> <span class="comment"> * permanent storage corruption. However application writers should</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span> <span class="comment"> * keep in mind that transient errors while reading the storage may be</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span> <span class="comment"> * reported using this error code. */</span></div><div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d">  175</a></span> <span class="preprocessor">#define PSA_ERROR_STORAGE_FAILURE       ((psa_status_t)-146)</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span> <span class="comment"></span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span> <span class="comment">/** A hardware failure was detected.</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span> <span class="comment"> *</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span> <span class="comment"> * A hardware failure may be transient or permanent depending on the</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span> <span class="comment"> * cause. */</span></div><div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b">  181</a></span> <span class="preprocessor">#define PSA_ERROR_HARDWARE_FAILURE      ((psa_status_t)-147)</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span> <span class="comment"></span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span> <span class="comment">/** A tampering attempt was detected.</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span> <span class="comment"> *</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span> <span class="comment"> * If an application receives this error code, there is no guarantee</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span> <span class="comment"> * that previously accessed or computed data was correct and remains</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span> <span class="comment"> * confidential. Applications should not perform any security function</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span> <span class="comment"> * and should enter a safe failure state.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span> <span class="comment"> *</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span> <span class="comment"> * Implementations may return this error code if they detect an invalid</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span> <span class="comment"> * state that cannot happen during normal operation and that indicates</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span> <span class="comment"> * that the implementation's security guarantees no longer hold. Depending</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span> <span class="comment"> * on the implementation architecture and on its security and safety goals,</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span> <span class="comment"> * the implementation may forcibly terminate the application.</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span> <span class="comment"> *</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span> <span class="comment"> * This error code is intended as a last resort when a security breach</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span> <span class="comment"> * is detected and it is unsure whether the keystore data is still</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span> <span class="comment"> * protected. Implementations shall only return this error code</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span> <span class="comment"> * to report an alarm from a tampering detector, to indicate that</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span> <span class="comment"> * the confidentiality of stored data can no longer be guaranteed,</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span> <span class="comment"> * or to indicate that the integrity of previously returned data is now</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span> <span class="comment"> * considered compromised. Implementations shall not use this error code</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span> <span class="comment"> * to indicate a hardware failure that merely makes it impossible to</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span> <span class="comment"> * perform the requested operation (use #PSA_ERROR_COMMUNICATION_FAILURE,</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span> <span class="comment"> * #PSA_ERROR_STORAGE_FAILURE, #PSA_ERROR_HARDWARE_FAILURE,</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span> <span class="comment"> * #PSA_ERROR_INSUFFICIENT_ENTROPY or other applicable error code</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span> <span class="comment"> * instead).</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span> <span class="comment"> *</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span> <span class="comment"> * This error indicates an attack against the application. Implementations</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span> <span class="comment"> * shall not return this error code as a consequence of the behavior of</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span> <span class="comment"> * the application itself. */</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950">  212</a></span> <span class="preprocessor">#define PSA_ERROR_CORRUPTION_DETECTED    ((psa_status_t)-151)</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span> <span class="comment"></span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span> <span class="comment">/** There is not enough entropy to generate random data needed</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span> <span class="comment"> * for the requested action.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span> <span class="comment"> *</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span> <span class="comment"> * This error indicates a failure of a hardware random generator.</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span> <span class="comment"> * Application writers should note that this error can be returned not</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span> <span class="comment"> * only by functions whose purpose is to generate random data, such</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span> <span class="comment"> * as key, IV or nonce generation, but also by functions that execute</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span> <span class="comment"> * an algorithm with a randomized result, as well as functions that</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span> <span class="comment"> * use randomization of intermediate computations as a countermeasure</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span> <span class="comment"> * to certain attacks.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span> <span class="comment"> *</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span> <span class="comment"> * Implementations should avoid returning this error after psa_crypto_init()</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span> <span class="comment"> * has succeeded. Implementations should generate sufficient</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span> <span class="comment"> * entropy during initialization and subsequently use a cryptographically</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span> <span class="comment"> * secure pseudorandom generator (PRNG). However implementations may return</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span> <span class="comment"> * this error at any time if a policy requires the PRNG to be reseeded</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span> <span class="comment"> * during normal operation. */</span></div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="group__error.html#ga4deb59fec02297ec5d8b42178323f675">  231</a></span> <span class="preprocessor">#define PSA_ERROR_INSUFFICIENT_ENTROPY  ((psa_status_t)-148)</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span> <span class="comment"></span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span> <span class="comment">/** The signature, MAC or hash is incorrect.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span> <span class="comment"> *</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span> <span class="comment"> * Verification functions return this error if the verification</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span> <span class="comment"> * calculations completed successfully, and the value to be verified</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span> <span class="comment"> * was determined to be incorrect.</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span> <span class="comment"> *</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span> <span class="comment"> * If the value to verify has an invalid size, implementations may return</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span> <span class="comment"> * either #PSA_ERROR_INVALID_ARGUMENT or #PSA_ERROR_INVALID_SIGNATURE. */</span></div><div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2">  241</a></span> <span class="preprocessor">#define PSA_ERROR_INVALID_SIGNATURE     ((psa_status_t)-149)</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span> <span class="comment"></span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span> <span class="comment">/** The decrypted padding is incorrect.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span> <span class="comment"> *</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span> <span class="comment"> * \warning In some protocols, when decrypting data, it is essential that</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span> <span class="comment"> * the behavior of the application does not depend on whether the padding</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span> <span class="comment"> * is correct, down to precise timing. Applications should prefer</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span> <span class="comment"> * protocols that use authenticated encryption rather than plain</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span> <span class="comment"> * encryption. If the application must perform a decryption of</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span> <span class="comment"> * unauthenticated data, the application writer should take care not</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span> <span class="comment"> * to reveal whether the padding is invalid.</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span> <span class="comment"> *</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span> <span class="comment"> * Implementations should strive to make valid and invalid padding</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span> <span class="comment"> * as close as possible to indistinguishable to an external observer.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span> <span class="comment"> * In particular, the timing of a decryption operation should not</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span> <span class="comment"> * depend on the validity of the padding. */</span></div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="group__error.html#gabe29594edbfb152cf153975b0597ac48">  257</a></span> <span class="preprocessor">#define PSA_ERROR_INVALID_PADDING       ((psa_status_t)-150)</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span> <span class="comment"></span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span> <span class="comment">/** Return this error when there's insufficient data when attempting</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span> <span class="comment"> * to read from a resource. */</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="group__error.html#ga086ac09f3a555f86e7997beb186f5eef">  261</a></span> <span class="preprocessor">#define PSA_ERROR_INSUFFICIENT_DATA     ((psa_status_t)-143)</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span> <span class="comment"></span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span> <span class="comment">/** The key identifier is not valid. See also :ref:\`key-handles\`.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span> <span class="comment"> */</span></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="group__error.html#gadf22718935657c2c3168c228204085f9">  265</a></span> <span class="preprocessor">#define PSA_ERROR_INVALID_HANDLE        ((psa_status_t)-136)</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span> <span class="comment"></span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span> <span class="comment">/** Stored data has been corrupted.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span> <span class="comment"> *</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span> <span class="comment"> * This error indicates that some persistent storage has suffered corruption.</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span> <span class="comment"> * It does not indicate the following situations, which have specific error</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span> <span class="comment"> * codes:</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span> <span class="comment"> *</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span> <span class="comment"> * - A corruption of volatile memory - use #PSA_ERROR_CORRUPTION_DETECTED.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span> <span class="comment"> * - A communication error between the cryptoprocessor and its external</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span> <span class="comment"> *   storage - use #PSA_ERROR_COMMUNICATION_FAILURE.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span> <span class="comment"> * - When the storage is in a valid state but is full - use</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span> <span class="comment"> *   #PSA_ERROR_INSUFFICIENT_STORAGE.</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span> <span class="comment"> * - When the storage fails for other reasons - use</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span> <span class="comment"> *   #PSA_ERROR_STORAGE_FAILURE.</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span> <span class="comment"> * - When the stored data is not valid - use #PSA_ERROR_DATA_INVALID.</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span> <span class="comment"> *</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span> <span class="comment"> * \note A storage corruption does not indicate that any data that was</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span> <span class="comment"> * previously read is invalid. However this previously read data might no</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span> <span class="comment"> * longer be readable from storage.</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span> <span class="comment"> *</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span> <span class="comment"> * When a storage failure occurs, it is no longer possible to ensure the</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span> <span class="comment"> * global integrity of the keystore.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span> <span class="comment"> */</span></div><div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="group__error.html#ga9febb81a44bdeb4c6c42bf4f697b13bf">  289</a></span> <span class="preprocessor">#define PSA_ERROR_DATA_CORRUPT          ((psa_status_t)-152)</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span> <span class="comment"></span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span> <span class="comment">/** Data read from storage is not valid for the implementation.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span> <span class="comment"> *</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span> <span class="comment"> * This error indicates that some data read from storage does not have a valid</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span> <span class="comment"> * format. It does not indicate the following situations, which have specific</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span> <span class="comment"> * error codes:</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span> <span class="comment"> *</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span> <span class="comment"> * - When the storage or stored data is corrupted - use #PSA_ERROR_DATA_CORRUPT</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span> <span class="comment"> * - When the storage fails for other reasons - use #PSA_ERROR_STORAGE_FAILURE</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span> <span class="comment"> * - An invalid argument to the API - use #PSA_ERROR_INVALID_ARGUMENT</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span> <span class="comment"> *</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span> <span class="comment"> * This error is typically a result of either storage corruption on a</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span> <span class="comment"> * cleartext storage backend, or an attempt to read data that was</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span> <span class="comment"> * written by an incompatible version of the library.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span> <span class="comment"> */</span></div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="group__error.html#gacebfbd25a7c2a727694fb57182a66533">  305</a></span> <span class="preprocessor">#define PSA_ERROR_DATA_INVALID          ((psa_status_t)-153)</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span> <span class="comment"></span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span> <span class="comment"></span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span> <span class="comment">/** \defgroup crypto_types Key and algorithm types</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span> <span class="comment"> * @{</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span> <span class="comment"> */</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span> <span class="comment"></span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span> <span class="comment">/** An invalid key type value.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span> <span class="comment"> *</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span> <span class="comment"> * Zero is not the encoding of any key type.</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span> <span class="comment"> */</span></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gafce7ab2b54ce97ea5bff73f13a9f3e5b">  317</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_NONE                           ((psa_key_type_t)0x0000)</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span> <span class="comment"></span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span> <span class="comment">/** Vendor-defined key type flag.</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span> <span class="comment"> *</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span> <span class="comment"> * Key types defined by this standard will never have the</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span> <span class="comment"> * #PSA_KEY_TYPE_VENDOR_FLAG bit set. Vendors who define additional key types</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span> <span class="comment"> * must use an encoding with the #PSA_KEY_TYPE_VENDOR_FLAG bit set and should</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span> <span class="comment"> * respect the bitwise structure used by standard encodings whenever practical.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span> <span class="comment"> */</span></div><div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga8dbaed2fdb1ebae8aa127ad3988516f7">  326</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_VENDOR_FLAG                    ((psa_key_type_t)0x8000)</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span> </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span> <span class="preprocessor">#define PSA_KEY_TYPE_CATEGORY_MASK                  ((psa_key_type_t)0x7000)</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span> <span class="preprocessor">#define PSA_KEY_TYPE_CATEGORY_RAW                   ((psa_key_type_t)0x1000)</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span> <span class="preprocessor">#define PSA_KEY_TYPE_CATEGORY_SYMMETRIC             ((psa_key_type_t)0x2000)</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span> <span class="preprocessor">#define PSA_KEY_TYPE_CATEGORY_PUBLIC_KEY            ((psa_key_type_t)0x4000)</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span> <span class="preprocessor">#define PSA_KEY_TYPE_CATEGORY_KEY_PAIR              ((psa_key_type_t)0x7000)</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span> </div><div class="line"><a name="l00334"></a><span class="lineno">  334</span> <span class="preprocessor">#define PSA_KEY_TYPE_CATEGORY_FLAG_PAIR             ((psa_key_type_t)0x3000)</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span> <span class="comment"></span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span> <span class="comment">/** Whether a key type is vendor-defined.</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span> <span class="comment"> *</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span> <span class="comment"> * See also #PSA_KEY_TYPE_VENDOR_FLAG.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span> <span class="comment"> */</span></div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gadbe4c086a6562aefe344bc79e51bdfd3">  340</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_VENDOR_DEFINED(type) \</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span> <span class="preprocessor">    (((type) &amp; PSA_KEY_TYPE_VENDOR_FLAG) != 0)</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span> <span class="comment"></span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span> <span class="comment">/** Whether a key type is an unstructured array of bytes.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span> <span class="comment"> *</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span> <span class="comment"> * This encompasses both symmetric keys and non-key data.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span> <span class="comment"> */</span></div><div class="line"><a name="l00347"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaef86ce4e810e1c2c76068ac874bfef54">  347</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_UNSTRUCTURED(type) \</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span> <span class="preprocessor">    (((type) &amp; PSA_KEY_TYPE_CATEGORY_MASK) == PSA_KEY_TYPE_CATEGORY_RAW || \</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span> <span class="preprocessor">     ((type) &amp; PSA_KEY_TYPE_CATEGORY_MASK) == PSA_KEY_TYPE_CATEGORY_SYMMETRIC)</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span> <span class="comment"></span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span> <span class="comment">/** Whether a key type is asymmetric: either a key pair or a public key. */</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga792aec5149c90731ed3e45472a7cd272">  352</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_ASYMMETRIC(type)                                \</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span> <span class="preprocessor">    (((type) &amp; PSA_KEY_TYPE_CATEGORY_MASK                               \</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span> <span class="preprocessor">      &amp; ~PSA_KEY_TYPE_CATEGORY_FLAG_PAIR) ==                            \</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span> <span class="preprocessor">     PSA_KEY_TYPE_CATEGORY_PUBLIC_KEY)</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span> <span class="comment">/** Whether a key type is the public part of a key pair. */</span></div><div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga182330e37d48ee5fa5a24be3d0b62a58">  357</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_PUBLIC_KEY(type)                                \</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span> <span class="preprocessor">    (((type) &amp; PSA_KEY_TYPE_CATEGORY_MASK) == PSA_KEY_TYPE_CATEGORY_PUBLIC_KEY)</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span> <span class="comment">/** Whether a key type is a key pair containing a private part and a public</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span> <span class="comment"> * part. */</span></div><div class="line"><a name="l00361"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga1dad7596c83e00595d4251197bd4f935">  361</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_KEY_PAIR(type)                                   \</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span> <span class="preprocessor">    (((type) &amp; PSA_KEY_TYPE_CATEGORY_MASK) == PSA_KEY_TYPE_CATEGORY_KEY_PAIR)</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span> <span class="comment">/** The key pair type corresponding to a public key type.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span> <span class="comment"> *</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span> <span class="comment"> * You may also pass a key pair type as \p type, it will be left unchanged.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span> <span class="comment"> *</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span> <span class="comment"> * \param type      A public key type or key pair type.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span> <span class="comment"> *</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span> <span class="comment"> * \return          The corresponding key pair type.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span> <span class="comment"> *                  If \p type is not a public key or a key pair,</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span> <span class="comment"> *                  the return value is undefined.</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span> <span class="comment"> */</span></div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga438078c136a384de8cb9908f65bfec33">  373</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_KEY_PAIR_OF_PUBLIC_KEY(type)        \</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span> <span class="preprocessor">    ((type) | PSA_KEY_TYPE_CATEGORY_FLAG_PAIR)</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span> <span class="comment">/** The public key type corresponding to a key pair type.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span> <span class="comment"> *</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span> <span class="comment"> * You may also pass a key pair type as \p type, it will be left unchanged.</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span> <span class="comment"> *</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span> <span class="comment"> * \param type      A public key type or key pair type.</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span> <span class="comment"> *</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span> <span class="comment"> * \return          The corresponding public key type.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span> <span class="comment"> *                  If \p type is not a public key or a key pair,</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span> <span class="comment"> *                  the return value is undefined.</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span> <span class="comment"> */</span></div><div class="line"><a name="l00385"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga82a7ce25ee4ded5cb8b8a6c7f189ba2f">  385</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(type)        \</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span> <span class="preprocessor">    ((type) &amp; ~PSA_KEY_TYPE_CATEGORY_FLAG_PAIR)</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span> <span class="comment"></span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span> <span class="comment">/** Raw data.</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span> <span class="comment"> *</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span> <span class="comment"> * A "key" of this type cannot be used for any cryptographic operation.</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span> <span class="comment"> * Applications may use this type to store arbitrary data in the keystore. */</span></div><div class="line"><a name="l00392"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaa97f92025533102616b32d571c940d80">  392</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_RAW_DATA                       ((psa_key_type_t)0x1001)</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span> <span class="comment"></span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span> <span class="comment">/** HMAC key.</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span> <span class="comment"> *</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span> <span class="comment"> * The key policy determines which underlying hash algorithm the key can be</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span> <span class="comment"> * used for.</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span> <span class="comment"> *</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span> <span class="comment"> * HMAC keys should generally have the same size as the underlying hash.</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span> <span class="comment"> * This size can be calculated with #PSA_HASH_LENGTH(\c alg) where</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span> <span class="comment"> * \c alg is the HMAC algorithm or the underlying hash algorithm. */</span></div><div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga92d989f4ca64abd00f463defd773a6f8">  402</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_HMAC                           ((psa_key_type_t)0x1100)</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span> <span class="comment"></span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span> <span class="comment">/** A secret for key derivation.</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span> <span class="comment"> *</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span> <span class="comment"> * This key type is for high-entropy secrets only. For low-entropy secrets,</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span> <span class="comment"> * #PSA_KEY_TYPE_PASSWORD should be used instead.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span> <span class="comment"> *</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span> <span class="comment"> * These keys can be used as the #PSA_KEY_DERIVATION_INPUT_SECRET or</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span> <span class="comment"> * #PSA_KEY_DERIVATION_INPUT_PASSWORD input of key derivation algorithms.</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span> <span class="comment"> *</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span> <span class="comment"> * The key policy determines which key derivation algorithm the key</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span> <span class="comment"> * can be used for.</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span> <span class="comment"> */</span></div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gae871b2357b8593f33bfd51abbf93ebb1">  415</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DERIVE                         ((psa_key_type_t)0x1200)</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span> <span class="comment"></span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span> <span class="comment">/** A low-entropy secret for password hashing or key derivation.</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span> <span class="comment"> *</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span> <span class="comment"> * This key type is suitable for passwords and passphrases which are typically</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span> <span class="comment"> * intended to be memorizable by humans, and have a low entropy relative to</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span> <span class="comment"> * their size. It can be used for randomly generated or derived keys with</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span> <span class="comment"> * maximum or near-maximum entropy, but #PSA_KEY_TYPE_DERIVE is more suitable</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span> <span class="comment"> * for such keys. It is not suitable for passwords with extremely low entropy,</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span> <span class="comment"> * such as numerical PINs.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span> <span class="comment"> *</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span> <span class="comment"> * These keys can be used as the #PSA_KEY_DERIVATION_INPUT_PASSWORD input of</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span> <span class="comment"> * key derivation algorithms. Algorithms that accept such an input were</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span> <span class="comment"> * designed to accept low-entropy secret and are known as password hashing or</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span> <span class="comment"> * key stretching algorithms.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span> <span class="comment"> *</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span> <span class="comment"> * These keys cannot be used as the #PSA_KEY_DERIVATION_INPUT_SECRET input of</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span> <span class="comment"> * key derivation algorithms, as the algorithms that take such an input expect</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span> <span class="comment"> * it to be high-entropy.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span> <span class="comment"> *</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span> <span class="comment"> * The key policy determines which key derivation algorithm the key can be</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span> <span class="comment"> * used for, among the permissible subset defined above.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span> <span class="comment"> */</span></div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaad682c8fe975aee537af922f9503d510">  438</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_PASSWORD                       ((psa_key_type_t)0x1203)</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span> <span class="comment"></span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span> <span class="comment">/** A secret value that can be used to verify a password hash.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span> <span class="comment"> *</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span> <span class="comment"> * The key policy determines which key derivation algorithm the key</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span> <span class="comment"> * can be used for, among the same permissible subset as for</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span> <span class="comment"> * #PSA_KEY_TYPE_PASSWORD.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span> <span class="comment"> */</span></div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gac41a0d5fdafc1c19ae73313613142723">  446</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_PASSWORD_HASH                  ((psa_key_type_t)0x1205)</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span> <span class="comment"></span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span> <span class="comment">/** A secret value that can be used in when computing a password hash.</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span> <span class="comment"> *</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span> <span class="comment"> * The key policy determines which key derivation algorithm the key</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span> <span class="comment"> * can be used for, among the subset of algorithms that can use pepper.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span> <span class="comment"> */</span></div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gab47765c3f82af1b6a7d213f9881cb6d6">  453</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_PEPPER                         ((psa_key_type_t)0x1206)</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span> <span class="comment"></span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span> <span class="comment">/** Key for a cipher, AEAD or MAC algorithm based on the AES block cipher.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span> <span class="comment"> *</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span> <span class="comment"> * The size of the key can be 16 bytes (AES-128), 24 bytes (AES-192) or</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span> <span class="comment"> * 32 bytes (AES-256).</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span> <span class="comment"> */</span></div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga6ee54579dcf278c677eda4bb1a29575e">  460</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_AES                            ((psa_key_type_t)0x2400)</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span> <span class="comment"></span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span> <span class="comment">/** Key for a cipher or MAC algorithm based on DES or 3DES (Triple-DES).</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span> <span class="comment"> *</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span> <span class="comment"> * The size of the key can be 64 bits (single DES), 128 bits (2-key 3DES) or</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span> <span class="comment"> * 192 bits (3-key 3DES).</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span> <span class="comment"> *</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span> <span class="comment"> * Note that single DES and 2-key 3DES are weak and strongly</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span> <span class="comment"> * deprecated and should only be used to decrypt legacy data. 3-key 3DES</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span> <span class="comment"> * is weak and deprecated and should only be used in legacy protocols.</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span> <span class="comment"> */</span></div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga577562bfbbc691c820d55ec308333138">  471</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DES                            ((psa_key_type_t)0x2301)</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span> <span class="comment"></span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span> <span class="comment">/** Key for a cipher, AEAD or MAC algorithm based on the</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span> <span class="comment"> * Camellia block cipher. */</span></div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gad8e5da742343fd5519f9d8a630c2ed81">  475</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_CAMELLIA                       ((psa_key_type_t)0x2403)</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span> <span class="comment"></span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span> <span class="comment">/** Key for the ChaCha20 stream cipher or the Chacha20-Poly1305 AEAD algorithm.</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span> <span class="comment"> *</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span> <span class="comment"> * ChaCha20 and the ChaCha20_Poly1305 construction are defined in RFC 7539.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span> <span class="comment"> *</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span> <span class="comment"> * Implementations must support 12-byte nonces, may support 8-byte nonces,</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span> <span class="comment"> * and should reject other sizes.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span> <span class="comment"> */</span></div><div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga901548883b3bce56cc21c3a22cf8d93c">  484</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_CHACHA20                       ((psa_key_type_t)0x2004)</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span> <span class="comment"></span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span> <span class="comment">/** RSA public key.</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span> <span class="comment"> *</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span> <span class="comment"> * The size of an RSA key is the bit size of the modulus.</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span> <span class="comment"> */</span></div><div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga9ba0878f56c8bcd1995ac017a74f513b">  490</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_RSA_PUBLIC_KEY                 ((psa_key_type_t)0x4001)</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span> <span class="comment">/** RSA key pair (private and public key).</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span> <span class="comment"> *</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span> <span class="comment"> * The size of an RSA key is the bit size of the modulus.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span> <span class="comment"> */</span></div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga11745b110166e927e2abeabc7d532051">  495</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_RSA_KEY_PAIR                   ((psa_key_type_t)0x7001)</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span> <span class="comment">/** Whether a key type is an RSA key (pair or public-only). */</span></div><div class="line"><a name="l00497"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga33f84ec4a8b0485b4032a2cdef526d69">  497</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_RSA(type)                                       \</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span> <span class="preprocessor">    (PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(type) == PSA_KEY_TYPE_RSA_PUBLIC_KEY)</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span> </div><div class="line"><a name="l00500"></a><span class="lineno">  500</span> <span class="preprocessor">#define PSA_KEY_TYPE_ECC_PUBLIC_KEY_BASE            ((psa_key_type_t)0x4100)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span> <span class="preprocessor">#define PSA_KEY_TYPE_ECC_KEY_PAIR_BASE              ((psa_key_type_t)0x7100)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span> <span class="preprocessor">#define PSA_KEY_TYPE_ECC_CURVE_MASK                 ((psa_key_type_t)0x00ff)</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span> <span class="comment">/** Elliptic curve key pair.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span> <span class="comment"> *</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span> <span class="comment"> * The size of an elliptic curve key is the bit size associated with the curve,</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span> <span class="comment"> * i.e. the bit size of *q* for a curve over a field *F&lt;sub&gt;q&lt;/sub&gt;*.</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span> <span class="comment"> * See the documentation of `PSA_ECC_FAMILY_xxx` curve families for details.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span> <span class="comment"> *</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span> <span class="comment"> * \param curve     A value of type ::psa_ecc_family_t that</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span> <span class="comment"> *                  identifies the ECC curve to be used.</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span> <span class="comment"> */</span></div><div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga935240a64fffe8e296e551fe0bccabd9">  512</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_ECC_KEY_PAIR(curve)         \</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span> <span class="preprocessor">    (PSA_KEY_TYPE_ECC_KEY_PAIR_BASE | (curve))</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span> <span class="comment">/** Elliptic curve public key.</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span> <span class="comment"> *</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span> <span class="comment"> * The size of an elliptic curve public key is the same as the corresponding</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span> <span class="comment"> * private key (see #PSA_KEY_TYPE_ECC_KEY_PAIR and the documentation of</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span> <span class="comment"> * `PSA_ECC_FAMILY_xxx` curve families).</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span> <span class="comment"> *</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span> <span class="comment"> * \param curve     A value of type ::psa_ecc_family_t that</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span> <span class="comment"> *                  identifies the ECC curve to be used.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span> <span class="comment"> */</span></div><div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga6d6defc9871b2ad37be62d72ceb9f2ca">  523</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_ECC_PUBLIC_KEY(curve)              \</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span> <span class="preprocessor">    (PSA_KEY_TYPE_ECC_PUBLIC_KEY_BASE | (curve))</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span> <span class="comment"></span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span> <span class="comment">/** Whether a key type is an elliptic curve key (pair or public-only). */</span></div><div class="line"><a name="l00527"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga9083323525a6cc469aa6cb82604633c4">  527</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_ECC(type)                                       \</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span> <span class="preprocessor">    ((PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(type) &amp;                        \</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span> <span class="preprocessor">      ~PSA_KEY_TYPE_ECC_CURVE_MASK) == PSA_KEY_TYPE_ECC_PUBLIC_KEY_BASE)</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span> <span class="comment">/** Whether a key type is an elliptic curve key pair. */</span></div><div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gabc920362c4f5bef1b3fd1dcf9e8e667a">  531</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_ECC_KEY_PAIR(type)                               \</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span> <span class="preprocessor">    (((type) &amp; ~PSA_KEY_TYPE_ECC_CURVE_MASK) ==                         \</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span> <span class="preprocessor">     PSA_KEY_TYPE_ECC_KEY_PAIR_BASE)</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span> <span class="comment">/** Whether a key type is an elliptic curve public key. */</span></div><div class="line"><a name="l00535"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga6bc9360aa9de39f4aefd21967b9c7380">  535</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY(type)                            \</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span> <span class="preprocessor">    (((type) &amp; ~PSA_KEY_TYPE_ECC_CURVE_MASK) ==                         \</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span> <span class="preprocessor">     PSA_KEY_TYPE_ECC_PUBLIC_KEY_BASE)</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span> <span class="comment"></span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span> <span class="comment">/** Extract the curve from an elliptic curve key type. */</span></div><div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga965c7f44a872b9db0e6c8a6b096e2eab">  540</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_ECC_GET_FAMILY(type)                        \</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span> <span class="preprocessor">    ((psa_ecc_family_t) (PSA_KEY_TYPE_IS_ECC(type) ?             \</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span> <span class="preprocessor">                        ((type) &amp; PSA_KEY_TYPE_ECC_CURVE_MASK) : \</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span> <span class="preprocessor">                        0))</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span> <span class="comment"></span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span> <span class="comment">/** SEC Koblitz curves over prime fields.</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span> <span class="comment"> *</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span> <span class="comment"> * This family comprises the following curves:</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span> <span class="comment"> * secp192k1, secp224k1, secp256k1.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span> <span class="comment"> * They are defined in _Standards for Efficient Cryptography_,</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span> <span class="comment"> * _SEC 2: Recommended Elliptic Curve Domain Parameters_.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span> <span class="comment"> * https://www.secg.org/sec2-v2.pdf</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span> <span class="comment"> */</span></div><div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga5cf2405c6e23b93cea0aac092d1aa0f7">  553</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_SECP_K1           ((psa_ecc_family_t) 0x17)</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span> <span class="comment"></span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span> <span class="comment">/** SEC random curves over prime fields.</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span> <span class="comment"> *</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span> <span class="comment"> * This family comprises the following curves:</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span> <span class="comment"> * secp192k1, secp224r1, secp256r1, secp384r1, secp521r1.</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span> <span class="comment"> * They are defined in _Standards for Efficient Cryptography_,</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span> <span class="comment"> * _SEC 2: Recommended Elliptic Curve Domain Parameters_.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span> <span class="comment"> * https://www.secg.org/sec2-v2.pdf</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span> <span class="comment"> */</span></div><div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">  563</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_SECP_R1           ((psa_ecc_family_t) 0x12)</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span> <span class="comment">/* SECP160R2 (SEC2 v1, obsolete) */</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span> <span class="preprocessor">#define PSA_ECC_FAMILY_SECP_R2           ((psa_ecc_family_t) 0x1b)</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span> <span class="comment"></span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span> <span class="comment">/** SEC Koblitz curves over binary fields.</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span> <span class="comment"> *</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span> <span class="comment"> * This family comprises the following curves:</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span> <span class="comment"> * sect163k1, sect233k1, sect239k1, sect283k1, sect409k1, sect571k1.</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span> <span class="comment"> * They are defined in _Standards for Efficient Cryptography_,</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span> <span class="comment"> * _SEC 2: Recommended Elliptic Curve Domain Parameters_.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span> <span class="comment"> * https://www.secg.org/sec2-v2.pdf</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span> <span class="comment"> */</span></div><div class="line"><a name="l00575"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga31fb7fe7608708fa64bcec2eea92efbb">  575</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_SECT_K1           ((psa_ecc_family_t) 0x27)</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span> <span class="comment"></span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span> <span class="comment">/** SEC random curves over binary fields.</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span> <span class="comment"> *</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span> <span class="comment"> * This family comprises the following curves:</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span> <span class="comment"> * sect163r1, sect233r1, sect283r1, sect409r1, sect571r1.</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span> <span class="comment"> * They are defined in _Standards for Efficient Cryptography_,</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span> <span class="comment"> * _SEC 2: Recommended Elliptic Curve Domain Parameters_.</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span> <span class="comment"> * https://www.secg.org/sec2-v2.pdf</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span> <span class="comment"> */</span></div><div class="line"><a name="l00585"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga71544d130f52ad2afc7700779c44af19">  585</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_SECT_R1           ((psa_ecc_family_t) 0x22)</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span> <span class="comment"></span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span> <span class="comment">/** SEC additional random curves over binary fields.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span> <span class="comment"> *</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span> <span class="comment"> * This family comprises the following curve:</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span> <span class="comment"> * sect163r2.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span> <span class="comment"> * It is defined in _Standards for Efficient Cryptography_,</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span> <span class="comment"> * _SEC 2: Recommended Elliptic Curve Domain Parameters_.</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span> <span class="comment"> * https://www.secg.org/sec2-v2.pdf</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span> <span class="comment"> */</span></div><div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga40d07f0ac30b4bc7c93d65408ca31d00">  595</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_SECT_R2           ((psa_ecc_family_t) 0x2b)</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span> <span class="comment"></span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span> <span class="comment">/** Brainpool P random curves.</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span> <span class="comment"> *</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span> <span class="comment"> * This family comprises the following curves:</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span> <span class="comment"> * brainpoolP160r1, brainpoolP192r1, brainpoolP224r1, brainpoolP256r1,</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span> <span class="comment"> * brainpoolP320r1, brainpoolP384r1, brainpoolP512r1.</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span> <span class="comment"> * It is defined in RFC 5639.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span> <span class="comment"> */</span></div><div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gac1643f1baf38b30d07c20a6eac697f15">  604</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_BRAINPOOL_P_R1    ((psa_ecc_family_t) 0x30)</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span> <span class="comment"></span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span> <span class="comment">/** Curve25519 and Curve448.</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span> <span class="comment"> *</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span> <span class="comment"> * This family comprises the following Montgomery curves:</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span> <span class="comment"> * - 255-bit: Bernstein et al.,</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span> <span class="comment"> *   _Curve25519: new Diffie-Hellman speed records_, LNCS 3958, 2006.</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span> <span class="comment"> *   The algorithm #PSA_ALG_ECDH performs X25519 when used with this curve.</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span> <span class="comment"> * - 448-bit: Hamburg,</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span> <span class="comment"> *   _Ed448-Goldilocks, a new elliptic curve_, NIST ECC Workshop, 2015.</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span> <span class="comment"> *   The algorithm #PSA_ALG_ECDH performs X448 when used with this curve.</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span> <span class="comment"> */</span></div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga1f624c5cdaf25b21287af33024e1aff8">  616</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_MONTGOMERY        ((psa_ecc_family_t) 0x41)</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span> <span class="comment"></span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span> <span class="comment">/** The twisted Edwards curves Ed25519 and Ed448.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span> <span class="comment"> *</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span> <span class="comment"> * These curves are suitable for EdDSA (#PSA_ALG_PURE_EDDSA for both curves,</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span> <span class="comment"> * #PSA_ALG_ED25519PH for the 255-bit curve,</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span> <span class="comment"> * #PSA_ALG_ED448PH for the 448-bit curve).</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span> <span class="comment"> *</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span> <span class="comment"> * This family comprises the following twisted Edwards curves:</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span> <span class="comment"> * - 255-bit: Edwards25519, the twisted Edwards curve birationally equivalent</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span> <span class="comment"> *   to Curve25519.</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span> <span class="comment"> *   Bernstein et al., _Twisted Edwards curves_, Africacrypt 2008.</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span> <span class="comment"> * - 448-bit: Edwards448, the twisted Edwards curve birationally equivalent</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span> <span class="comment"> *   to Curve448.</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span> <span class="comment"> *   Hamburg, _Ed448-Goldilocks, a new elliptic curve_, NIST ECC Workshop, 2015.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span> <span class="comment"> */</span></div><div class="line"><a name="l00632"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gafe45f9fe29699f26795f6251f47eafd4">  632</a></span> <span class="preprocessor">#define PSA_ECC_FAMILY_TWISTED_EDWARDS   ((psa_ecc_family_t) 0x42)</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span> </div><div class="line"><a name="l00634"></a><span class="lineno">  634</span> <span class="preprocessor">#define PSA_KEY_TYPE_DH_PUBLIC_KEY_BASE             ((psa_key_type_t)0x4200)</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span> <span class="preprocessor">#define PSA_KEY_TYPE_DH_KEY_PAIR_BASE               ((psa_key_type_t)0x7200)</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span> <span class="preprocessor">#define PSA_KEY_TYPE_DH_GROUP_MASK                  ((psa_key_type_t)0x00ff)</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span> <span class="comment">/** Diffie-Hellman key pair.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span> <span class="comment"> *</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span> <span class="comment"> * \param group     A value of type ::psa_dh_family_t that identifies the</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span> <span class="comment"> *                  Diffie-Hellman group to be used.</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span> <span class="comment"> */</span></div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaad69efa04b9451f5476ecfd5dd2610ab">  642</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DH_KEY_PAIR(group)          \</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span> <span class="preprocessor">    (PSA_KEY_TYPE_DH_KEY_PAIR_BASE | (group))</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span> <span class="comment">/** Diffie-Hellman public key.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span> <span class="comment"> *</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span> <span class="comment"> * \param group     A value of type ::psa_dh_family_t that identifies the</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span> <span class="comment"> *                  Diffie-Hellman group to be used.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span> <span class="comment"> */</span></div><div class="line"><a name="l00649"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaed7a3a6c1f5d8565d288163b30e05b7b">  649</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DH_PUBLIC_KEY(group)               \</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span> <span class="preprocessor">    (PSA_KEY_TYPE_DH_PUBLIC_KEY_BASE | (group))</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span> <span class="comment"></span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span> <span class="comment">/** Whether a key type is a Diffie-Hellman key (pair or public-only). */</span></div><div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga4881c54e732126799b6a1e94d340c842">  653</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_DH(type)                                        \</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span> <span class="preprocessor">    ((PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(type) &amp;                        \</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span> <span class="preprocessor">      ~PSA_KEY_TYPE_DH_GROUP_MASK) == PSA_KEY_TYPE_DH_PUBLIC_KEY_BASE)</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span> <span class="comment">/** Whether a key type is a Diffie-Hellman key pair. */</span></div><div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gae10fe7fb9c6e0b606c8f30f9baea0bf9">  657</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_DH_KEY_PAIR(type)                               \</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span> <span class="preprocessor">    (((type) &amp; ~PSA_KEY_TYPE_DH_GROUP_MASK) ==                         \</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span> <span class="preprocessor">     PSA_KEY_TYPE_DH_KEY_PAIR_BASE)</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span> <span class="comment">/** Whether a key type is a Diffie-Hellman public key. */</span></div><div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gadc2946a6dd34531131fcd357a481c45a">  661</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_DH_PUBLIC_KEY(type)                            \</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span> <span class="preprocessor">    (((type) &amp; ~PSA_KEY_TYPE_DH_GROUP_MASK) ==                         \</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span> <span class="preprocessor">     PSA_KEY_TYPE_DH_PUBLIC_KEY_BASE)</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span> <span class="comment"></span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span> <span class="comment">/** Extract the group from a Diffie-Hellman key type. */</span></div><div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga65de94f53be8bdb56cf6d48acd2f2436">  666</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DH_GET_FAMILY(type)                        \</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span> <span class="preprocessor">    ((psa_dh_family_t) (PSA_KEY_TYPE_IS_DH(type) ?              \</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span> <span class="preprocessor">                       ((type) &amp; PSA_KEY_TYPE_DH_GROUP_MASK) :  \</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span> <span class="preprocessor">                       0))</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span> <span class="comment"></span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span> <span class="comment">/** Diffie-Hellman groups defined in RFC 7919 Appendix A.</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span> <span class="comment"> *</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span> <span class="comment"> * This family includes groups with the following key sizes (in bits):</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span> <span class="comment"> * 2048, 3072, 4096, 6144, 8192. A given implementation may support</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span> <span class="comment"> * all of these sizes or only a subset.</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span> <span class="comment"> */</span></div><div class="line"><a name="l00677"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga7be917e67fe4a567fb36864035822ff7">  677</a></span> <span class="preprocessor">#define PSA_DH_FAMILY_RFC7919            ((psa_dh_family_t) 0x03)</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span> </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span> <span class="preprocessor">#define PSA_GET_KEY_TYPE_BLOCK_SIZE_EXPONENT(type)      \</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span> <span class="preprocessor">    (((type) &gt;&gt; 8) &amp; 7)</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span> <span class="comment">/** The block size of a block cipher.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span> <span class="comment"> *</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span> <span class="comment"> * \param type  A cipher key type (value of type #psa_key_type_t).</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span> <span class="comment"> *</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span> <span class="comment"> * \return      The block size for a block cipher, or 1 for a stream cipher.</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span> <span class="comment"> *              The return value is undefined if \p type is not a supported</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span> <span class="comment"> *              cipher key type.</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span> <span class="comment"> *</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span> <span class="comment"> * \note It is possible to build stream cipher algorithms on top of a block</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span> <span class="comment"> *       cipher, for example CTR mode (#PSA_ALG_CTR).</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span> <span class="comment"> *       This macro only takes the key type into account, so it cannot be</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span> <span class="comment"> *       used to determine the size of the data that #psa_cipher_update()</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span> <span class="comment"> *       might buffer for future processing in general.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span> <span class="comment"> *</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span> <span class="comment"> * \note This macro returns a compile-time constant if its argument is one.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span> <span class="comment"> *</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span> <span class="comment"> * \warning This macro may evaluate its argument multiple times.</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span> <span class="comment"> */</span></div><div class="line"><a name="l00699"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gac1aa1e792b1ecae84444431e251a4452">  699</a></span> <span class="preprocessor">#define PSA_BLOCK_CIPHER_BLOCK_LENGTH(type)                                     \</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span> <span class="preprocessor">    (((type) &amp; PSA_KEY_TYPE_CATEGORY_MASK) == PSA_KEY_TYPE_CATEGORY_SYMMETRIC ? \</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span> <span class="preprocessor">     1u &lt;&lt; PSA_GET_KEY_TYPE_BLOCK_SIZE_EXPONENT(type) :                         \</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span> <span class="preprocessor">     0u)</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span> <span class="comment"></span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span> <span class="comment">/** Vendor-defined algorithm flag.</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span> <span class="comment"> *</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span> <span class="comment"> * Algorithms defined by this standard will never have the #PSA_ALG_VENDOR_FLAG</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span> <span class="comment"> * bit set. Vendors who define additional algorithms must use an encoding with</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span> <span class="comment"> * the #PSA_ALG_VENDOR_FLAG bit set and should respect the bitwise structure</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span> <span class="comment"> * used by standard encodings whenever practical.</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span> <span class="comment"> */</span></div><div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaf5d76750b6cfe3e7f0c8e9eee1162318">  711</a></span> <span class="preprocessor">#define PSA_ALG_VENDOR_FLAG                     ((psa_algorithm_t)0x80000000)</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span> </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_MASK                   ((psa_algorithm_t)0x7f000000)</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_HASH                   ((psa_algorithm_t)0x02000000)</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_MAC                    ((psa_algorithm_t)0x03000000)</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_CIPHER                 ((psa_algorithm_t)0x04000000)</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_AEAD                   ((psa_algorithm_t)0x05000000)</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_SIGN                   ((psa_algorithm_t)0x06000000)</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_ASYMMETRIC_ENCRYPTION  ((psa_algorithm_t)0x07000000)</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_KEY_DERIVATION         ((psa_algorithm_t)0x08000000)</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span> <span class="preprocessor">#define PSA_ALG_CATEGORY_KEY_AGREEMENT          ((psa_algorithm_t)0x09000000)</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span> <span class="comment"></span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span> <span class="comment">/** Whether an algorithm is vendor-defined.</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span> <span class="comment"> *</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span> <span class="comment"> * See also #PSA_ALG_VENDOR_FLAG.</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span> <span class="comment"> */</span></div><div class="line"><a name="l00727"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaab4cf0ac8d3ba325a2ac629f2117d077">  727</a></span> <span class="preprocessor">#define PSA_ALG_IS_VENDOR_DEFINED(alg)                                  \</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_VENDOR_FLAG) != 0)</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span> <span class="comment"></span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span> <span class="comment">/** Whether the specified algorithm is a hash algorithm.</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span> <span class="comment"> *</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span> <span class="comment"> *</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span> <span class="comment"> * \return 1 if \p alg is a hash algorithm, 0 otherwise.</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span> <span class="comment"> */</span></div><div class="line"><a name="l00738"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga4867a11057f48a9870e789be465dde93">  738</a></span> <span class="preprocessor">#define PSA_ALG_IS_HASH(alg)                                            \</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_HASH)</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span> <span class="comment"></span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span> <span class="comment">/** Whether the specified algorithm is a MAC algorithm.</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span> <span class="comment"> *</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span> <span class="comment"> *</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span> <span class="comment"> * \return 1 if \p alg is a MAC algorithm, 0 otherwise.</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span> <span class="comment"> */</span></div><div class="line"><a name="l00749"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga9b244300fe3901214b68a6ca1bb6a412">  749</a></span> <span class="preprocessor">#define PSA_ALG_IS_MAC(alg)                                             \</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_MAC)</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span> <span class="comment"></span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span> <span class="comment">/** Whether the specified algorithm is a symmetric cipher algorithm.</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span> <span class="comment"> *</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span> <span class="comment"> *</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span> <span class="comment"> * \return 1 if \p alg is a symmetric cipher algorithm, 0 otherwise.</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span> <span class="comment"> */</span></div><div class="line"><a name="l00760"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga9ec936a942aa11097588879d76fadbbc">  760</a></span> <span class="preprocessor">#define PSA_ALG_IS_CIPHER(alg)                                          \</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_CIPHER)</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span> <span class="comment"></span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span> <span class="comment">/** Whether the specified algorithm is an authenticated encryption</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span> <span class="comment"> * with associated data (AEAD) algorithm.</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span> <span class="comment"> *</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span> <span class="comment"> *</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span> <span class="comment"> * \return 1 if \p alg is an AEAD algorithm, 0 otherwise.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span> <span class="comment"> */</span></div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab">  772</a></span> <span class="preprocessor">#define PSA_ALG_IS_AEAD(alg)                                            \</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_AEAD)</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span> <span class="comment"></span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span> <span class="comment">/** Whether the specified algorithm is an asymmetric signature algorithm,</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span> <span class="comment"> * also known as public-key signature algorithm.</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span> <span class="comment"> *</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span> <span class="comment"> *</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span> <span class="comment"> * \return 1 if \p alg is an asymmetric signature algorithm, 0 otherwise.</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span> <span class="comment"> */</span></div><div class="line"><a name="l00784"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0f442186a734e3cbcf9063dfd8eeca39">  784</a></span> <span class="preprocessor">#define PSA_ALG_IS_SIGN(alg)                                            \</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_SIGN)</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span> <span class="comment"></span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span> <span class="comment">/** Whether the specified algorithm is an asymmetric encryption algorithm,</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span> <span class="comment"> * also known as public-key encryption algorithm.</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span> <span class="comment"> *</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span> <span class="comment"> *</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span> <span class="comment"> * \return 1 if \p alg is an asymmetric encryption algorithm, 0 otherwise.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span> <span class="comment"> */</span></div><div class="line"><a name="l00796"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga7c38eb06451c9b4d911b5962878a7d9b">  796</a></span> <span class="preprocessor">#define PSA_ALG_IS_ASYMMETRIC_ENCRYPTION(alg)                           \</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_ASYMMETRIC_ENCRYPTION)</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span> <span class="comment"></span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span> <span class="comment">/** Whether the specified algorithm is a key agreement algorithm.</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span> <span class="comment"> *</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span> <span class="comment"> *</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span> <span class="comment"> * \return 1 if \p alg is a key agreement algorithm, 0 otherwise.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span> <span class="comment"> */</span></div><div class="line"><a name="l00807"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga058b8e84453228fe4232073455507e82">  807</a></span> <span class="preprocessor">#define PSA_ALG_IS_KEY_AGREEMENT(alg)                                   \</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_KEY_AGREEMENT)</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span> <span class="comment"></span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span> <span class="comment">/** Whether the specified algorithm is a key derivation algorithm.</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span> <span class="comment"> *</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span> <span class="comment"> *</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span> <span class="comment"> * \return 1 if \p alg is a key derivation algorithm, 0 otherwise.</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span> <span class="comment"> */</span></div><div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0029c63ad7efd944190dbf39275af64b">  818</a></span> <span class="preprocessor">#define PSA_ALG_IS_KEY_DERIVATION(alg)                                  \</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_CATEGORY_MASK) == PSA_ALG_CATEGORY_KEY_DERIVATION)</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span> <span class="comment"></span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span> <span class="comment">/** Whether the specified algorithm is a key stretching / password hashing</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span> <span class="comment"> * algorithm.</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span> <span class="comment"> *</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span> <span class="comment"> * A key stretching / password hashing algorithm is a key derivation algorithm</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span> <span class="comment"> * that is suitable for use with a low-entropy secret such as a password.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span> <span class="comment"> * Equivalently, it's a key derivation algorithm that uses a</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span> <span class="comment"> * #PSA_KEY_DERIVATION_INPUT_PASSWORD input step.</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span> <span class="comment"> *</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span> <span class="comment"> *</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span> <span class="comment"> * \return 1 if \p alg is a key stretching / password hashing algorithm, 0</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span> <span class="comment"> *         otherwise. This macro may return either 0 or 1 if \p alg is not a</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span> <span class="comment"> *         supported algorithm identifier.</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span> <span class="comment"> */</span></div><div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga2696596ba29b37921c41f05c1921f912">  835</a></span> <span class="preprocessor">#define PSA_ALG_IS_KEY_DERIVATION_STRETCHING(alg)                                  \</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span> <span class="preprocessor">    (PSA_ALG_IS_KEY_DERIVATION(alg) &amp;&amp;              \</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span> <span class="preprocessor">     (alg) &amp; PSA_ALG_KEY_DERIVATION_STRETCHING_FLAG)</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span> </div><div class="line"><a name="l00839"></a><span class="lineno">  839</span> <span class="preprocessor">#define PSA_ALG_HASH_MASK                       ((psa_algorithm_t)0x000000ff)</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span> <span class="comment">/** MD5 */</span></div><div class="line"><a name="l00841"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gade591d9286d23382eb5cec099c84180d">  841</a></span> <span class="preprocessor">#define PSA_ALG_MD5                             ((psa_algorithm_t)0x02000003)</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span> <span class="comment">/** PSA_ALG_RIPEMD160 */</span></div><div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga6c5d3a32cda59086f07b85ef007033dd">  843</a></span> <span class="preprocessor">#define PSA_ALG_RIPEMD160                       ((psa_algorithm_t)0x02000004)</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span> <span class="comment">/** SHA1 */</span></div><div class="line"><a name="l00845"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga3fca4e9f9ad4a1158817d1850dee82e5">  845</a></span> <span class="preprocessor">#define PSA_ALG_SHA_1                           ((psa_algorithm_t)0x02000005)</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span> <span class="comment">/** SHA2-224 */</span></div><div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga25d6a3244d10a7148fe6b026d1979f7b">  847</a></span> <span class="preprocessor">#define PSA_ALG_SHA_224                         ((psa_algorithm_t)0x02000008)</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span> <span class="comment">/** SHA2-256 */</span></div><div class="line"><a name="l00849"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga619471f978e13cdd0a1e37145e4bf341">  849</a></span> <span class="preprocessor">#define PSA_ALG_SHA_256                         ((psa_algorithm_t)0x02000009)</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span> <span class="comment">/** SHA2-384 */</span></div><div class="line"><a name="l00851"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga58af64dd9a86a287e8da9ed7739eead4">  851</a></span> <span class="preprocessor">#define PSA_ALG_SHA_384                         ((psa_algorithm_t)0x0200000a)</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span> <span class="comment">/** SHA2-512 */</span></div><div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gafba3ae409f46d3dd7f37a0910660c3e9">  853</a></span> <span class="preprocessor">#define PSA_ALG_SHA_512                         ((psa_algorithm_t)0x0200000b)</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span> <span class="comment">/** SHA2-512/224 */</span></div><div class="line"><a name="l00855"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga3fe2d7c3c80e3186ca78d16a35d5d931">  855</a></span> <span class="preprocessor">#define PSA_ALG_SHA_512_224                     ((psa_algorithm_t)0x0200000c)</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span> <span class="comment">/** SHA2-512/256 */</span></div><div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga5910b3964c14e9613e8643a45b09c2d4">  857</a></span> <span class="preprocessor">#define PSA_ALG_SHA_512_256                     ((psa_algorithm_t)0x0200000d)</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span> <span class="comment">/** SHA3-224 */</span></div><div class="line"><a name="l00859"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga16f5fe34ccce68c2fada1224c054a999">  859</a></span> <span class="preprocessor">#define PSA_ALG_SHA3_224                        ((psa_algorithm_t)0x02000010)</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span> <span class="comment">/** SHA3-256 */</span></div><div class="line"><a name="l00861"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaace70d9515489bbe3c5e7ac1b7d9155b">  861</a></span> <span class="preprocessor">#define PSA_ALG_SHA3_256                        ((psa_algorithm_t)0x02000011)</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span> <span class="comment">/** SHA3-384 */</span></div><div class="line"><a name="l00863"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gab0f079257ea75e2acfe2fc3b38c78cd8">  863</a></span> <span class="preprocessor">#define PSA_ALG_SHA3_384                        ((psa_algorithm_t)0x02000012)</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span> <span class="comment">/** SHA3-512 */</span></div><div class="line"><a name="l00865"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga37e5dbe936dddb155e76f2997de27188">  865</a></span> <span class="preprocessor">#define PSA_ALG_SHA3_512                        ((psa_algorithm_t)0x02000013)</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span> <span class="comment">/** The first 512 bits (64 bytes) of the SHAKE256 output.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span> <span class="comment"> *</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span> <span class="comment"> * This is the prehashing for Ed448ph (see #PSA_ALG_ED448PH). For other</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span> <span class="comment"> * scenarios where a hash function based on SHA3/SHAKE is desired, SHA3-512</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span> <span class="comment"> * has the same output size and a (theoretically) higher security strength.</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span> <span class="comment"> */</span></div><div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaec67f81d5b80b765702efb4b3d6e202c">  872</a></span> <span class="preprocessor">#define PSA_ALG_SHAKE256_512                    ((psa_algorithm_t)0x02000015)</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span> <span class="comment"></span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span> <span class="comment">/** In a hash-and-sign algorithm policy, allow any hash algorithm.</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span> <span class="comment"> *</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span> <span class="comment"> * This value may be used to form the algorithm usage field of a policy</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span> <span class="comment"> * for a signature algorithm that is parametrized by a hash. The key</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span> <span class="comment"> * may then be used to perform operations using the same signature</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span> <span class="comment"> * algorithm parametrized with any supported hash.</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span> <span class="comment"> *</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span> <span class="comment"> * That is, suppose that `PSA_xxx_SIGNATURE` is one of the following macros:</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span> <span class="comment"> * - #PSA_ALG_RSA_PKCS1V15_SIGN, #PSA_ALG_RSA_PSS,</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span> <span class="comment"> * - #PSA_ALG_ECDSA, #PSA_ALG_DETERMINISTIC_ECDSA.</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span> <span class="comment"> * Then you may create and use a key as follows:</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span> <span class="comment"> * - Set the key usage field using #PSA_ALG_ANY_HASH, for example:</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span> <span class="comment"> *   psa_set_key_usage_flags(&amp;attributes, PSA_KEY_USAGE_SIGN_HASH); // or VERIFY</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span> <span class="comment"> *   psa_set_key_algorithm(&amp;attributes, PSA_xxx_SIGNATURE(PSA_ALG_ANY_HASH));</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span> <span class="comment"> * - Import or generate key material.</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span> <span class="comment"> * - Call psa_sign_hash() or psa_verify_hash(), passing</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span> <span class="comment"> *   an algorithm built from `PSA_xxx_SIGNATURE` and a specific hash. Each</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span> <span class="comment"> *   call to sign or verify a message may use a different hash.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span> <span class="comment"> *   psa_sign_hash(key, PSA_xxx_SIGNATURE(PSA_ALG_SHA_256), ...);</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span> <span class="comment"> *   psa_sign_hash(key, PSA_xxx_SIGNATURE(PSA_ALG_SHA_512), ...);</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span> <span class="comment"> *   psa_sign_hash(key, PSA_xxx_SIGNATURE(PSA_ALG_SHA3_256), ...);</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span> <span class="comment"> *</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span> <span class="comment"> * This value may not be used to build other algorithms that are</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span> <span class="comment"> * parametrized over a hash. For any valid use of this macro to build</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span> <span class="comment"> * an algorithm \c alg, #PSA_ALG_IS_HASH_AND_SIGN(\c alg) is true.</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span> <span class="comment"> *</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span> <span class="comment"> * This value may not be used to build an algorithm specification to</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span> <span class="comment"> * perform an operation. It is only valid to build policies.</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span> <span class="comment"> */</span></div><div class="line"><a name="l00907"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaa1288ea8bd397a8a3f5e19e94110f2e4">  907</a></span> <span class="preprocessor">#define PSA_ALG_ANY_HASH                        ((psa_algorithm_t)0x020000ff)</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span> </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span> <span class="preprocessor">#define PSA_ALG_MAC_SUBCATEGORY_MASK            ((psa_algorithm_t)0x00c00000)</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span> <span class="preprocessor">#define PSA_ALG_HMAC_BASE                       ((psa_algorithm_t)0x03800000)</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span> <span class="comment">/** Macro to build an HMAC algorithm.</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span> <span class="comment"> *</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span> <span class="comment"> * For example, #PSA_ALG_HMAC(#PSA_ALG_SHA_256) is HMAC-SHA-256.</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span> <span class="comment"> *</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span> <span class="comment"> *</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span> <span class="comment"> * \return              The corresponding HMAC algorithm.</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span> <span class="comment"> */</span></div><div class="line"><a name="l00922"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gacbb2f24f0a73c133a1b611d6593396e3">  922</a></span> <span class="preprocessor">#define PSA_ALG_HMAC(hash_alg)                                  \</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span> <span class="preprocessor">    (PSA_ALG_HMAC_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span> </div><div class="line"><a name="l00925"></a><span class="lineno">  925</span> <span class="preprocessor">#define PSA_ALG_HMAC_GET_HASH(hmac_alg)                             \</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span> <span class="preprocessor">    (PSA_ALG_CATEGORY_HASH | ((hmac_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span> <span class="comment"></span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span> <span class="comment">/** Whether the specified algorithm is an HMAC algorithm.</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span> <span class="comment"> *</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span> <span class="comment"> * HMAC is a family of MAC algorithms that are based on a hash function.</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span> <span class="comment"> *</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span> <span class="comment"> *</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span> <span class="comment"> * \return 1 if \p alg is an HMAC algorithm, 0 otherwise.</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span> <span class="comment"> */</span></div><div class="line"><a name="l00938"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gacda991df7096d0124f2d8838f6292561">  938</a></span> <span class="preprocessor">#define PSA_ALG_IS_HMAC(alg)                                            \</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span> <span class="preprocessor">    (((alg) &amp; (PSA_ALG_CATEGORY_MASK | PSA_ALG_MAC_SUBCATEGORY_MASK)) == \</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span> <span class="preprocessor">     PSA_ALG_HMAC_BASE)</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span> </div><div class="line"><a name="l00942"></a><span class="lineno">  942</span> <span class="comment">/* In the encoding of a MAC algorithm, the bits corresponding to</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span> <span class="comment"> * PSA_ALG_MAC_TRUNCATION_MASK encode the length to which the MAC is</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span> <span class="comment"> * truncated. As an exception, the value 0 means the untruncated algorithm,</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span> <span class="comment"> * whatever its length is. The length is encoded in 6 bits, so it can</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span> <span class="comment"> * reach up to 63; the largest MAC is 64 bytes so its trivial truncation</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span> <span class="comment"> * to full length is correctly encoded as 0 and any non-trivial truncation</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span> <span class="comment"> * is correctly encoded as a value between 1 and 63. */</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span> <span class="preprocessor">#define PSA_ALG_MAC_TRUNCATION_MASK             ((psa_algorithm_t)0x003f0000)</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span> <span class="preprocessor">#define PSA_MAC_TRUNCATION_OFFSET 16</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span> </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span> <span class="comment">/* In the encoding of a MAC algorithm, the bit corresponding to</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span> <span class="comment"> * #PSA_ALG_MAC_AT_LEAST_THIS_LENGTH_FLAG encodes the fact that the algorithm</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span> <span class="comment"> * is a wildcard algorithm. A key with such wildcard algorithm as permitted</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span> <span class="comment"> * algorithm policy can be used with any algorithm corresponding to the</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span> <span class="comment"> * same base class and having a (potentially truncated) MAC length greater or</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span> <span class="comment"> * equal than the one encoded in #PSA_ALG_MAC_TRUNCATION_MASK. */</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span> <span class="preprocessor">#define PSA_ALG_MAC_AT_LEAST_THIS_LENGTH_FLAG   ((psa_algorithm_t)0x00008000)</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span> <span class="comment"></span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span> <span class="comment">/** Macro to build a truncated MAC algorithm.</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span> <span class="comment"> *</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span> <span class="comment"> * A truncated MAC algorithm is identical to the corresponding MAC</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span> <span class="comment"> * algorithm except that the MAC value for the truncated algorithm</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span> <span class="comment"> * consists of only the first \p mac_length bytes of the MAC value</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span> <span class="comment"> * for the untruncated algorithm.</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span> <span class="comment"> *</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span> <span class="comment"> * \note    This macro may allow constructing algorithm identifiers that</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span> <span class="comment"> *          are not valid, either because the specified length is larger</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span> <span class="comment"> *          than the untruncated MAC or because the specified length is</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span> <span class="comment"> *          smaller than permitted by the implementation.</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span> <span class="comment"> *</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span> <span class="comment"> * \note    It is implementation-defined whether a truncated MAC that</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span> <span class="comment"> *          is truncated to the same length as the MAC of the untruncated</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span> <span class="comment"> *          algorithm is considered identical to the untruncated algorithm</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span> <span class="comment"> *          for policy comparison purposes.</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span> <span class="comment"> *</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span> <span class="comment"> * \param mac_alg       A MAC algorithm identifier (value of type</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span> <span class="comment"> *                      #psa_algorithm_t such that #PSA_ALG_IS_MAC(\p mac_alg)</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span> <span class="comment"> *                      is true). This may be a truncated or untruncated</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span> <span class="comment"> *                      MAC algorithm.</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span> <span class="comment"> * \param mac_length    Desired length of the truncated MAC in bytes.</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span> <span class="comment"> *                      This must be at most the full length of the MAC</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span> <span class="comment"> *                      and must be at least an implementation-specified</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span> <span class="comment"> *                      minimum. The implementation-specified minimum</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span> <span class="comment"> *                      shall not be zero.</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span> <span class="comment"> *</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span> <span class="comment"> * \return              The corresponding MAC algorithm with the specified</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span> <span class="comment"> *                      length.</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span> <span class="comment"> * \return              Unspecified if \p mac_alg is not a supported</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span> <span class="comment"> *                      MAC algorithm or if \p mac_length is too small or</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span> <span class="comment"> *                      too large for the specified MAC algorithm.</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span> <span class="comment"> */</span></div><div class="line"><a name="l00993"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga1be9fda225735d625a300f739b069689">  993</a></span> <span class="preprocessor">#define PSA_ALG_TRUNCATED_MAC(mac_alg, mac_length)              \</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span> <span class="preprocessor">    (((mac_alg) &amp; ~(PSA_ALG_MAC_TRUNCATION_MASK |               \</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span> <span class="preprocessor">                    PSA_ALG_MAC_AT_LEAST_THIS_LENGTH_FLAG)) |   \</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span> <span class="preprocessor">     ((mac_length) &lt;&lt; PSA_MAC_TRUNCATION_OFFSET &amp; PSA_ALG_MAC_TRUNCATION_MASK))</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span> <span class="comment"></span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span> <span class="comment">/** Macro to build the base MAC algorithm corresponding to a truncated</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span> <span class="comment"> * MAC algorithm.</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span> <span class="comment"> *</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span> <span class="comment"> * \param mac_alg       A MAC algorithm identifier (value of type</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span> <span class="comment"> *                      #psa_algorithm_t such that #PSA_ALG_IS_MAC(\p mac_alg)</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span> <span class="comment"> *                      is true). This may be a truncated or untruncated</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span> <span class="comment"> *                      MAC algorithm.</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span> <span class="comment"> *</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span> <span class="comment"> * \return              The corresponding base MAC algorithm.</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span> <span class="comment"> * \return              Unspecified if \p mac_alg is not a supported</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span> <span class="comment"> *                      MAC algorithm.</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span> <span class="comment"> */</span></div><div class="line"><a name="l01010"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga92b300647004b79f3bfc77930f30edad"> 1010</a></span> <span class="preprocessor">#define PSA_ALG_FULL_LENGTH_MAC(mac_alg)                        \</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span> <span class="preprocessor">    ((mac_alg) &amp; ~(PSA_ALG_MAC_TRUNCATION_MASK |                \</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span> <span class="preprocessor">                   PSA_ALG_MAC_AT_LEAST_THIS_LENGTH_FLAG))</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span> <span class="comment"></span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span> <span class="comment">/** Length to which a MAC algorithm is truncated.</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span> <span class="comment"> *</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span> <span class="comment"> * \param mac_alg       A MAC algorithm identifier (value of type</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span> <span class="comment"> *                      #psa_algorithm_t such that #PSA_ALG_IS_MAC(\p mac_alg)</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span> <span class="comment"> *                      is true).</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span> <span class="comment"> *</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span> <span class="comment"> * \return              Length of the truncated MAC in bytes.</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span> <span class="comment"> * \return              0 if \p mac_alg is a non-truncated MAC algorithm.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span> <span class="comment"> * \return              Unspecified if \p mac_alg is not a supported</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span> <span class="comment"> *                      MAC algorithm.</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span> <span class="comment"> */</span></div><div class="line"><a name="l01025"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga6d37e7c8e284ba4b00d05a9c2c772abd"> 1025</a></span> <span class="preprocessor">#define PSA_MAC_TRUNCATED_LENGTH(mac_alg)                               \</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span> <span class="preprocessor">    (((mac_alg) &amp; PSA_ALG_MAC_TRUNCATION_MASK) &gt;&gt; PSA_MAC_TRUNCATION_OFFSET)</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span> <span class="comment"></span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span> <span class="comment">/** Macro to build a MAC minimum-MAC-length wildcard algorithm.</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span> <span class="comment"> *</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span> <span class="comment"> * A minimum-MAC-length MAC wildcard algorithm permits all MAC algorithms</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span> <span class="comment"> * sharing the same base algorithm, and where the (potentially truncated) MAC</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span> <span class="comment"> * length of the specific algorithm is equal to or larger then the wildcard</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span> <span class="comment"> * algorithm's minimum MAC length.</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span> <span class="comment"> *</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span> <span class="comment"> * \note    When setting the minimum required MAC length to less than the</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span> <span class="comment"> *          smallest MAC length allowed by the base algorithm, this effectively</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span> <span class="comment"> *          becomes an 'any-MAC-length-allowed' policy for that base algorithm.</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span> <span class="comment"> *</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span> <span class="comment"> * \param mac_alg         A MAC algorithm identifier (value of type</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span> <span class="comment"> *                        #psa_algorithm_t such that #PSA_ALG_IS_MAC(\p mac_alg)</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span> <span class="comment"> *                        is true).</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span> <span class="comment"> * \param min_mac_length  Desired minimum length of the message authentication</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span> <span class="comment"> *                        code in bytes. This must be at most the untruncated</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span> <span class="comment"> *                        length of the MAC and must be at least 1.</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span> <span class="comment"> *</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span> <span class="comment"> * \return                The corresponding MAC wildcard algorithm with the</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span> <span class="comment"> *                        specified minimum length.</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span> <span class="comment"> * \return                Unspecified if \p mac_alg is not a supported MAC</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span> <span class="comment"> *                        algorithm or if \p min_mac_length is less than 1 or</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span> <span class="comment"> *                        too large for the specified MAC algorithm.</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span> <span class="comment"> */</span></div><div class="line"><a name="l01052"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gadc9ef23a64def968f50f73deafeac4c6"> 1052</a></span> <span class="preprocessor">#define PSA_ALG_AT_LEAST_THIS_LENGTH_MAC(mac_alg, min_mac_length)   \</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span> <span class="preprocessor">    ( PSA_ALG_TRUNCATED_MAC(mac_alg, min_mac_length) |              \</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span> <span class="preprocessor">      PSA_ALG_MAC_AT_LEAST_THIS_LENGTH_FLAG )</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span> </div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span> <span class="preprocessor">#define PSA_ALG_CIPHER_MAC_BASE                 ((psa_algorithm_t)0x03c00000)</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span> <span class="comment">/** The CBC-MAC construction over a block cipher</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span> <span class="comment"> *</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span> <span class="comment"> * \warning CBC-MAC is insecure in many cases.</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span> <span class="comment"> * A more secure mode, such as #PSA_ALG_CMAC, is recommended.</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span> <span class="comment"> */</span></div><div class="line"><a name="l01062"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga20bdc755de7b90f6621ccb1e6bb5d9e1"> 1062</a></span> <span class="preprocessor">#define PSA_ALG_CBC_MAC                         ((psa_algorithm_t)0x03c00100)</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span> <span class="comment">/** The CMAC construction over a block cipher */</span></div><div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga146328a1e0023a02464e232d6ecefdc2"> 1064</a></span> <span class="preprocessor">#define PSA_ALG_CMAC                            ((psa_algorithm_t)0x03c00200)</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span> <span class="comment"></span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span> <span class="comment">/** Whether the specified algorithm is a MAC algorithm based on a block cipher.</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span> <span class="comment"> *</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span> <span class="comment"> *</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span> <span class="comment"> * \return 1 if \p alg is a MAC algorithm based on a block cipher, 0 otherwise.</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span> <span class="comment"> */</span></div><div class="line"><a name="l01074"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga31993c62ac549676891a667e9992c381"> 1074</a></span> <span class="preprocessor">#define PSA_ALG_IS_BLOCK_CIPHER_MAC(alg)                                \</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span> <span class="preprocessor">    (((alg) &amp; (PSA_ALG_CATEGORY_MASK | PSA_ALG_MAC_SUBCATEGORY_MASK)) == \</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span> <span class="preprocessor">     PSA_ALG_CIPHER_MAC_BASE)</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span> </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span> <span class="preprocessor">#define PSA_ALG_CIPHER_STREAM_FLAG              ((psa_algorithm_t)0x00800000)</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span> <span class="preprocessor">#define PSA_ALG_CIPHER_FROM_BLOCK_FLAG          ((psa_algorithm_t)0x00400000)</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span> <span class="comment"></span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span> <span class="comment">/** Whether the specified algorithm is a stream cipher.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span> <span class="comment"> *</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span> <span class="comment"> * A stream cipher is a symmetric cipher that encrypts or decrypts messages</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span> <span class="comment"> * by applying a bitwise-xor with a stream of bytes that is generated</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span> <span class="comment"> * from a key.</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span> <span class="comment"> *</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span> <span class="comment"> *</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span> <span class="comment"> * \return 1 if \p alg is a stream cipher algorithm, 0 otherwise.</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span> <span class="comment"> *         algorithm identifier or if it is not a symmetric cipher algorithm.</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span> <span class="comment"> */</span></div><div class="line"><a name="l01093"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga3f2c4d0851e10620af356db00883f865"> 1093</a></span> <span class="preprocessor">#define PSA_ALG_IS_STREAM_CIPHER(alg)            \</span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span> <span class="preprocessor">    (((alg) &amp; (PSA_ALG_CATEGORY_MASK | PSA_ALG_CIPHER_STREAM_FLAG)) == \</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span> <span class="preprocessor">        (PSA_ALG_CATEGORY_CIPHER | PSA_ALG_CIPHER_STREAM_FLAG))</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span> <span class="comment"></span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span> <span class="comment">/** The stream cipher mode of a stream cipher algorithm.</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span> <span class="comment"> *</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span> <span class="comment"> * The underlying stream cipher is determined by the key type.</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span> <span class="comment"> * - To use ChaCha20, use a key type of #PSA_KEY_TYPE_CHACHA20.</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span> <span class="comment"> */</span></div><div class="line"><a name="l01102"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gad98c105198f7428f7d1dffcb2cd398cd"> 1102</a></span> <span class="preprocessor">#define PSA_ALG_STREAM_CIPHER                   ((psa_algorithm_t)0x04800100)</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span> <span class="comment"></span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span> <span class="comment">/** The CTR stream cipher mode.</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span> <span class="comment"> *</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span> <span class="comment"> * CTR is a stream cipher which is built from a block cipher.</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span> <span class="comment"> * For example, to use AES-128-CTR, use this algorithm with</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span> <span class="comment"> * a key of type #PSA_KEY_TYPE_AES and a length of 128 bits (16 bytes).</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span> <span class="comment"> */</span></div><div class="line"><a name="l01111"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gad318309706a769cffdc64e4c7e06b2e9"> 1111</a></span> <span class="preprocessor">#define PSA_ALG_CTR                             ((psa_algorithm_t)0x04c01000)</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span> <span class="comment"></span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span> <span class="comment">/** The CFB stream cipher mode.</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span> <span class="comment"> *</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span> <span class="comment"> */</span></div><div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0088c933e01d671f263a9a1f177cb5bc"> 1117</a></span> <span class="preprocessor">#define PSA_ALG_CFB                             ((psa_algorithm_t)0x04c01100)</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span> <span class="comment"></span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span> <span class="comment">/** The OFB stream cipher mode.</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span> <span class="comment"> *</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span> <span class="comment"> */</span></div><div class="line"><a name="l01123"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gae96bb421fa634c6fa8f571f0112f1ddb"> 1123</a></span> <span class="preprocessor">#define PSA_ALG_OFB                             ((psa_algorithm_t)0x04c01200)</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span> <span class="comment"></span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span> <span class="comment">/** The XTS cipher mode.</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span> <span class="comment"> *</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span> <span class="comment"> * XTS is a cipher mode which is built from a block cipher. It requires at</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span> <span class="comment"> * least one full block of input, but beyond this minimum the input</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span> <span class="comment"> * does not need to be a whole number of blocks.</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span> <span class="comment"> */</span></div><div class="line"><a name="l01131"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaa722c0e426a797fd6d99623f59748125"> 1131</a></span> <span class="preprocessor">#define PSA_ALG_XTS                             ((psa_algorithm_t)0x0440ff00)</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span> <span class="comment"></span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span> <span class="comment">/** The Electronic Code Book (ECB) mode of a block cipher, with no padding.</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span> <span class="comment"> *</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span> <span class="comment"> * \warning ECB mode does not protect the confidentiality of the encrypted data</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span> <span class="comment"> * except in extremely narrow circumstances. It is recommended that applications</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span> <span class="comment"> * only use ECB if they need to construct an operating mode that the</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span> <span class="comment"> * implementation does not provide. Implementations are encouraged to provide</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span> <span class="comment"> * the modes that applications need in preference to supporting direct access</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span> <span class="comment"> * to ECB.</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span> <span class="comment"> *</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span> <span class="comment"> *</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span> <span class="comment"> * This symmetric cipher mode can only be used with messages whose lengths are a</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span> <span class="comment"> * multiple of the block size of the chosen block cipher.</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span> <span class="comment"> *</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span> <span class="comment"> * ECB mode does not accept an initialization vector (IV). When using a</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span> <span class="comment"> * multi-part cipher operation with this algorithm, psa_cipher_generate_iv()</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span> <span class="comment"> * and psa_cipher_set_iv() must not be called.</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span> <span class="comment"> */</span></div><div class="line"><a name="l01151"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gab8f0609cd0f12cccc9c950fd5a81a0e3"> 1151</a></span> <span class="preprocessor">#define PSA_ALG_ECB_NO_PADDING                  ((psa_algorithm_t)0x04404400)</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span> <span class="comment"></span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span> <span class="comment">/** The CBC block cipher chaining mode, with no padding.</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span> <span class="comment"> *</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span> <span class="comment"> *</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span> <span class="comment"> * This symmetric cipher mode can only be used with messages whose lengths</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span> <span class="comment"> * are whole number of blocks for the chosen block cipher.</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span> <span class="comment"> */</span></div><div class="line"><a name="l01160"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gacb332d72716958880ee7f97d8365ae66"> 1160</a></span> <span class="preprocessor">#define PSA_ALG_CBC_NO_PADDING                  ((psa_algorithm_t)0x04404000)</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span> <span class="comment"></span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span> <span class="comment">/** The CBC block cipher chaining mode with PKCS#7 padding.</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span> <span class="comment"> *</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span> <span class="comment"> *</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span> <span class="comment"> * This is the padding method defined by PKCS#7 (RFC 2315) &amp;sect;10.3.</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span> <span class="comment"> */</span></div><div class="line"><a name="l01168"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaef50d2e9716eb6d476046608e4e0c78c"> 1168</a></span> <span class="preprocessor">#define PSA_ALG_CBC_PKCS7                       ((psa_algorithm_t)0x04404100)</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span> </div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span> <span class="preprocessor">#define PSA_ALG_AEAD_FROM_BLOCK_FLAG            ((psa_algorithm_t)0x00400000)</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span> <span class="comment"></span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span> <span class="comment">/** Whether the specified algorithm is an AEAD mode on a block cipher.</span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span> <span class="comment"> *</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span> <span class="comment"> *</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span> <span class="comment"> * \return 1 if \p alg is an AEAD algorithm which is an AEAD mode based on</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span> <span class="comment"> *         a block cipher, 0 otherwise.</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span> <span class="comment"> */</span></div><div class="line"><a name="l01181"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga4932ced14b6902d6c6d5e97b4569912e"> 1181</a></span> <span class="preprocessor">#define PSA_ALG_IS_AEAD_ON_BLOCK_CIPHER(alg)    \</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span> <span class="preprocessor">    (((alg) &amp; (PSA_ALG_CATEGORY_MASK | PSA_ALG_AEAD_FROM_BLOCK_FLAG)) == \</span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span> <span class="preprocessor">     (PSA_ALG_CATEGORY_AEAD | PSA_ALG_AEAD_FROM_BLOCK_FLAG))</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span> <span class="comment"></span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span> <span class="comment">/** The CCM authenticated encryption algorithm.</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span> <span class="comment"> *</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span> <span class="comment"> */</span></div><div class="line"><a name="l01189"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gac2c0e7d21f1b2df5e76bcb4a8f84273c"> 1189</a></span> <span class="preprocessor">#define PSA_ALG_CCM                             ((psa_algorithm_t)0x05500100)</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span> <span class="comment"></span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span> <span class="comment">/** The GCM authenticated encryption algorithm.</span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span> <span class="comment"> *</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span> <span class="comment"> * The underlying block cipher is determined by the key type.</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span> <span class="comment"> */</span></div><div class="line"><a name="l01195"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0d7d02b15aaae490d38277d99f1c637c"> 1195</a></span> <span class="preprocessor">#define PSA_ALG_GCM                             ((psa_algorithm_t)0x05500200)</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span> <span class="comment"></span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span> <span class="comment">/** The Chacha20-Poly1305 AEAD algorithm.</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span> <span class="comment"> *</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span> <span class="comment"> * The ChaCha20_Poly1305 construction is defined in RFC 7539.</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span> <span class="comment"> *</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span> <span class="comment"> * Implementations must support 12-byte nonces, may support 8-byte nonces,</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span> <span class="comment"> * and should reject other sizes.</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span> <span class="comment"> *</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span> <span class="comment"> * Implementations must support 16-byte tags and should reject other sizes.</span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span> <span class="comment"> */</span></div><div class="line"><a name="l01206"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga1fec55093541640a71bdd022d4adfb9c"> 1206</a></span> <span class="preprocessor">#define PSA_ALG_CHACHA20_POLY1305               ((psa_algorithm_t)0x05100500)</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span> </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span> <span class="comment">/* In the encoding of a AEAD algorithm, the bits corresponding to</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span> <span class="comment"> * PSA_ALG_AEAD_TAG_LENGTH_MASK encode the length of the AEAD tag.</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span> <span class="comment"> * The constants for default lengths follow this encoding.</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span> <span class="comment"> */</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span> <span class="preprocessor">#define PSA_ALG_AEAD_TAG_LENGTH_MASK            ((psa_algorithm_t)0x003f0000)</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span> <span class="preprocessor">#define PSA_AEAD_TAG_LENGTH_OFFSET 16</span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span> </div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span> <span class="comment">/* In the encoding of an AEAD algorithm, the bit corresponding to</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span> <span class="comment"> * #PSA_ALG_AEAD_AT_LEAST_THIS_LENGTH_FLAG encodes the fact that the algorithm</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span> <span class="comment"> * is a wildcard algorithm. A key with such wildcard algorithm as permitted</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span> <span class="comment"> * algorithm policy can be used with any algorithm corresponding to the</span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span> <span class="comment"> * same base class and having a tag length greater than or equal to the one</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span> <span class="comment"> * encoded in #PSA_ALG_AEAD_TAG_LENGTH_MASK. */</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span> <span class="preprocessor">#define PSA_ALG_AEAD_AT_LEAST_THIS_LENGTH_FLAG  ((psa_algorithm_t)0x00008000)</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span> <span class="comment"></span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span> <span class="comment">/** Macro to build a shortened AEAD algorithm.</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span> <span class="comment"> *</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span> <span class="comment"> * A shortened AEAD algorithm is similar to the corresponding AEAD</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span> <span class="comment"> * algorithm, but has an authentication tag that consists of fewer bytes.</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span> <span class="comment"> * Depending on the algorithm, the tag length may affect the calculation</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span> <span class="comment"> * of the ciphertext.</span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span> <span class="comment"> *</span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span> <span class="comment"> * \param aead_alg      An AEAD algorithm identifier (value of type</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span> <span class="comment"> *                      #psa_algorithm_t such that #PSA_ALG_IS_AEAD(\p alg)</span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span> <span class="comment"> *                      is true).</span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span> <span class="comment"> * \param tag_length    Desired length of the authentication tag in bytes.</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span> <span class="comment"> *</span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span> <span class="comment"> * \return              The corresponding AEAD algorithm with the specified</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span> <span class="comment"> *                      length.</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span> <span class="comment"> * \return              Unspecified if \p alg is not a supported</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span> <span class="comment"> *                      AEAD algorithm or if \p tag_length is not valid</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span> <span class="comment"> *                      for the specified AEAD algorithm.</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span> <span class="comment"> */</span></div><div class="line"><a name="l01241"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga564c832837b031a73317ee619230e562"> 1241</a></span> <span class="preprocessor">#define PSA_ALG_AEAD_WITH_TAG_LENGTH(aead_alg, tag_length)              \</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span> <span class="preprocessor">    (((aead_alg) &amp; ~PSA_ALG_AEAD_TAG_LENGTH_MASK) |                     \</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span> <span class="preprocessor">     ((tag_length) &lt;&lt; PSA_AEAD_TAG_LENGTH_OFFSET &amp;                      \</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span> <span class="preprocessor">      PSA_ALG_AEAD_TAG_LENGTH_MASK))</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span> <span class="comment"></span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span> <span class="comment">/** Macro to build a shortened AEAD algorithm.</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span> <span class="comment"> *</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span> <span class="comment"> * A shortened AEAD algorithm is similar to the corresponding AEAD</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span> <span class="comment"> * algorithm, but has an authentication tag that consists of fewer bytes.</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span> <span class="comment"> * Depending on the algorithm, the tag length may affect the calculation</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span> <span class="comment"> * of the ciphertext.</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span> <span class="comment"> *</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span> <span class="comment"> * \param aead_alg      An AEAD algorithm identifier (value of type</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span> <span class="comment"> *                      #psa_algorithm_t such that #PSA_ALG_IS_AEAD(\p aead_alg)</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span> <span class="comment"> *                      is true).</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span> <span class="comment"> * \param tag_length    Desired length of the authentication tag in bytes.</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span> <span class="comment"> *</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span> <span class="comment"> * \return              The corresponding AEAD algorithm with the specified</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span> <span class="comment"> *                      length.</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span> <span class="comment"> * \return              Unspecified if \p aead_alg is not a supported</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span> <span class="comment"> *                      AEAD algorithm or if \p tag_length is not valid</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span> <span class="comment"> *                      for the specified AEAD algorithm.</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span> <span class="comment"> */</span></div><div class="line"><a name="l01264"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaf3f46f2d919d559b91517bafe3b5c8aa"> 1264</a></span> <span class="preprocessor">#define PSA_ALG_AEAD_WITH_SHORTENED_TAG(aead_alg, tag_length)           \</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span> <span class="preprocessor">    (((aead_alg) &amp; ~(PSA_ALG_AEAD_TAG_LENGTH_MASK |                     \</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span> <span class="preprocessor">                     PSA_ALG_AEAD_AT_LEAST_THIS_LENGTH_FLAG)) |         \</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span> <span class="preprocessor">     ((tag_length) &lt;&lt; PSA_AEAD_TAG_LENGTH_OFFSET &amp;                      \</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span> <span class="preprocessor">      PSA_ALG_AEAD_TAG_LENGTH_MASK))</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span> <span class="comment"></span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span> <span class="comment">/** Retrieve the tag length of a specified AEAD algorithm</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span> <span class="comment"> *</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span> <span class="comment"> * \param aead_alg      An AEAD algorithm identifier (value of type</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span> <span class="comment"> *                      #psa_algorithm_t such that #PSA_ALG_IS_AEAD(\p aead_alg)</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span> <span class="comment"> *                      is true).</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span> <span class="comment"> *</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span> <span class="comment"> * \return              The tag length specified by the input algorithm.</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span> <span class="comment"> * \return              Unspecified if \p aead_alg is not a supported</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span> <span class="comment"> *                      AEAD algorithm.</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span> <span class="comment"> */</span></div><div class="line"><a name="l01280"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga2ca539069d96ab7052196dc40b9b9eae"> 1280</a></span> <span class="preprocessor">#define PSA_ALG_AEAD_GET_TAG_LENGTH(aead_alg)                           \</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span> <span class="preprocessor">    (((aead_alg) &amp; PSA_ALG_AEAD_TAG_LENGTH_MASK) &gt;&gt;                     \</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span> <span class="preprocessor">      PSA_AEAD_TAG_LENGTH_OFFSET )</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span> <span class="comment"></span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span> <span class="comment">/** Calculate the corresponding AEAD algorithm with the default tag length.</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span> <span class="comment"> *</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span> <span class="comment"> * \param aead_alg      An AEAD algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span> <span class="comment"> *                      #PSA_ALG_IS_AEAD(\p aead_alg) is true).</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span> <span class="comment"> *</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span> <span class="comment"> * \return              The corresponding AEAD algorithm with the default</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span> <span class="comment"> *                      tag length for that algorithm.</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span> <span class="comment"> */</span></div><div class="line"><a name="l01292"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga232d216423af05473c35ae636f513e2f"> 1292</a></span> <span class="preprocessor">#define PSA_ALG_AEAD_WITH_DEFAULT_LENGTH_TAG(aead_alg)                   \</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span> <span class="preprocessor">    (                                                                    \</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span> <span class="preprocessor">        PSA_ALG_AEAD_WITH_DEFAULT_LENGTH_TAG_CASE(aead_alg, PSA_ALG_CCM) \</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span> <span class="preprocessor">        PSA_ALG_AEAD_WITH_DEFAULT_LENGTH_TAG_CASE(aead_alg, PSA_ALG_GCM) \</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span> <span class="preprocessor">        PSA_ALG_AEAD_WITH_DEFAULT_LENGTH_TAG_CASE(aead_alg, PSA_ALG_CHACHA20_POLY1305) \</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span> <span class="preprocessor">        0)</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span> <span class="preprocessor">#define PSA_ALG_AEAD_WITH_DEFAULT_LENGTH_TAG_CASE(aead_alg, ref)         \</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span> <span class="preprocessor">    PSA_ALG_AEAD_WITH_SHORTENED_TAG(aead_alg, 0) ==                      \</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span> <span class="preprocessor">    PSA_ALG_AEAD_WITH_SHORTENED_TAG(ref, 0) ?                            \</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span> <span class="preprocessor">    ref :</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span> <span class="comment"></span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span> <span class="comment">/** Macro to build an AEAD minimum-tag-length wildcard algorithm.</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span> <span class="comment"> *</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span> <span class="comment"> * A minimum-tag-length AEAD wildcard algorithm permits all AEAD algorithms</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span> <span class="comment"> * sharing the same base algorithm, and where the tag length of the specific</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span> <span class="comment"> * algorithm is equal to or larger then the minimum tag length specified by the</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span> <span class="comment"> * wildcard algorithm.</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span> <span class="comment"> *</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span> <span class="comment"> * \note    When setting the minimum required tag length to less than the</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span> <span class="comment"> *          smallest tag length allowed by the base algorithm, this effectively</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span> <span class="comment"> *          becomes an 'any-tag-length-allowed' policy for that base algorithm.</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span> <span class="comment"> *</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span> <span class="comment"> * \param aead_alg        An AEAD algorithm identifier (value of type</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span> <span class="comment"> *                        #psa_algorithm_t such that</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span> <span class="comment"> *                        #PSA_ALG_IS_AEAD(\p aead_alg) is true).</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span> <span class="comment"> * \param min_tag_length  Desired minimum length of the authentication tag in</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span> <span class="comment"> *                        bytes. This must be at least 1 and at most the largest</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span> <span class="comment"> *                        allowed tag length of the algorithm.</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span> <span class="comment"> *</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span> <span class="comment"> * \return                The corresponding AEAD wildcard algorithm with the</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span> <span class="comment"> *                        specified minimum length.</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span> <span class="comment"> * \return                Unspecified if \p aead_alg is not a supported</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span> <span class="comment"> *                        AEAD algorithm or if \p min_tag_length is less than 1</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span> <span class="comment"> *                        or too large for the specified AEAD algorithm.</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span> <span class="comment"> */</span></div><div class="line"><a name="l01327"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga09c63eca9d111ca7581b63c38bda3cd7"> 1327</a></span> <span class="preprocessor">#define PSA_ALG_AEAD_WITH_AT_LEAST_THIS_LENGTH_TAG(aead_alg, min_tag_length) \</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span> <span class="preprocessor">    ( PSA_ALG_AEAD_WITH_SHORTENED_TAG(aead_alg, min_tag_length) |            \</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span> <span class="preprocessor">      PSA_ALG_AEAD_AT_LEAST_THIS_LENGTH_FLAG )</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span> </div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span> <span class="preprocessor">#define PSA_ALG_RSA_PKCS1V15_SIGN_BASE          ((psa_algorithm_t)0x06000200)</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span> <span class="comment">/** RSA PKCS#1 v1.5 signature with hashing.</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span> <span class="comment"> *</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span> <span class="comment"> * This is the signature scheme defined by RFC 8017</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span> <span class="comment"> * (PKCS#1: RSA Cryptography Specifications) under the name</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span> <span class="comment"> * RSASSA-PKCS1-v1_5.</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span> <span class="comment"> *</span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span> <span class="comment"> *                      This includes #PSA_ALG_ANY_HASH</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span> <span class="comment"> *                      when specifying the algorithm in a usage policy.</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span> <span class="comment"> *</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span> <span class="comment"> * \return              The corresponding RSA PKCS#1 v1.5 signature algorithm.</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span> <span class="comment"> */</span></div><div class="line"><a name="l01347"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga4157e7c60c646bfbebc981e0c8c9d6a9"> 1347</a></span> <span class="preprocessor">#define PSA_ALG_RSA_PKCS1V15_SIGN(hash_alg)                             \</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span> <span class="preprocessor">    (PSA_ALG_RSA_PKCS1V15_SIGN_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span> <span class="comment">/** Raw PKCS#1 v1.5 signature.</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span> <span class="comment"> *</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span> <span class="comment"> * The input to this algorithm is the DigestInfo structure used by</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span> <span class="comment"> * RFC 8017 (PKCS#1: RSA Cryptography Specifications), &amp;sect;9.2</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span> <span class="comment"> * steps 3&amp;ndash;6.</span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span> <span class="comment"> */</span></div><div class="line"><a name="l01355"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga4215e2a78dcf834e9a625927faa2a817"> 1355</a></span> <span class="preprocessor">#define PSA_ALG_RSA_PKCS1V15_SIGN_RAW PSA_ALG_RSA_PKCS1V15_SIGN_BASE</span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span> <span class="preprocessor">#define PSA_ALG_IS_RSA_PKCS1V15_SIGN(alg)                               \</span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_RSA_PKCS1V15_SIGN_BASE)</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span> </div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span> <span class="preprocessor">#define PSA_ALG_RSA_PSS_BASE               ((psa_algorithm_t)0x06000300)</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span> <span class="comment">/** RSA PSS signature with hashing.</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span> <span class="comment"> *</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span> <span class="comment"> * This is the signature scheme defined by RFC 8017</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span> <span class="comment"> * (PKCS#1: RSA Cryptography Specifications) under the name</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span> <span class="comment"> * RSASSA-PSS, with the message generation function MGF1, and with</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span> <span class="comment"> * a salt length equal to the length of the hash. The specified</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span> <span class="comment"> * hash algorithm is used to hash the input message, to create the</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span> <span class="comment"> * salted hash, and for the mask generation.</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span> <span class="comment"> *</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span> <span class="comment"> *                      This includes #PSA_ALG_ANY_HASH</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span> <span class="comment"> *                      when specifying the algorithm in a usage policy.</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span> <span class="comment"> *</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span> <span class="comment"> * \return              The corresponding RSA PSS signature algorithm.</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span> <span class="comment"> */</span></div><div class="line"><a name="l01378"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga98e512fd99ac409fa321c666d67378f4"> 1378</a></span> <span class="preprocessor">#define PSA_ALG_RSA_PSS(hash_alg)                               \</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span> <span class="preprocessor">    (PSA_ALG_RSA_PSS_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span> <span class="preprocessor">#define PSA_ALG_IS_RSA_PSS(alg)                                 \</span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_RSA_PSS_BASE)</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span> </div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span> <span class="preprocessor">#define PSA_ALG_ECDSA_BASE                      ((psa_algorithm_t)0x06000600)</span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span> <span class="comment">/** ECDSA signature with hashing.</span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span> <span class="comment"> *</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span> <span class="comment"> * This is the ECDSA signature scheme defined by ANSI X9.62,</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span> <span class="comment"> * with a random per-message secret number (*k*).</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span> <span class="comment"> *</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span> <span class="comment"> * The representation of the signature as a byte string consists of</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span> <span class="comment"> * the concatentation of the signature values *r* and *s*. Each of</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span> <span class="comment"> * *r* and *s* is encoded as an *N*-octet string, where *N* is the length</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span> <span class="comment"> * of the base point of the curve in octets. Each value is represented</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span> <span class="comment"> * in big-endian order (most significant octet first).</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span> <span class="comment"> *</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span> <span class="comment"> *                      This includes #PSA_ALG_ANY_HASH</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span> <span class="comment"> *                      when specifying the algorithm in a usage policy.</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span> <span class="comment"> *</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span> <span class="comment"> * \return              The corresponding ECDSA signature algorithm.</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span> <span class="comment"> */</span></div><div class="line"><a name="l01404"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga319b486dc68932231650846e7c9e6889"> 1404</a></span> <span class="preprocessor">#define PSA_ALG_ECDSA(hash_alg)                                 \</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span> <span class="preprocessor">    (PSA_ALG_ECDSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span> <span class="comment">/** ECDSA signature without hashing.</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span> <span class="comment"> *</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span> <span class="comment"> * This is the same signature scheme as #PSA_ALG_ECDSA(), but</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span> <span class="comment"> * without specifying a hash algorithm. This algorithm may only be</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span> <span class="comment"> * used to sign or verify a sequence of bytes that should be an</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span> <span class="comment"> * already-calculated hash. Note that the input is padded with</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span> <span class="comment"> * zeros on the left or truncated on the left as required to fit</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span> <span class="comment"> * the curve size.</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span> <span class="comment"> */</span></div><div class="line"><a name="l01415"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga51d6b6044a62e33cae0cf64bfc3b22a4"> 1415</a></span> <span class="preprocessor">#define PSA_ALG_ECDSA_ANY PSA_ALG_ECDSA_BASE</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span> <span class="preprocessor">#define PSA_ALG_DETERMINISTIC_ECDSA_BASE        ((psa_algorithm_t)0x06000700)</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span> <span class="comment">/** Deterministic ECDSA signature with hashing.</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span> <span class="comment"> *</span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span> <span class="comment"> * This is the deterministic ECDSA signature scheme defined by RFC 6979.</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span> <span class="comment"> *</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span> <span class="comment"> * The representation of a signature is the same as with #PSA_ALG_ECDSA().</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span> <span class="comment"> *</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span> <span class="comment"> * Note that when this algorithm is used for verification, signatures</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span> <span class="comment"> * made with randomized ECDSA (#PSA_ALG_ECDSA(\p hash_alg)) with the</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span> <span class="comment"> * same private key are accepted. In other words,</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span> <span class="comment"> * #PSA_ALG_DETERMINISTIC_ECDSA(\p hash_alg) differs from</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span> <span class="comment"> * #PSA_ALG_ECDSA(\p hash_alg) only for signature, not for verification.</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span> <span class="comment"> *</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span> <span class="comment"> *                      This includes #PSA_ALG_ANY_HASH</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span> <span class="comment"> *                      when specifying the algorithm in a usage policy.</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span> <span class="comment"> *</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span> <span class="comment"> * \return              The corresponding deterministic ECDSA signature</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span> <span class="comment"> *                      algorithm.</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span> <span class="comment"> */</span></div><div class="line"><a name="l01439"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gac8ce9a865702ce001df487fdbd7dfbc6"> 1439</a></span> <span class="preprocessor">#define PSA_ALG_DETERMINISTIC_ECDSA(hash_alg)                           \</span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span> <span class="preprocessor">    (PSA_ALG_DETERMINISTIC_ECDSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span> <span class="preprocessor">#define PSA_ALG_ECDSA_DETERMINISTIC_FLAG        ((psa_algorithm_t)0x00000100)</span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span> <span class="preprocessor">#define PSA_ALG_IS_ECDSA(alg)                                           \</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK &amp; ~PSA_ALG_ECDSA_DETERMINISTIC_FLAG) ==  \</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span> <span class="preprocessor">     PSA_ALG_ECDSA_BASE)</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span> <span class="preprocessor">#define PSA_ALG_ECDSA_IS_DETERMINISTIC(alg)             \</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_ECDSA_DETERMINISTIC_FLAG) != 0)</span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span> <span class="preprocessor">#define PSA_ALG_IS_DETERMINISTIC_ECDSA(alg)                             \</span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span> <span class="preprocessor">    (PSA_ALG_IS_ECDSA(alg) &amp;&amp; PSA_ALG_ECDSA_IS_DETERMINISTIC(alg))</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span> <span class="preprocessor">#define PSA_ALG_IS_RANDOMIZED_ECDSA(alg)                                \</span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span> <span class="preprocessor">    (PSA_ALG_IS_ECDSA(alg) &amp;&amp; !PSA_ALG_ECDSA_IS_DETERMINISTIC(alg))</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span> <span class="comment"></span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span> <span class="comment">/** Edwards-curve digital signature algorithm without prehashing (PureEdDSA),</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span> <span class="comment"> * using standard parameters.</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span> <span class="comment"> *</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span> <span class="comment"> * Contexts are not supported in the current version of this specification</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span> <span class="comment"> * because there is no suitable signature interface that can take the</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span> <span class="comment"> * context as a parameter. A future version of this specification may add</span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span> <span class="comment"> * suitable functions and extend this algorithm to support contexts.</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span> <span class="comment"> *</span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span> <span class="comment"> * PureEdDSA requires an elliptic curve key on a twisted Edwards curve.</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span> <span class="comment"> * In this specification, the following curves are supported:</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span> <span class="comment"> * - #PSA_ECC_FAMILY_TWISTED_EDWARDS, 255-bit: Ed25519 as specified</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span> <span class="comment"> *   in RFC 8032.</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span> <span class="comment"> *   The curve is Edwards25519.</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span> <span class="comment"> *   The hash function used internally is SHA-512.</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span> <span class="comment"> * - #PSA_ECC_FAMILY_TWISTED_EDWARDS, 448-bit: Ed448 as specified</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span> <span class="comment"> *   in RFC 8032.</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span> <span class="comment"> *   The curve is Edwards448.</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span> <span class="comment"> *   The hash function used internally is the first 114 bytes of the</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span> <span class="comment"> *   SHAKE256 output.</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span> <span class="comment"> *</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span> <span class="comment"> * This algorithm can be used with psa_sign_message() and</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span> <span class="comment"> * psa_verify_message(). Since there is no prehashing, it cannot be used</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span> <span class="comment"> * with psa_sign_hash() or psa_verify_hash().</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span> <span class="comment"> *</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span> <span class="comment"> * The signature format is the concatenation of R and S as defined by</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span> <span class="comment"> * RFC 8032 §5.1.6 and §5.2.6 (a 64-byte string for Ed25519, a 114-byte</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span> <span class="comment"> * string for Ed448).</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span> <span class="comment"> */</span></div><div class="line"><a name="l01480"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga76d6053fb1867c2c46c5f8131c8a8cae"> 1480</a></span> <span class="preprocessor">#define PSA_ALG_PURE_EDDSA                      ((psa_algorithm_t)0x06000800)</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span> </div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span> <span class="preprocessor">#define PSA_ALG_HASH_EDDSA_BASE                 ((psa_algorithm_t)0x06000900)</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span> <span class="preprocessor">#define PSA_ALG_IS_HASH_EDDSA(alg)              \</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_HASH_EDDSA_BASE)</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span> <span class="comment"></span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span> <span class="comment">/** Edwards-curve digital signature algorithm with prehashing (HashEdDSA),</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span> <span class="comment"> * using SHA-512 and the Edwards25519 curve.</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span> <span class="comment"> *</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span> <span class="comment"> * See #PSA_ALG_PURE_EDDSA regarding context support and the signature format.</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span> <span class="comment"> *</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span> <span class="comment"> * This algorithm is Ed25519 as specified in RFC 8032.</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span> <span class="comment"> * The curve is Edwards25519.</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span> <span class="comment"> * The prehash is SHA-512.</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span> <span class="comment"> * The hash function used internally is SHA-512.</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span> <span class="comment"> *</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span> <span class="comment"> * This is a hash-and-sign algorithm: to calculate a signature,</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span> <span class="comment"> * you can either:</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span> <span class="comment"> * - call psa_sign_message() on the message;</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span> <span class="comment"> * - or calculate the SHA-512 hash of the message</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span> <span class="comment"> *   with psa_hash_compute()</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span> <span class="comment"> *   or with a multi-part hash operation started with psa_hash_setup(),</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span> <span class="comment"> *   using the hash algorithm #PSA_ALG_SHA_512,</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span> <span class="comment"> *   then sign the calculated hash with psa_sign_hash().</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span> <span class="comment"> * Verifying a signature is similar, using psa_verify_message() or</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span> <span class="comment"> * psa_verify_hash() instead of the signature function.</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span> <span class="comment"> */</span></div><div class="line"><a name="l01507"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga3be20c4293031a8f32e7cb66d26f5c3d"> 1507</a></span> <span class="preprocessor">#define PSA_ALG_ED25519PH                               \</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span> <span class="preprocessor">    (PSA_ALG_HASH_EDDSA_BASE | (PSA_ALG_SHA_512 &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span> <span class="comment"></span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span> <span class="comment">/** Edwards-curve digital signature algorithm with prehashing (HashEdDSA),</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span> <span class="comment"> * using SHAKE256 and the Edwards448 curve.</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span> <span class="comment"> *</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span> <span class="comment"> * See #PSA_ALG_PURE_EDDSA regarding context support and the signature format.</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span> <span class="comment"> *</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span> <span class="comment"> * This algorithm is Ed448 as specified in RFC 8032.</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span> <span class="comment"> * The curve is Edwards448.</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span> <span class="comment"> * The prehash is the first 64 bytes of the SHAKE256 output.</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span> <span class="comment"> * The hash function used internally is the first 114 bytes of the</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span> <span class="comment"> * SHAKE256 output.</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span> <span class="comment"> *</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span> <span class="comment"> * This is a hash-and-sign algorithm: to calculate a signature,</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span> <span class="comment"> * you can either:</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span> <span class="comment"> * - call psa_sign_message() on the message;</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span> <span class="comment"> * - or calculate the first 64 bytes of the SHAKE256 output of the message</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span> <span class="comment"> *   with psa_hash_compute()</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span> <span class="comment"> *   or with a multi-part hash operation started with psa_hash_setup(),</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span> <span class="comment"> *   using the hash algorithm #PSA_ALG_SHAKE256_512,</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span> <span class="comment"> *   then sign the calculated hash with psa_sign_hash().</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span> <span class="comment"> * Verifying a signature is similar, using psa_verify_message() or</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span> <span class="comment"> * psa_verify_hash() instead of the signature function.</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span> <span class="comment"> */</span></div><div class="line"><a name="l01532"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga1c632df795535af4334d37a08a01481b"> 1532</a></span> <span class="preprocessor">#define PSA_ALG_ED448PH                                 \</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span> <span class="preprocessor">    (PSA_ALG_HASH_EDDSA_BASE | (PSA_ALG_SHAKE256_512 &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span> </div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span> <span class="comment">/* Default definition, to be overridden if the library is extended with</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span> <span class="comment"> * more hash-and-sign algorithms that we want to keep out of this header</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span> <span class="comment"> * file. */</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span> <span class="preprocessor">#define PSA_ALG_IS_VENDOR_HASH_AND_SIGN(alg) 0</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span> <span class="comment"></span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span> <span class="comment">/** Whether the specified algorithm is a hash-and-sign algorithm.</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span> <span class="comment"> *</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span> <span class="comment"> * Hash-and-sign algorithms are asymmetric (public-key) signature algorithms</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span> <span class="comment"> * structured in two parts: first the calculation of a hash in a way that</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span> <span class="comment"> * does not depend on the key, then the calculation of a signature from the</span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span> <span class="comment"> * hash value and the key.</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span> <span class="comment"> *</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span> <span class="comment"> *</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span> <span class="comment"> * \return 1 if \p alg is a hash-and-sign algorithm, 0 otherwise.</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span> <span class="comment"> */</span></div><div class="line"><a name="l01553"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gab407c3c589ad9d081c81d7bcda558b9c"> 1553</a></span> <span class="preprocessor">#define PSA_ALG_IS_HASH_AND_SIGN(alg)                                   \</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span> <span class="preprocessor">    (PSA_ALG_IS_RSA_PSS(alg) || PSA_ALG_IS_RSA_PKCS1V15_SIGN(alg) ||    \</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span> <span class="preprocessor">     PSA_ALG_IS_ECDSA(alg) || PSA_ALG_IS_HASH_EDDSA(alg) ||             \</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span> <span class="preprocessor">     PSA_ALG_IS_VENDOR_HASH_AND_SIGN(alg))</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span> <span class="comment"></span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span> <span class="comment">/** Whether the specified algorithm is a signature algorithm that can be used</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span> <span class="comment"> * with psa_sign_message() and psa_verify_message().</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span> <span class="comment"> *</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span> <span class="comment"> *</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span> <span class="comment"> * \return 1 if alg is a signature algorithm that can be used to sign a</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span> <span class="comment"> *         message. 0 if \p alg is a signature algorithm that can only be used</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span> <span class="comment"> *         to sign an already-calculated hash. 0 if \p alg is not a signature</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span> <span class="comment"> *         algorithm. This macro can return either 0 or 1 if \p alg is not a</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span> <span class="comment"> *         supported algorithm identifier.</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span> <span class="comment"> */</span></div><div class="line"><a name="l01569"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga35b4301f4d604ef10ee9179fe92a9fcc"> 1569</a></span> <span class="preprocessor">#define PSA_ALG_IS_SIGN_MESSAGE(alg)                                    \</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span> <span class="preprocessor">    (PSA_ALG_IS_HASH_AND_SIGN(alg) || (alg) == PSA_ALG_PURE_EDDSA )</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span> <span class="comment"></span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span> <span class="comment">/** Get the hash used by a hash-and-sign signature algorithm.</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span> <span class="comment"> *</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span> <span class="comment"> * A hash-and-sign algorithm is a signature algorithm which is</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span> <span class="comment"> * composed of two phases: first a hashing phase which does not use</span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span> <span class="comment"> * the key and produces a hash of the input message, then a signing</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span> <span class="comment"> * phase which only uses the hash and the key and not the message</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span> <span class="comment"> * itself.</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span> <span class="comment"> *</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span> <span class="comment"> * \param alg   A signature algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span> <span class="comment"> *              #PSA_ALG_IS_SIGN(\p alg) is true).</span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span> <span class="comment"> *</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span> <span class="comment"> * \return      The underlying hash algorithm if \p alg is a hash-and-sign</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span> <span class="comment"> *              algorithm.</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span> <span class="comment"> * \return      0 if \p alg is a signature algorithm that does not</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span> <span class="comment"> *              follow the hash-and-sign structure.</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span> <span class="comment"> * \return      Unspecified if \p alg is not a signature algorithm or</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span> <span class="comment"> *              if it is not supported by the implementation.</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span> <span class="comment"> */</span></div><div class="line"><a name="l01590"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga3df99e8fa822930923a4fced933e38d5"> 1590</a></span> <span class="preprocessor">#define PSA_ALG_SIGN_GET_HASH(alg)                                     \</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span> <span class="preprocessor">    (PSA_ALG_IS_HASH_AND_SIGN(alg) ?                                   \</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span> <span class="preprocessor">     ((alg) &amp; PSA_ALG_HASH_MASK) == 0 ? </span><span class="comment">/*"raw" algorithm*/</span><span class="preprocessor"> 0 :        \</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span> <span class="preprocessor">     ((alg) &amp; PSA_ALG_HASH_MASK) | PSA_ALG_CATEGORY_HASH :             \</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span> <span class="comment"></span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span> <span class="comment">/** RSA PKCS#1 v1.5 encryption.</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span> <span class="comment"> */</span></div><div class="line"><a name="l01598"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga4c540d3abe43fb9abcb94f2bc51acef9"> 1598</a></span> <span class="preprocessor">#define PSA_ALG_RSA_PKCS1V15_CRYPT              ((psa_algorithm_t)0x07000200)</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span> </div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span> <span class="preprocessor">#define PSA_ALG_RSA_OAEP_BASE                   ((psa_algorithm_t)0x07000300)</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span> <span class="comment">/** RSA OAEP encryption.</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span> <span class="comment"> *</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span> <span class="comment"> * This is the encryption scheme defined by RFC 8017</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span> <span class="comment"> * (PKCS#1: RSA Cryptography Specifications) under the name</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span> <span class="comment"> * RSAES-OAEP, with the message generation function MGF1.</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span> <span class="comment"> *</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span> <span class="comment"> * \param hash_alg      The hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true) to use</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span> <span class="comment"> *                      for MGF1.</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span> <span class="comment"> *</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span> <span class="comment"> * \return              The corresponding RSA OAEP encryption algorithm.</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span> <span class="comment"> */</span></div><div class="line"><a name="l01615"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0e2e1159c3466477a15a50a41f054a76"> 1615</a></span> <span class="preprocessor">#define PSA_ALG_RSA_OAEP(hash_alg)                              \</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span> <span class="preprocessor">    (PSA_ALG_RSA_OAEP_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span> <span class="preprocessor">#define PSA_ALG_IS_RSA_OAEP(alg)                                \</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_RSA_OAEP_BASE)</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span> <span class="preprocessor">#define PSA_ALG_RSA_OAEP_GET_HASH(alg)                          \</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span> <span class="preprocessor">    (PSA_ALG_IS_RSA_OAEP(alg) ?                                 \</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span> <span class="preprocessor">     ((alg) &amp; PSA_ALG_HASH_MASK) | PSA_ALG_CATEGORY_HASH :      \</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span> </div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span> <span class="preprocessor">#define PSA_ALG_HKDF_BASE                       ((psa_algorithm_t)0x08000100)</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span> <span class="comment">/** Macro to build an HKDF algorithm.</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span> <span class="comment"> *</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span> <span class="comment"> * For example, `PSA_ALG_HKDF(PSA_ALG_SHA256)` is HKDF using HMAC-SHA-256.</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span> <span class="comment"> *</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span> <span class="comment"> * This key derivation algorithm uses the following inputs:</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SALT is the salt used in the "extract" step.</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span> <span class="comment"> *   It is optional; if omitted, the derivation uses an empty salt.</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SECRET is the secret key used in the "extract" step.</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_INFO is the info string used in the "expand" step.</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span> <span class="comment"> * You must pass #PSA_KEY_DERIVATION_INPUT_SALT before #PSA_KEY_DERIVATION_INPUT_SECRET.</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span> <span class="comment"> * You may pass #PSA_KEY_DERIVATION_INPUT_INFO at any time after steup and before</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span> <span class="comment"> * starting to generate output.</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span> <span class="comment"> *</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span> <span class="comment"> *</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span> <span class="comment"> * \return              The corresponding HKDF algorithm.</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span> <span class="comment"> */</span></div><div class="line"><a name="l01645"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0df392f5c17850d6398e1d53b4f52ece"> 1645</a></span> <span class="preprocessor">#define PSA_ALG_HKDF(hash_alg)                                  \</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span> <span class="preprocessor">    (PSA_ALG_HKDF_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span> <span class="comment">/** Whether the specified algorithm is an HKDF algorithm.</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span> <span class="comment"> *</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span> <span class="comment"> * HKDF is a family of key derivation algorithms that are based on a hash</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span> <span class="comment"> * function and the HMAC construction.</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span> <span class="comment"> *</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span> <span class="comment"> *</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span> <span class="comment"> * \return 1 if \c alg is an HKDF algorithm, 0 otherwise.</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span> <span class="comment"> *         This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span> <span class="comment"> *         key derivation algorithm identifier.</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span> <span class="comment"> */</span></div><div class="line"><a name="l01658"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga8d5188f3139bfcbd51f68d2a2c4127c6"> 1658</a></span> <span class="preprocessor">#define PSA_ALG_IS_HKDF(alg)                            \</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_HKDF_BASE)</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span> <span class="preprocessor">#define PSA_ALG_HKDF_GET_HASH(hkdf_alg)                         \</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span> <span class="preprocessor">    (PSA_ALG_CATEGORY_HASH | ((hkdf_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span> </div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span> <span class="preprocessor">#define PSA_ALG_TLS12_PRF_BASE                  ((psa_algorithm_t)0x08000200)</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span> <span class="comment">/** Macro to build a TLS-1.2 PRF algorithm.</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span> <span class="comment"> *</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span> <span class="comment"> * TLS 1.2 uses a custom pseudorandom function (PRF) for key schedule,</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span> <span class="comment"> * specified in Section 5 of RFC 5246. It is based on HMAC and can be</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span> <span class="comment"> * used with either SHA-256 or SHA-384.</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span> <span class="comment"> *</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span> <span class="comment"> * This key derivation algorithm uses the following inputs, which must be</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span> <span class="comment"> * passed in the order given here:</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SEED is the seed.</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SECRET is the secret key.</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_LABEL is the label.</span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span> <span class="comment"> *</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span> <span class="comment"> * For the application to TLS-1.2 key expansion, the seed is the</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span> <span class="comment"> * concatenation of ServerHello.Random + ClientHello.Random,</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span> <span class="comment"> * and the label is "key expansion".</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span> <span class="comment"> *</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span> <span class="comment"> * For example, `PSA_ALG_TLS12_PRF(PSA_ALG_SHA256)` represents the</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span> <span class="comment"> * TLS 1.2 PRF using HMAC-SHA-256.</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span> <span class="comment"> *</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span> <span class="comment"> *</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span> <span class="comment"> * \return              The corresponding TLS-1.2 PRF algorithm.</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span> <span class="comment"> */</span></div><div class="line"><a name="l01690"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga19e32546245c649b250bae8b54874b74"> 1690</a></span> <span class="preprocessor">#define PSA_ALG_TLS12_PRF(hash_alg)                                  \</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span> <span class="preprocessor">    (PSA_ALG_TLS12_PRF_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span> <span class="comment"></span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span> <span class="comment">/** Whether the specified algorithm is a TLS-1.2 PRF algorithm.</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span> <span class="comment"> *</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span> <span class="comment"> *</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span> <span class="comment"> * \return 1 if \c alg is a TLS-1.2 PRF algorithm, 0 otherwise.</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span> <span class="comment"> *         This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span> <span class="comment"> *         key derivation algorithm identifier.</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span> <span class="comment"> */</span></div><div class="line"><a name="l01701"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga8170c528a530e5f23e7555df533b799f"> 1701</a></span> <span class="preprocessor">#define PSA_ALG_IS_TLS12_PRF(alg)                                    \</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_TLS12_PRF_BASE)</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span> <span class="preprocessor">#define PSA_ALG_TLS12_PRF_GET_HASH(hkdf_alg)                         \</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span> <span class="preprocessor">    (PSA_ALG_CATEGORY_HASH | ((hkdf_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span> </div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span> <span class="preprocessor">#define PSA_ALG_TLS12_PSK_TO_MS_BASE            ((psa_algorithm_t)0x08000300)</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span> <span class="comment">/** Macro to build a TLS-1.2 PSK-to-MasterSecret algorithm.</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span> <span class="comment"> *</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span> <span class="comment"> * In a pure-PSK handshake in TLS 1.2, the master secret is derived</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span> <span class="comment"> * from the PreSharedKey (PSK) through the application of padding</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span> <span class="comment"> * (RFC 4279, Section 2) and the TLS-1.2 PRF (RFC 5246, Section 5).</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span> <span class="comment"> * The latter is based on HMAC and can be used with either SHA-256</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span> <span class="comment"> * or SHA-384.</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span> <span class="comment"> *</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span> <span class="comment"> * This key derivation algorithm uses the following inputs, which must be</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span> <span class="comment"> * passed in the order given here:</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SEED is the seed.</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SECRET is the secret key.</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_LABEL is the label.</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span> <span class="comment"> *</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span> <span class="comment"> * For the application to TLS-1.2, the seed (which is</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span> <span class="comment"> * forwarded to the TLS-1.2 PRF) is the concatenation of the</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span> <span class="comment"> * ClientHello.Random + ServerHello.Random,</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span> <span class="comment"> * and the label is "master secret" or "extended master secret".</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span> <span class="comment"> *</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span> <span class="comment"> * For example, `PSA_ALG_TLS12_PSK_TO_MS(PSA_ALG_SHA256)` represents the</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span> <span class="comment"> * TLS-1.2 PSK to MasterSecret derivation PRF using HMAC-SHA-256.</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span> <span class="comment"> *</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span> <span class="comment"> *</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span> <span class="comment"> * \return              The corresponding TLS-1.2 PSK to MS algorithm.</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span> <span class="comment"> */</span></div><div class="line"><a name="l01736"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gae5cb22d8a3f774dc3e3c1e9c1cefd76a"> 1736</a></span> <span class="preprocessor">#define PSA_ALG_TLS12_PSK_TO_MS(hash_alg)                                  \</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span> <span class="preprocessor">    (PSA_ALG_TLS12_PSK_TO_MS_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span> <span class="comment"></span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span> <span class="comment">/** Whether the specified algorithm is a TLS-1.2 PSK to MS algorithm.</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span> <span class="comment"> *</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span> <span class="comment"> *</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span> <span class="comment"> * \return 1 if \c alg is a TLS-1.2 PSK to MS algorithm, 0 otherwise.</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span> <span class="comment"> *         This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span> <span class="comment"> *         key derivation algorithm identifier.</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span> <span class="comment"> */</span></div><div class="line"><a name="l01747"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga2115ab875b5b49d271364347a872c036"> 1747</a></span> <span class="preprocessor">#define PSA_ALG_IS_TLS12_PSK_TO_MS(alg)                                    \</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_TLS12_PSK_TO_MS_BASE)</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span> <span class="preprocessor">#define PSA_ALG_TLS12_PSK_TO_MS_GET_HASH(hkdf_alg)                         \</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span> <span class="preprocessor">    (PSA_ALG_CATEGORY_HASH | ((hkdf_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span> </div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span> <span class="comment">/* This flag indicates whether the key derivation algorithm is suitable for</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span> <span class="comment"> * use on low-entropy secrets such as password - these algorithms are also</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span> <span class="comment"> * known as key stretching or password hashing schemes. These are also the</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span> <span class="comment"> * algorithms that accepts inputs of type #PSA_KEY_DERIVATION_INPUT_PASSWORD.</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span> <span class="comment"> *</span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span> <span class="comment"> * Those algorithms cannot be combined with a key agreement algorithm.</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span> <span class="comment"> */</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span> <span class="preprocessor">#define PSA_ALG_KEY_DERIVATION_STRETCHING_FLAG  ((psa_algorithm_t)0x00800000)</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span> </div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span> <span class="preprocessor">#define PSA_ALG_PBKDF2_HMAC_BASE                ((psa_algorithm_t)0x08800100)</span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span> <span class="comment">/** Macro to build a PBKDF2-HMAC password hashing / key stretching algorithm.</span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span> <span class="comment"> *</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span> <span class="comment"> * PBKDF2 is defined by PKCS#5, republished as RFC 8018 (section 5.2).</span></div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span> <span class="comment"> * This macro specifies the PBKDF2 algorithm constructed using a PRF based on</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span> <span class="comment"> * HMAC with the specified hash.</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span> <span class="comment"> * For example, `PSA_ALG_PBKDF2_HMAC(PSA_ALG_SHA256)` specifies PBKDF2</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span> <span class="comment"> * using the PRF HMAC-SHA-256.</span></div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span> <span class="comment"> *</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span> <span class="comment"> * This key derivation algorithm uses the following inputs, which must be</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span> <span class="comment"> * provided in the following order:</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_COST is the iteration count.</span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span> <span class="comment"> *   This input step must be used exactly once.</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_SALT is the salt.</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span> <span class="comment"> *   This input step must be used one or more times; if used several times, the</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span> <span class="comment"> *   inputs will be concatenated. This can be used to build the final salt</span></div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span> <span class="comment"> *   from multiple sources, both public and secret (also known as pepper).</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span> <span class="comment"> * - #PSA_KEY_DERIVATION_INPUT_PASSWORD is the password to be hashed.</span></div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span> <span class="comment"> *   This input step must be used exactly once.</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span> <span class="comment"> *</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span> <span class="comment"> *</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span> <span class="comment"> * \return              The corresponding PBKDF2-HMAC-XXX algorithm.</span></div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span> <span class="comment"> */</span></div><div class="line"><a name="l01788"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaf1ea249d32bf2271c396b208818c6211"> 1788</a></span> <span class="preprocessor">#define PSA_ALG_PBKDF2_HMAC(hash_alg)                                  \</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span> <span class="preprocessor">    (PSA_ALG_PBKDF2_HMAC_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span> <span class="comment"></span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span> <span class="comment">/** Whether the specified algorithm is a PBKDF2-HMAC algorithm.</span></div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span> <span class="comment"> *</span></div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span> <span class="comment"> *</span></div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span> <span class="comment"> * \return 1 if \c alg is a PBKDF2-HMAC algorithm, 0 otherwise.</span></div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span> <span class="comment"> *         This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span> <span class="comment"> *         key derivation algorithm identifier.</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span> <span class="comment"> */</span></div><div class="line"><a name="l01799"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0e255e53cc3279a19b855703ca43e3c1"> 1799</a></span> <span class="preprocessor">#define PSA_ALG_IS_PBKDF2_HMAC(alg)                                    \</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK) == PSA_ALG_PBKDF2_HMAC_BASE)</span></div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span> <span class="comment"></span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span> <span class="comment">/** The PBKDF2-AES-CMAC-PRF-128 password hashing / key stretching algorithm.</span></div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span> <span class="comment"> *</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span> <span class="comment"> * PBKDF2 is defined by PKCS#5, republished as RFC 8018 (section 5.2).</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span> <span class="comment"> * This macro specifies the PBKDF2 algorithm constructed using the</span></div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span> <span class="comment"> * AES-CMAC-PRF-128 PRF specified by RFC 4615.</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span> <span class="comment"> *</span></div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span> <span class="comment"> * This key derivation algorithm uses the same inputs as</span></div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span> <span class="comment"> * #PSA_ALG_PBKDF2_HMAC() with the same constraints.</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span> <span class="comment"> */</span></div><div class="line"><a name="l01811"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gae917f201db1efaaf668edd85ac8fb87f"> 1811</a></span> <span class="preprocessor">#define PSA_ALG_PBKDF2_AES_CMAC_PRF_128         ((psa_algorithm_t)0x08800200)</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span> </div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span> <span class="preprocessor">#define PSA_ALG_KEY_DERIVATION_MASK             ((psa_algorithm_t)0xfe00ffff)</span></div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span> <span class="preprocessor">#define PSA_ALG_KEY_AGREEMENT_MASK              ((psa_algorithm_t)0xffff0000)</span></div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span> <span class="comment"></span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span> <span class="comment">/** Macro to build a combined algorithm that chains a key agreement with</span></div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span> <span class="comment"> * a key derivation.</span></div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span> <span class="comment"> *</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span> <span class="comment"> * \param ka_alg        A key agreement algorithm (\c PSA_ALG_XXX value such</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span> <span class="comment"> *                      that #PSA_ALG_IS_KEY_AGREEMENT(\p ka_alg) is true).</span></div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span> <span class="comment"> * \param kdf_alg       A key derivation algorithm (\c PSA_ALG_XXX value such</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span> <span class="comment"> *                      that #PSA_ALG_IS_KEY_DERIVATION(\p kdf_alg) is true).</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span> <span class="comment"> *</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span> <span class="comment"> * \return              The corresponding key agreement and derivation</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span> <span class="comment"> *                      algorithm.</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span> <span class="comment"> * \return              Unspecified if \p ka_alg is not a supported</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span> <span class="comment"> *                      key agreement algorithm or \p kdf_alg is not a</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span> <span class="comment"> *                      supported key derivation algorithm.</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span> <span class="comment"> */</span></div><div class="line"><a name="l01830"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga78bb81cffb87a635c247725eeb2a2682"> 1830</a></span> <span class="preprocessor">#define PSA_ALG_KEY_AGREEMENT(ka_alg, kdf_alg)  \</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span> <span class="preprocessor">    ((ka_alg) | (kdf_alg))</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span> </div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span> <span class="preprocessor">#define PSA_ALG_KEY_AGREEMENT_GET_KDF(alg)                              \</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_KEY_DERIVATION_MASK) | PSA_ALG_CATEGORY_KEY_DERIVATION)</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span> </div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span> <span class="preprocessor">#define PSA_ALG_KEY_AGREEMENT_GET_BASE(alg)                             \</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_KEY_AGREEMENT_MASK) | PSA_ALG_CATEGORY_KEY_AGREEMENT)</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span> <span class="comment"></span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span> <span class="comment">/** Whether the specified algorithm is a raw key agreement algorithm.</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span> <span class="comment"> *</span></div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span> <span class="comment"> * A raw key agreement algorithm is one that does not specify</span></div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span> <span class="comment"> * a key derivation function.</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span> <span class="comment"> * Usually, raw key agreement algorithms are constructed directly with</span></div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span> <span class="comment"> * a \c PSA_ALG_xxx macro while non-raw key agreement algorithms are</span></div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span> <span class="comment"> * constructed with #PSA_ALG_KEY_AGREEMENT().</span></div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span> <span class="comment"> *</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span> <span class="comment"> *</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span> <span class="comment"> * \return 1 if \p alg is a raw key agreement algorithm, 0 otherwise.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span> <span class="comment"> *         This macro may return either 0 or 1 if \p alg is not a supported</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span> <span class="comment"> */</span></div><div class="line"><a name="l01853"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga98d2a1c064ef007e9cf993948b9a2a27"> 1853</a></span> <span class="preprocessor">#define PSA_ALG_IS_RAW_KEY_AGREEMENT(alg)                               \</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span> <span class="preprocessor">    (PSA_ALG_IS_KEY_AGREEMENT(alg) &amp;&amp;                                   \</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span> <span class="preprocessor">     PSA_ALG_KEY_AGREEMENT_GET_KDF(alg) == PSA_ALG_CATEGORY_KEY_DERIVATION)</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span> </div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span> <span class="preprocessor">#define PSA_ALG_IS_KEY_DERIVATION_OR_AGREEMENT(alg)     \</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span> <span class="preprocessor">    ((PSA_ALG_IS_KEY_DERIVATION(alg) || PSA_ALG_IS_KEY_AGREEMENT(alg)))</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span> <span class="comment"></span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span> <span class="comment">/** The finite-field Diffie-Hellman (DH) key agreement algorithm.</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span> <span class="comment"> *</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span> <span class="comment"> * The shared secret produced by key agreement is</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span> <span class="comment"> * `g^{ab}` in big-endian format.</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span> <span class="comment"> * It is `ceiling(m / 8)` bytes long where `m` is the size of the prime `p`</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span> <span class="comment"> * in bits.</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span> <span class="comment"> */</span></div><div class="line"><a name="l01867"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0ebbb6f93a05b6511e6f108ffd2d1eb4"> 1867</a></span> <span class="preprocessor">#define PSA_ALG_FFDH                            ((psa_algorithm_t)0x09010000)</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span> <span class="comment"></span></div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span> <span class="comment">/** Whether the specified algorithm is a finite field Diffie-Hellman algorithm.</span></div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span> <span class="comment"> *</span></div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span> <span class="comment"> * This includes the raw finite field Diffie-Hellman algorithm as well as</span></div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span> <span class="comment"> * finite-field Diffie-Hellman followed by any supporter key derivation</span></div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span> <span class="comment"> * algorithm.</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span> <span class="comment"> *</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span> <span class="comment"> *</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span> <span class="comment"> * \return 1 if \c alg is a finite field Diffie-Hellman algorithm, 0 otherwise.</span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span> <span class="comment"> *         This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span> <span class="comment"> *         key agreement algorithm identifier.</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span> <span class="comment"> */</span></div><div class="line"><a name="l01881"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gaa3cf76164cd9375af4fb8a291078a19e"> 1881</a></span> <span class="preprocessor">#define PSA_ALG_IS_FFDH(alg) \</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span> <span class="preprocessor">    (PSA_ALG_KEY_AGREEMENT_GET_BASE(alg) == PSA_ALG_FFDH)</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span> <span class="comment"></span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span> <span class="comment">/** The elliptic curve Diffie-Hellman (ECDH) key agreement algorithm.</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span> <span class="comment"> *</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span> <span class="comment"> * The shared secret produced by key agreement is the x-coordinate of</span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span> <span class="comment"> * the shared secret point. It is always `ceiling(m / 8)` bytes long where</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span> <span class="comment"> * `m` is the bit size associated with the curve, i.e. the bit size of the</span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span> <span class="comment"> * order of the curve's coordinate field. When `m` is not a multiple of 8,</span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span> <span class="comment"> * the byte containing the most significant bit of the shared secret</span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span> <span class="comment"> * is padded with zero bits. The byte order is either little-endian</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span> <span class="comment"> * or big-endian depending on the curve type.</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span> <span class="comment"> *</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span> <span class="comment"> * - For Montgomery curves (curve types `PSA_ECC_FAMILY_CURVEXXX`),</span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span> <span class="comment"> *   the shared secret is the x-coordinate of `d_A Q_B = d_B Q_A`</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span> <span class="comment"> *   in little-endian byte order.</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span> <span class="comment"> *   The bit size is 448 for Curve448 and 255 for Curve25519.</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span> <span class="comment"> * - For Weierstrass curves over prime fields (curve types</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span> <span class="comment"> *   `PSA_ECC_FAMILY_SECPXXX` and `PSA_ECC_FAMILY_BRAINPOOL_PXXX`),</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span> <span class="comment"> *   the shared secret is the x-coordinate of `d_A Q_B = d_B Q_A`</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span> <span class="comment"> *   in big-endian byte order.</span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span> <span class="comment"> *   The bit size is `m = ceiling(log_2(p))` for the field `F_p`.</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span> <span class="comment"> * - For Weierstrass curves over binary fields (curve types</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span> <span class="comment"> *   `PSA_ECC_FAMILY_SECTXXX`),</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span> <span class="comment"> *   the shared secret is the x-coordinate of `d_A Q_B = d_B Q_A`</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span> <span class="comment"> *   in big-endian byte order.</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span> <span class="comment"> *   The bit size is `m` for the field `F_{2^m}`.</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span> <span class="comment"> */</span></div><div class="line"><a name="l01909"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gab2dbcf71b63785e7dd7b54a100edee43"> 1909</a></span> <span class="preprocessor">#define PSA_ALG_ECDH                            ((psa_algorithm_t)0x09020000)</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span> <span class="comment"></span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span> <span class="comment">/** Whether the specified algorithm is an elliptic curve Diffie-Hellman</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span> <span class="comment"> * algorithm.</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span> <span class="comment"> *</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span> <span class="comment"> * This includes the raw elliptic curve Diffie-Hellman algorithm as well as</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span> <span class="comment"> * elliptic curve Diffie-Hellman followed by any supporter key derivation</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span> <span class="comment"> * algorithm.</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span> <span class="comment"> *</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span> <span class="comment"> *</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span> <span class="comment"> * \return 1 if \c alg is an elliptic curve Diffie-Hellman algorithm,</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span> <span class="comment"> *         0 otherwise.</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span> <span class="comment"> *         This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span> <span class="comment"> *         key agreement algorithm identifier.</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span> <span class="comment"> */</span></div><div class="line"><a name="l01925"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga9d9b6533d2a6bea7bac7ae01facb820d"> 1925</a></span> <span class="preprocessor">#define PSA_ALG_IS_ECDH(alg) \</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span> <span class="preprocessor">    (PSA_ALG_KEY_AGREEMENT_GET_BASE(alg) == PSA_ALG_ECDH)</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span> <span class="comment"></span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span> <span class="comment">/** Whether the specified algorithm encoding is a wildcard.</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span> <span class="comment"> *</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span> <span class="comment"> * Wildcard values may only be used to set the usage algorithm field in</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span> <span class="comment"> * a policy, not to perform an operation.</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span> <span class="comment"> *</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span> <span class="comment"> *</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span> <span class="comment"> * \return 1 if \c alg is a wildcard algorithm encoding.</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span> <span class="comment"> * \return 0 if \c alg is a non-wildcard algorithm encoding (suitable for</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span> <span class="comment"> *         an operation).</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span> <span class="comment"> * \return This macro may return either 0 or 1 if \c alg is not a supported</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span> <span class="comment"> *         algorithm identifier.</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span> <span class="comment"> */</span></div><div class="line"><a name="l01941"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga0045dca0f24c460ee09665458f46a391"> 1941</a></span> <span class="preprocessor">#define PSA_ALG_IS_WILDCARD(alg)                            \</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span> <span class="preprocessor">    (PSA_ALG_IS_HASH_AND_SIGN(alg) ?                        \</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span> <span class="preprocessor">     PSA_ALG_SIGN_GET_HASH(alg) == PSA_ALG_ANY_HASH :       \</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span> <span class="preprocessor">     PSA_ALG_IS_MAC(alg) ?                                  \</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span> <span class="preprocessor">     (alg &amp; PSA_ALG_MAC_AT_LEAST_THIS_LENGTH_FLAG) != 0 :   \</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span> <span class="preprocessor">     PSA_ALG_IS_AEAD(alg) ?                                 \</span></div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span> <span class="preprocessor">     (alg &amp; PSA_ALG_AEAD_AT_LEAST_THIS_LENGTH_FLAG) != 0 :  \</span></div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span> <span class="preprocessor">     (alg) == PSA_ALG_ANY_HASH)</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span> <span class="comment"></span></div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span> <span class="comment">/** Get the hash used by a composite algorithm.</span></div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span> <span class="comment"> *</span></div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span> <span class="comment"> * \param alg An algorithm identifier (value of type #psa_algorithm_t).</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span> <span class="comment"> *</span></div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span> <span class="comment"> * \return The underlying hash algorithm if alg is a composite algorithm that</span></div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span> <span class="comment"> * uses a hash algorithm.</span></div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span> <span class="comment"> *</span></div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span> <span class="comment"> * \return \c 0 if alg is not a composite algorithm that uses a hash.</span></div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span> <span class="comment"> */</span></div><div class="line"><a name="l01959"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga181b0fe4619c1a70c5ef82f28eea09f5"> 1959</a></span> <span class="preprocessor">#define PSA_ALG_GET_HASH(alg) \</span></div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span> <span class="preprocessor">        (((alg) &amp; 0x000000ff) == 0 ? ((psa_algorithm_t)0) : 0x02000000 | ((alg) &amp; 0x000000ff))</span></div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span> <span class="comment"></span></div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span> <span class="comment"></span></div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span> <span class="comment">/** \defgroup key_lifetimes Key lifetimes</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span> <span class="comment"> * @{</span></div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span> <span class="comment"> */</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span> <span class="comment"></span></div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span> <span class="comment">/** The default lifetime for volatile keys.</span></div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span> <span class="comment"> *</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span> <span class="comment"> * A volatile key only exists as long as the identifier to it is not destroyed.</span></div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span> <span class="comment"> * The key material is guaranteed to be erased on a power reset.</span></div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span> <span class="comment"> *</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span> <span class="comment"> * A key with this lifetime is typically stored in the RAM area of the</span></div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span> <span class="comment"> * PSA Crypto subsystem. However this is an implementation choice.</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span> <span class="comment"> * If an implementation stores data about the key in a non-volatile memory,</span></div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span> <span class="comment"> * it must release all the resources associated with the key and erase the</span></div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span> <span class="comment"> * key material if the calling application terminates.</span></div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span> <span class="comment"> */</span></div><div class="line"><a name="l01979"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga8b438870ba69489b685730d346455108"> 1979</a></span> <span class="preprocessor">#define PSA_KEY_LIFETIME_VOLATILE               ((psa_key_lifetime_t)0x00000000)</span></div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span> <span class="comment"></span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span> <span class="comment">/** The default lifetime for persistent keys.</span></div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span> <span class="comment"> *</span></div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span> <span class="comment"> * A persistent key remains in storage until it is explicitly destroyed or</span></div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span> <span class="comment"> * until the corresponding storage area is wiped. This specification does</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span> <span class="comment"> * not define any mechanism to wipe a storage area, but integrations may</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span> <span class="comment"> * provide their own mechanism (for example to perform a factory reset,</span></div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span> <span class="comment"> * to prepare for device refurbishment, or to uninstall an application).</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span> <span class="comment"> *</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span> <span class="comment"> * This lifetime value is the default storage area for the calling</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span> <span class="comment"> * application. Integrations of Mbed TLS may support other persistent lifetimes.</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span> <span class="comment"> * See ::psa_key_lifetime_t for more information.</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span> <span class="comment"> */</span></div><div class="line"><a name="l01993"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga3713a01c5fcd5f7eae46ff22ceaf6d02"> 1993</a></span> <span class="preprocessor">#define PSA_KEY_LIFETIME_PERSISTENT             ((psa_key_lifetime_t)0x00000001)</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span> <span class="comment"></span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span> <span class="comment">/** The persistence level of volatile keys.</span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span> <span class="comment"> *</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span> <span class="comment"> * See ::psa_key_persistence_t for more information.</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span> <span class="comment"> */</span></div><div class="line"><a name="l01999"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#gaf3d1317436d19a15e7f2be1b9827edfc"> 1999</a></span> <span class="preprocessor">#define PSA_KEY_PERSISTENCE_VOLATILE            ((psa_key_persistence_t)0x00)</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span> <span class="comment"></span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span> <span class="comment">/** The default persistence level for persistent keys.</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span> <span class="comment"> *</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span> <span class="comment"> * See ::psa_key_persistence_t for more information.</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span> <span class="comment"> */</span></div><div class="line"><a name="l02005"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#gafc5d5c94f98e885ae5a2bb789deb4d91"> 2005</a></span> <span class="preprocessor">#define PSA_KEY_PERSISTENCE_DEFAULT             ((psa_key_persistence_t)0x01)</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span> <span class="comment"></span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span> <span class="comment">/** A persistence level indicating that a key is never destroyed.</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span> <span class="comment"> *</span></div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span> <span class="comment"> * See ::psa_key_persistence_t for more information.</span></div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span> <span class="comment"> */</span></div><div class="line"><a name="l02011"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga6be0f97ba7fb86f626b3fd2b03a1ac79"> 2011</a></span> <span class="preprocessor">#define PSA_KEY_PERSISTENCE_READ_ONLY           ((psa_key_persistence_t)0xff)</span></div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span> </div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span> <span class="preprocessor">#define PSA_KEY_LIFETIME_GET_PERSISTENCE(lifetime)      \</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span> <span class="preprocessor">    ((psa_key_persistence_t)((lifetime) &amp; 0x000000ff))</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span> </div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span> <span class="preprocessor">#define PSA_KEY_LIFETIME_GET_LOCATION(lifetime)      \</span></div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span> <span class="preprocessor">    ((psa_key_location_t)((lifetime) &gt;&gt; 8))</span></div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span> <span class="comment"></span></div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span> <span class="comment">/** Whether a key lifetime indicates that the key is volatile.</span></div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span> <span class="comment"> *</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span> <span class="comment"> * A volatile key is automatically destroyed by the implementation when</span></div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span> <span class="comment"> * the application instance terminates. In particular, a volatile key</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span> <span class="comment"> * is automatically destroyed on a power reset of the device.</span></div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span> <span class="comment"> *</span></div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span> <span class="comment"> * A key that is not volatile is persistent. Persistent keys are</span></div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span> <span class="comment"> * preserved until the application explicitly destroys them or until an</span></div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span> <span class="comment"> * implementation-specific device management event occurs (for example,</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span> <span class="comment"> * a factory reset).</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span> <span class="comment"> *</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span> <span class="comment"> * \param lifetime      The lifetime value to query (value of type</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span> <span class="comment"> *                      ::psa_key_lifetime_t).</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span> <span class="comment"> *</span></div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span> <span class="comment"> * \return \c 1 if the key is volatile, otherwise \c 0.</span></div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span> <span class="comment"> */</span></div><div class="line"><a name="l02035"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga63d63adbfc947cab4dee4f4b39e840a1"> 2035</a></span> <span class="preprocessor">#define PSA_KEY_LIFETIME_IS_VOLATILE(lifetime)  \</span></div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span> <span class="preprocessor">    (PSA_KEY_LIFETIME_GET_PERSISTENCE(lifetime) == \</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span> <span class="preprocessor">     PSA_KEY_PERSISTENCE_VOLATILE)</span></div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span> <span class="comment"></span></div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span> <span class="comment">/** Whether a key lifetime indicates that the key is read-only.</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span> <span class="comment"> *</span></div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span> <span class="comment"> * Read-only keys cannot be created or destroyed through the PSA Crypto API.</span></div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span> <span class="comment"> * They must be created through platform-specific means that bypass the API.</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span> <span class="comment"> *</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span> <span class="comment"> * Some platforms may offer ways to destroy read-only keys. For example,</span></div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span> <span class="comment"> * consider a platform with multiple levels of privilege, where a</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span> <span class="comment"> * low-privilege application can use a key but is not allowed to destroy</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span> <span class="comment"> * it, and the platform exposes the key to the application with a read-only</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span> <span class="comment"> * lifetime. High-privilege code can destroy the key even though the</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span> <span class="comment"> * application sees the key as read-only.</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span> <span class="comment"> *</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span> <span class="comment"> * \param lifetime      The lifetime value to query (value of type</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span> <span class="comment"> *                      ::psa_key_lifetime_t).</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span> <span class="comment"> *</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span> <span class="comment"> * \return \c 1 if the key is read-only, otherwise \c 0.</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span> <span class="comment"> */</span></div><div class="line"><a name="l02056"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga9a0c9ef3051882eb5154c88a0ed46d0e"> 2056</a></span> <span class="preprocessor">#define PSA_KEY_LIFETIME_IS_READ_ONLY(lifetime)  \</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span> <span class="preprocessor">    (PSA_KEY_LIFETIME_GET_PERSISTENCE(lifetime) == \</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span> <span class="preprocessor">     PSA_KEY_PERSISTENCE_READ_ONLY)</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span> <span class="comment"></span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span> <span class="comment">/** Construct a lifetime from a persistence level and a location.</span></div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span> <span class="comment"> *</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span> <span class="comment"> * \param persistence   The persistence level</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span> <span class="comment"> *                      (value of type ::psa_key_persistence_t).</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span> <span class="comment"> * \param location      The location indicator</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span> <span class="comment"> *                      (value of type ::psa_key_location_t).</span></div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span> <span class="comment"> *</span></div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span> <span class="comment"> * \return The constructed lifetime value.</span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span> <span class="comment"> */</span></div><div class="line"><a name="l02069"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#gaef4d244b4d33ae7876ed87226b8112aa"> 2069</a></span> <span class="preprocessor">#define PSA_KEY_LIFETIME_FROM_PERSISTENCE_AND_LOCATION(persistence, location) \</span></div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span> <span class="preprocessor">    ((location) &lt;&lt; 8 | (persistence))</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span> <span class="comment"></span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span> <span class="comment">/** The local storage area for persistent keys.</span></div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span> <span class="comment"> *</span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span> <span class="comment"> * This storage area is available on all systems that can store persistent</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span> <span class="comment"> * keys without delegating the storage to a third-party cryptoprocessor.</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span> <span class="comment"> *</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span> <span class="comment"> * See ::psa_key_location_t for more information.</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span> <span class="comment"> */</span></div><div class="line"><a name="l02079"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga3fbfe4a4cf7430a51cf740fe05b2ab27"> 2079</a></span> <span class="preprocessor">#define PSA_KEY_LOCATION_LOCAL_STORAGE          ((psa_key_location_t)0x000000)</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span> </div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span> <span class="preprocessor">#define PSA_KEY_LOCATION_VENDOR_FLAG            ((psa_key_location_t)0x800000)</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span> <span class="comment"></span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span> <span class="comment">/** The minimum value for a key identifier chosen by the application.</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span> <span class="comment"> */</span></div><div class="line"><a name="l02085"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga2b062011d930839695577138858ec136"> 2085</a></span> <span class="preprocessor">#define PSA_KEY_ID_USER_MIN                     ((psa_key_id_t)0x00000001)</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span> <span class="comment">/** The maximum value for a key identifier chosen by the application.</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span> <span class="comment"> */</span></div><div class="line"><a name="l02088"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga9cb2bf7c6f7abfacccff4fd31dcfd564"> 2088</a></span> <span class="preprocessor">#define PSA_KEY_ID_USER_MAX                     ((psa_key_id_t)0x3fffffff)</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span> <span class="comment">/** The minimum value for a key identifier chosen by the implementation.</span></div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span> <span class="comment"> */</span></div><div class="line"><a name="l02091"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga1f7e6d90f523bef964d207c1d3236e0b"> 2091</a></span> <span class="preprocessor">#define PSA_KEY_ID_VENDOR_MIN                   ((psa_key_id_t)0x40000000)</span></div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span> <span class="comment">/** The maximum value for a key identifier chosen by the implementation.</span></div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span> <span class="comment"> */</span></div><div class="line"><a name="l02094"></a><span class="lineno"><a class="line" href="group__key__lifetimes.html#ga3afb6bb4644c995cf95309a71e7baeb1"> 2094</a></span> <span class="preprocessor">#define PSA_KEY_ID_VENDOR_MAX                   ((psa_key_id_t)0x7fffffff)</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span> <span class="comment"></span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span> <span class="comment"></span></div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span> <span class="comment">/** \defgroup policy Key policies</span></div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span> <span class="comment"> * @{</span></div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span> <span class="comment"> */</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span> <span class="comment"></span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span> <span class="comment">/** Whether the key may be exported.</span></div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span> <span class="comment"> *</span></div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span> <span class="comment"> * A public key or the public part of a key pair may always be exported</span></div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span> <span class="comment"> * regardless of the value of this permission flag.</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span> <span class="comment"> *</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span> <span class="comment"> * If a key does not have export permission, implementations shall not</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span> <span class="comment"> * allow the key to be exported in plain form from the cryptoprocessor,</span></div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span> <span class="comment"> * whether through psa_export_key() or through a proprietary interface.</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span> <span class="comment"> * The key may however be exportable in a wrapped form, i.e. in a form</span></div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span> <span class="comment"> * where it is encrypted by another key.</span></div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span> <span class="comment"> */</span></div><div class="line"><a name="l02113"></a><span class="lineno"><a class="line" href="group__policy.html#ga7dddccdd1303176e87a4d20c87b589ed"> 2113</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_EXPORT                    ((psa_key_usage_t)0x00000001)</span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span> <span class="comment"></span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span> <span class="comment">/** Whether the key may be copied.</span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span> <span class="comment"> *</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span> <span class="comment"> * This flag allows the use of psa_copy_key() to make a copy of the key</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span> <span class="comment"> * with the same policy or a more restrictive policy.</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span> <span class="comment"> *</span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span> <span class="comment"> * For lifetimes for which the key is located in a secure element which</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span> <span class="comment"> * enforce the non-exportability of keys, copying a key outside the secure</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span> <span class="comment"> * element also requires the usage flag #PSA_KEY_USAGE_EXPORT.</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span> <span class="comment"> * Copying the key inside the secure element is permitted with just</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span> <span class="comment"> * #PSA_KEY_USAGE_COPY if the secure element supports it.</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span> <span class="comment"> * For keys with the lifetime #PSA_KEY_LIFETIME_VOLATILE or</span></div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span> <span class="comment"> * #PSA_KEY_LIFETIME_PERSISTENT, the usage flag #PSA_KEY_USAGE_COPY</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span> <span class="comment"> * is sufficient to permit the copy.</span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span> <span class="comment"> */</span></div><div class="line"><a name="l02129"></a><span class="lineno"><a class="line" href="group__policy.html#ga4605d686020a6cb433c5d78bf7e91689"> 2129</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_COPY                      ((psa_key_usage_t)0x00000002)</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span> <span class="comment"></span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span> <span class="comment">/** Whether the key may be used to encrypt a message.</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span> <span class="comment"> *</span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span> <span class="comment"> * This flag allows the key to be used for a symmetric encryption operation,</span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span> <span class="comment"> * for an AEAD encryption-and-authentication operation,</span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span> <span class="comment"> * or for an asymmetric encryption operation,</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span> <span class="comment"> * if otherwise permitted by the key's type and policy.</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span> <span class="comment"> *</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span> <span class="comment"> * For a key pair, this concerns the public key.</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span> <span class="comment"> */</span></div><div class="line"><a name="l02140"></a><span class="lineno"><a class="line" href="group__policy.html#ga75153b296d045d529d97203a6a995dad"> 2140</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_ENCRYPT                   ((psa_key_usage_t)0x00000100)</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span> <span class="comment"></span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span> <span class="comment">/** Whether the key may be used to decrypt a message.</span></div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span> <span class="comment"> *</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span> <span class="comment"> * This flag allows the key to be used for a symmetric decryption operation,</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span> <span class="comment"> * for an AEAD decryption-and-verification operation,</span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span> <span class="comment"> * or for an asymmetric decryption operation,</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span> <span class="comment"> * if otherwise permitted by the key's type and policy.</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span> <span class="comment"> *</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span> <span class="comment"> * For a key pair, this concerns the private key.</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span> <span class="comment"> */</span></div><div class="line"><a name="l02151"></a><span class="lineno"><a class="line" href="group__policy.html#gac3f2d2e5983db1edde9f142ca9bf8e6a"> 2151</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_DECRYPT                   ((psa_key_usage_t)0x00000200)</span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span> <span class="comment"></span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span> <span class="comment">/** Whether the key may be used to sign a message.</span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span> <span class="comment"> *</span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span> <span class="comment"> * This flag allows the key to be used for a MAC calculation operation or for</span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span> <span class="comment"> * an asymmetric message signature operation, if otherwise permitted by the</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span> <span class="comment"> * key’s type and policy.</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span> <span class="comment"> *</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span> <span class="comment"> * For a key pair, this concerns the private key.</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span> <span class="comment"> */</span></div><div class="line"><a name="l02161"></a><span class="lineno"><a class="line" href="group__policy.html#ga552117ac92b79500cae87d4e65a85c54"> 2161</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_SIGN_MESSAGE              ((psa_key_usage_t)0x00000400)</span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span> <span class="comment"></span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span> <span class="comment">/** Whether the key may be used to verify a message.</span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span> <span class="comment"> *</span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span> <span class="comment"> * This flag allows the key to be used for a MAC verification operation or for</span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span> <span class="comment"> * an asymmetric message signature verification operation, if otherwise</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span> <span class="comment"> * permitted by the key’s type and policy.</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span> <span class="comment"> *</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span> <span class="comment"> * For a key pair, this concerns the public key.</span></div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span> <span class="comment"> */</span></div><div class="line"><a name="l02171"></a><span class="lineno"><a class="line" href="group__policy.html#gabea7ec4173f4f943110329ac2953b2b1"> 2171</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_VERIFY_MESSAGE            ((psa_key_usage_t)0x00000800)</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span> <span class="comment"></span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span> <span class="comment">/** Whether the key may be used to sign a message.</span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span> <span class="comment"> *</span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span> <span class="comment"> * This flag allows the key to be used for a MAC calculation operation</span></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span> <span class="comment"> * or for an asymmetric signature operation,</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span> <span class="comment"> * if otherwise permitted by the key's type and policy.</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span> <span class="comment"> *</span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span> <span class="comment"> * For a key pair, this concerns the private key.</span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span> <span class="comment"> */</span></div><div class="line"><a name="l02181"></a><span class="lineno"><a class="line" href="group__policy.html#ga181c73e00d9e95aa3a8366f26c4380b6"> 2181</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_SIGN_HASH                 ((psa_key_usage_t)0x00001000)</span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span> <span class="comment"></span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span> <span class="comment">/** Whether the key may be used to verify a message signature.</span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span> <span class="comment"> *</span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span> <span class="comment"> * This flag allows the key to be used for a MAC verification operation</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span> <span class="comment"> * or for an asymmetric signature verification operation,</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span> <span class="comment"> * if otherwise permitted by by the key's type and policy.</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span> <span class="comment"> *</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span> <span class="comment"> * For a key pair, this concerns the public key.</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span> <span class="comment"> */</span></div><div class="line"><a name="l02191"></a><span class="lineno"><a class="line" href="group__policy.html#gafadf131ef2182045e3483d03aadaa1bd"> 2191</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_VERIFY_HASH               ((psa_key_usage_t)0x00002000)</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span> <span class="comment"></span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span> <span class="comment">/** Whether the key may be used to derive other keys or produce a password</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span> <span class="comment"> * hash.</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span> <span class="comment"> *</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span> <span class="comment"> * This flag allows the key to be used for a key derivation operation or for</span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span> <span class="comment"> * a key agreement operation, if otherwise permitted by by the key's type and</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span> <span class="comment"> * policy.</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span> <span class="comment"> *</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span> <span class="comment"> * If this flag is present on all keys used in calls to</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span> <span class="comment"> * psa_key_derivation_input_key() for a key derivation operation, then it</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span> <span class="comment"> * permits calling psa_key_derivation_output_bytes() or</span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span> <span class="comment"> * psa_key_derivation_output_key() at the end of the operation.</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span> <span class="comment"> */</span></div><div class="line"><a name="l02205"></a><span class="lineno"><a class="line" href="group__policy.html#gaf19022acc5ef23cf12477f632b48a0b2"> 2205</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_DERIVE                    ((psa_key_usage_t)0x00004000)</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span> <span class="comment"></span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span> <span class="comment">/** Whether the key may be used to verify the result of a key derivation,</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span> <span class="comment"> * including password hashing.</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span> <span class="comment"> *</span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span> <span class="comment"> * This flag allows the key to be used:</span></div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span> <span class="comment"> *</span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span> <span class="comment"> * This flag allows the key to be used in a key derivation operation, if</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span> <span class="comment"> * otherwise permitted by by the key's type and policy.</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span> <span class="comment"> *</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span> <span class="comment"> * If this flag is present on all keys used in calls to</span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span> <span class="comment"> * psa_key_derivation_input_key() for a key derivation operation, then it</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span> <span class="comment"> * permits calling psa_key_derivation_verify_bytes() or</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span> <span class="comment"> * psa_key_derivation_verify_key() at the end of the operation.</span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span> <span class="comment"> */</span></div><div class="line"><a name="l02220"></a><span class="lineno"><a class="line" href="group__policy.html#ga25aece70be2b79afbdb4180f7c4e68ed"> 2220</a></span> <span class="preprocessor">#define PSA_KEY_USAGE_VERIFY_DERIVATION         ((psa_key_usage_t)0x00008000)</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span> <span class="comment"></span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span> <span class="comment"></span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span> <span class="comment">/** \defgroup derivation Key derivation</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span> <span class="comment"> * @{</span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span> <span class="comment"> */</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span> <span class="comment"></span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span> <span class="comment">/** A secret input for key derivation.</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span> <span class="comment"> *</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span> <span class="comment"> * This should be a key of type #PSA_KEY_TYPE_DERIVE</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span> <span class="comment"> * (passed to psa_key_derivation_input_key())</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span> <span class="comment"> * or the shared secret resulting from a key agreement</span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span> <span class="comment"> * (obtained via psa_key_derivation_key_agreement()).</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span> <span class="comment"> *</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span> <span class="comment"> * The secret can also be a direct input (passed to</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span> <span class="comment"> * key_derivation_input_bytes()). In this case, the derivation operation</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span> <span class="comment"> * may not be used to derive keys: the operation will only allow</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span> <span class="comment"> * psa_key_derivation_output_bytes(),</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span> <span class="comment"> * psa_key_derivation_verify_bytes(), or</span></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span> <span class="comment"> * psa_key_derivation_verify_key(), but not</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span> <span class="comment"> * psa_key_derivation_output_key().</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span> <span class="comment"> */</span></div><div class="line"><a name="l02243"></a><span class="lineno"><a class="line" href="group__derivation.html#ga0ddfbe764baba995c402b1b0ef59392e"> 2243</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_SECRET     ((psa_key_derivation_step_t)0x0101)</span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span> <span class="comment"></span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span> <span class="comment">/** A low-entropy secret input for password hashing / key stretching.</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span> <span class="comment"> *</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span> <span class="comment"> * This is usually a key of type #PSA_KEY_TYPE_PASSWORD (passed to</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span> <span class="comment"> * psa_key_derivation_input_key()) or a direct input (passed to</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span> <span class="comment"> * psa_key_derivation_input_bytes()) that is a password or passphrase. It can</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span> <span class="comment"> * also be high-entropy secret such as a key of type #PSA_KEY_TYPE_DERIVE or</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span> <span class="comment"> * the shared secret resulting from a key agreement.</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span> <span class="comment"> *</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span> <span class="comment"> * The secret can also be a direct input (passed to</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span> <span class="comment"> * key_derivation_input_bytes()). In this case, the derivation operation</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span> <span class="comment"> * may not be used to derive keys: the operation will only allow</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span> <span class="comment"> * psa_key_derivation_output_bytes(),</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span> <span class="comment"> * psa_key_derivation_verify_bytes(), or</span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span> <span class="comment"> * psa_key_derivation_verify_key(), but not</span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span> <span class="comment"> * psa_key_derivation_output_key().</span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span> <span class="comment"> */</span></div><div class="line"><a name="l02261"></a><span class="lineno"><a class="line" href="group__derivation.html#gae19de2d7c74759878b4a6677b0acdda7"> 2261</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_PASSWORD   ((psa_key_derivation_step_t)0x0102)</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span> <span class="comment"></span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span> <span class="comment">/** A label for key derivation.</span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span> <span class="comment"> *</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span> <span class="comment"> * This should be a direct input.</span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span> <span class="comment"> * It can also be a key of type #PSA_KEY_TYPE_RAW_DATA.</span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span> <span class="comment"> */</span></div><div class="line"><a name="l02268"></a><span class="lineno"><a class="line" href="group__derivation.html#ga6489d91aa4a2eb50d28c1209bffe9541"> 2268</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_LABEL      ((psa_key_derivation_step_t)0x0201)</span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span> <span class="comment"></span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span> <span class="comment">/** A salt for key derivation.</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span> <span class="comment"> *</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span> <span class="comment"> * This should be a direct input.</span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span> <span class="comment"> * It can also be a key of type #PSA_KEY_TYPE_RAW_DATA or</span></div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span> <span class="comment"> * #PSA_KEY_TYPE_PEPPER.</span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span> <span class="comment"> */</span></div><div class="line"><a name="l02276"></a><span class="lineno"><a class="line" href="group__derivation.html#gab62757fb125243562c3947a752470d4a"> 2276</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_SALT       ((psa_key_derivation_step_t)0x0202)</span></div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span> <span class="comment"></span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span> <span class="comment">/** An information string for key derivation.</span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span> <span class="comment"> *</span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span> <span class="comment"> * This should be a direct input.</span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span> <span class="comment"> * It can also be a key of type #PSA_KEY_TYPE_RAW_DATA.</span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span> <span class="comment"> */</span></div><div class="line"><a name="l02283"></a><span class="lineno"><a class="line" href="group__derivation.html#gacef8df989e09c769233f4b779acb5b7d"> 2283</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_INFO       ((psa_key_derivation_step_t)0x0203)</span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span> <span class="comment"></span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span> <span class="comment">/** A seed for key derivation.</span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span> <span class="comment"> *</span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span> <span class="comment"> * This should be a direct input.</span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span> <span class="comment"> * It can also be a key of type #PSA_KEY_TYPE_RAW_DATA.</span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span> <span class="comment"> */</span></div><div class="line"><a name="l02290"></a><span class="lineno"><a class="line" href="group__derivation.html#gaccc41e8b4bd4e34bcb46ad1577709535"> 2290</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_SEED       ((psa_key_derivation_step_t)0x0204)</span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span> <span class="comment"></span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span> <span class="comment">/** A cost parameter for password hashing / key stretching.</span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span> <span class="comment"> *</span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span> <span class="comment"> * This must be a direct input, passed to psa_key_derivation_input_integer().</span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span> <span class="comment"> */</span></div><div class="line"><a name="l02296"></a><span class="lineno"><a class="line" href="group__derivation.html#ga4cc0f85fedc37168ac55117ffdba6cd1"> 2296</a></span> <span class="preprocessor">#define PSA_KEY_DERIVATION_INPUT_COST       ((psa_key_derivation_step_t)0x0205)</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span> <span class="comment"></span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span> <span class="comment"></span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span> <span class="comment">/** \defgroup helper_macros Helper macros</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span> <span class="comment"> * @{</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span> <span class="comment"> */</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span> </div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span> <span class="comment">/* Helper macros */</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span> <span class="comment"></span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span> <span class="comment">/** Check if two AEAD algorithm identifiers refer to the same AEAD algorithm</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span> <span class="comment"> *  regardless of the tag length they encode.</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span> <span class="comment"> *</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span> <span class="comment"> * \param aead_alg_1 An AEAD algorithm identifier.</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span> <span class="comment"> * \param aead_alg_2 An AEAD algorithm identifier.</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span> <span class="comment"> *</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span> <span class="comment"> * \return           1 if both identifiers refer to the same AEAD algorithm,</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span> <span class="comment"> *                   0 otherwise.</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span> <span class="comment"> *                   Unspecified if neither \p aead_alg_1 nor \p aead_alg_2 are</span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span> <span class="comment"> *                   a supported AEAD algorithm.</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span> <span class="comment"> */</span></div><div class="line"><a name="l02317"></a><span class="lineno"><a class="line" href="group__helper__macros.html#gadd88e30fe90f6497958acd3f73a950b5"> 2317</a></span> <span class="preprocessor">#define MBEDTLS_PSA_ALG_AEAD_EQUAL(aead_alg_1, aead_alg_2) \</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span> <span class="preprocessor">    (!(((aead_alg_1) ^ (aead_alg_2)) &amp; \</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span> <span class="preprocessor">       ~(PSA_ALG_AEAD_TAG_LENGTH_MASK | PSA_ALG_AEAD_AT_LEAST_THIS_LENGTH_FLAG)))</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span> <span class="comment"></span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span> </div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span> <span class="preprocessor">#endif </span><span class="comment">/* PSA_CRYPTO_VALUES_H */</span><span class="preprocessor"></span></div></div><!-- fragment --></div><!-- contents -->
        
    


        
<footer class="global-footer">
    <ul class="global-footer-media global-footer-row">
        <li>
            <a class="footer-media-icon" title="Twitter" href="https://twitter.com/ArmSoftwareDev">
                <span class="fab fa-twitter-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Twitter</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="YouTube" href="https://www.youtube.com/c/ArmSoftwareDevelopers">
                <span class="fab fa-youtube-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">YouTube</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Forum" href="http://forums.mbed.com/">
                <span class="fas fa-comments fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Forum</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Blog" href="http://blog.mbed.com/">
                <span class="fas fa-pen-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Blog</span>
            </a>
        </li>
    </ul>

    <div class="global-footer-copyright global-footer-row">
        <div class="copyright-statement">Copyright © <script>document.write(new Date().getFullYear());</script> Arm Limited (or its affiliates).</div>
        <ul class="copyright-links">
            <li><a href="https://os.mbed.com/">Home</a></li>
            <li><a href="https://www.arm.com/company/policies/terms-and-conditions">Website Terms</a></li>
            <li><a href="https://www.arm.com/company/policies/privacy">Privacy</a></li>
            <li><a href="https://www.arm.com/company/policies/cookies">Cookies</a></li>
            <li><a href="http://www.arm.com/company/policies/trademarks">Trademarks</a></li>
        </ul>
    </div>
</footer>



    <div id="cookiemodule">
    <h5>Important Information for this Arm website</h5>
    <div id="cookiecontent">
        <p>
            This site uses cookies to store information on your computer.
            By continuing to use our site, you consent to our cookies.
            If you are not happy with the use of these cookies, please review our
            <a href="https://www.arm.com/company/policies/cookies">Cookie Policy</a>
            to learn how they can be disabled.
            By disabling cookies, some features of the site will not work.
        </p>
        <button id="acceptcookie">Accept and hide this message</button>
    </div>
</div>
<script src="../../../../static/js/cookie_law.js"></script>




    </body>

<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto__values_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:22:35 GMT -->
</html>
