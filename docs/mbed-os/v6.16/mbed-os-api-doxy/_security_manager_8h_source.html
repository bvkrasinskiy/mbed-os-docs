<!DOCTYPE html>
<html>
    
<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_security_manager_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:28:06 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        
        <meta charset="utf-8"/>
        <title>Mbed OS Reference | SecurityManager.h Source File</title>
        <link href="../static/css/vendor/foundation-6.2.4.min.mbed-cache-4c48f6c816971070eb1e4eca75f0ec30.css" rel="stylesheet"/>
        <link href="search/search.css" rel="stylesheet"/>
        <link href="../static/css/app.mbed-cache-a44289fe9f5ca07036a335d6ad7ed8ad.css" rel="stylesheet"/>
        <script src="../static/js/vendor/jquery-3.2.1.min.mbed-cache-c9f5aeeca3ad37bf2aa006139b935f0a.js"></script>
        <script src="dynsections.js"></script>
        <script src="search/searchdata.js"></script>
        <script src="search/search.js"></script>
        <script>
            $(document).ready(function() {
                init_search();
            });
        </script>
    
        

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1447836-8');
ga('require', 'GTM-WXMLD4S')
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl+'&gtm_auth=SMYNPwM0ICsV00c1ZHETqQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M6FZ495');</script>


    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:971746,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>



<!-- Favicons -->
<link rel="apple-touch-icon" sizes="57x57" href="../../../../static/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../../static/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../../static/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../../static/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../../static/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../../static/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../../../static/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../../../static/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../../../static/img/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../../../static/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../static/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../../../static/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../static/img/favicons/favicon-16x16.png">
<link rel="manifest" href="https://os.mbed.com/static/img/favicons/manifest.json">
<link rel="shortcut icon" href="https://os.mbed.com/static/img/favicon.ico?">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">

<link rel="stylesheet" href="../../../../static/CACHE/css/output.811e2930ab34.css" type="text/css">

<link href="../../../../static/docs/css/doc_viewer.css" rel="stylesheet">
<link href="../../../../static/fonts.css" rel="stylesheet">
<link href="../../../../static/docs-nav-and-footer1b26.css?v2" rel="stylesheet">


<link rel="canonical" href="_security_manager_8h_source.html">
<script src="../../../../static/mbed-nav-vertical-menu.js"></script>


    </head>
    <body>
        








<div class="mbed-nav">
    <div class="mbed-nav__mobile-menu-control">
        <i class="mbed-nav__mobile-menu-control-open fas fa-bars fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-close fas fa-times is-hidden fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-back fas fa-angle-left is-hidden fa-fw"></i>
    </div>
    <div class="mbed-nav__logo">
        <a href="https://os.mbed.com/">
            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#logo"></use></svg>
        </a>
    </div>
    <div class="mbed-nav__menu">

        <!-- Main menu -->
        <nav class="mbed-nav__main-menu">
            <ul class="mbed-nav__dropdown-menu">
                <li class="has-dropdown">
                    Overview

                    <div class="mbed-nav__dropdown-menu-content">

                        <!-- Overview dropdown menu -->
                        <div class="mbed-nav__overview-menu">
                            <section>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <div>
                                                <p>Mbed OS</p>
                                                <p>The open source OS for Cortex-M devices</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link-detail">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <div>
                                                <p>Keil Studio Cloud</p>
                                                <p>Arm's IDE for IoT, embedded and Mbed development</p>
                                            </div>
                                         </a>
                                     </li>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <div>
                                                <p>Mbed Studio</p>
                                                <p>Download the desktop IDE for Mbed OS</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link-detail">

                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <div>
                                               <p>Mbed CLI</p>
                                               <p>Command line access to Mbed tools and services</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Security and Connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <div>
                                                <p>Mbed TLS and Mbed Crypto</p>
                                                <p>Industry standard TLS stack and crypto library</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <div>
                                                <p>Connectivity</p>
                                                <p>BLE, WiFi, Cellular, LoRaWAN and more</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </li>
                <li class="has-dropdown">
                    Hardware

                    <!-- Hardware dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__hardware-dropdown">
                            <ul class="mbed-nav__hardware-menu">
                                <li>
                                    <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                        <div>
                                            <p>Boards</p>
                                            <p>Build your Mbed projects with development boards for Arm Cortex processors and MCUs</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                        <div>
                                            <p>Modules</p>
                                            <p>Modules include a MCU, connectivity and onboard memory, making them ideal for designing IoT products for mass production</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                        <div>
                                            <p>Components</p>
                                            <p>The component database hosts libraries for different sensors, actuators, radios, inputs, middleware and IoT services</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                        <div>
                                            <p>Hardware overview & Mbed Enabled</p>
                                            <p>Learn about hardware support for Mbed, as well as the Mbed Enabled program, which identifies Mbed compatible products</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                        <div>
                                            <p>Mbed HDK</p>
                                            <p>Reference designs, schematics and board layouts to develop production hardware and Mbed-compatible development boards</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li class="has-dropdown">
                    Documentation

                    <!-- Documentation dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__documentation-dropdown">
                            <ul class="mbed-nav__documentation-menu">
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a>
                                </li>
                                <li>
                                    <a
                                        href="https://developer.arm.com/documentation/102497/latest/Arm-Keil-Studio-Cloud">
                                        Keil Studio
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li class="has-dropdown">
                    Community

                    <!-- Community dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__community-dropdown">
                            <ul class="mbed-nav__community-menu">
                                <li>
                                    <a href="https://forums.mbed.com/">Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a>
                                </li>
                                <li>
                                    <a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/support/">Report a problem</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://os.mbed.com/blog/">Blog</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="mbed-nav__user-controls">
        <div class="mbed-nav__user-controls-top">
            <div class="mbed-nav__search">
                <form id="mbed-nav__search-box" class="is-hidden" action="https://os.mbed.com/search" method="GET">
                    <div class="mbed-nav__search-box">
                        <input type="search" name="q" placeholder="Search...">
                        <button type="submit">
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                        </button>
                    </div>
                </form>
                <i class="mbed-nav__search-close fas fa-times is-hidden"></i>
                <svg class="mbed-nav__search-open stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
            </div>
            <a class="mbed-nav__cta" href="https://studio.keil.arm.com/mbed" target="_blank">
                Keil Studio Cloud
            </a>

            
                
                <nav class="mbed-nav__logged-out-nav">
                    <ul class="mbed-nav__dropdown-menu">
                        <li>
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#profile"></use></svg>

                            <!-- Logged out dropdown menu -->
                            <div class="mbed-nav__dropdown-menu-content">
                                <div class="mbed-nav__logged-out-dropdown">
                                    <ul class="mbed-nav__logged-out-menu">
                                        <li><a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_security_manager_8h_source.html">Log in or Sign up</a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </nav>
                
            
        </div>
    </div>
    <div class="mbed-nav__spacer"></div>
</div>
<div class="mbed-nav__mobile-menu-cover is-hidden">
    <div class="mbed-nav__mobile-menu">

        <div id="mbed-nav__main-menu-mobile">
            <div class="mbed-nav__user-controls-mobile">
                <div class="mbed-nav__user-controls-top-mobile">
                    <form action="https://os.mbed.com/search" method="GET">
                        <div class="mbed-nav__search-box mbed-nav__search-box--light">
                            <input type="search" name="q" placeholder="Search...">
                            <button type="submit">
                                <svg class="stroke-dark-grey"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                            </button>
                        </div>
                    </form>
                    
                        
                        <a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_security_manager_8h_source.html">Log in or Sign up</a>
                        
                    
                </div>
            </div>

            <ul class="mbed-nav__side-menu">
                <li>
                    <input type="checkbox" name="accordion-toggle" id="overview-accordion">
                    <label for="overview-accordion">Overview</label>
                    <div class="accordion_content">
                        <ul class="overview-menu-mobile">
                            <li>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <p>Mbed OS</p>
                                        </a>
                                    </li>
                                    

                                </ul>
                            </li>
                            <li>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <p>Mbed Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <p>Keil Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <p>Mbed CLI</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Security and connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <p>Mbed TLS and Mbed Crypto</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <p>Connectivity</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="hardware-accordion">
                    <label for="hardware-accordion">Hardware</label>
                    <div class="accordion_content">
                        <ul>
                            <li>
                                <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                    <p>Boards</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                    <p>Modules</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                    <p>Components</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                    <p>Hardware overview & Mbed Enabled</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                    <p>Mbed HDK</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="documentation-accordion">
                    <label for="documentation-accordion">Documentation</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a></li>
                            <li>
                              <a
                                href="https://developer.arm.com/documentation/102497/1-5/Arm-Keil-Studio/?utm_source=mbed_com&amp;utm_medium=nav_docs_link&amp;utm_campaign=mbed_com_promo">
                                Keil Studio
                              </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="community-accordion">
                    <label for="community-accordion">Community</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://forums.mbed.com/">Forum</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a></li>
                            <li><a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a></li>
                            <li><a href="https://os.mbed.com/support/">Report a problem</a></li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/blog/">Blog</a></li>
            </ul>
        </div>

        
    </div>
</div>



<div class="version-picker-container">
    
    <select class="version-picker" onchange="goToVersion(this.value)">
        
            <option
                value="v6.16"
                selected
            >
                v6.16
            </option>
        
            <option
                value="v6.15"
                
            >
                v6.15
            </option>
        
            <option
                value="v6.14"
                
            >
                v6.14
            </option>
        
            <option
                value="v6.13"
                
            >
                v6.13
            </option>
        
            <option
                value="v6.12"
                
            >
                v6.12
            </option>
        
            <option
                value="v6.11"
                
            >
                v6.11
            </option>
        
            <option
                value="v6.10"
                
            >
                v6.10
            </option>
        
            <option
                value="v6.9"
                
            >
                v6.9
            </option>
        
            <option
                value="v6.8"
                
            >
                v6.8
            </option>
        
            <option
                value="v6.7"
                
            >
                v6.7
            </option>
        
            <option
                value="v6.6"
                
            >
                v6.6
            </option>
        
            <option
                value="v6.5"
                
            >
                v6.5
            </option>
        
            <option
                value="v5.15"
                
            >
                v5.15
            </option>
        
    </select>
    

    <div class="contact-us">
        Mistake on this page?
        
            <br>
            <a href="https://github.com/ARMmbed/mbed-os-5-docs/issues">
                Report an issue in GitHub
                <i class="fab fa-github"></i>
            </a>
            or
            <a href="mailto:mbed-support@arm.com">
                email us
                <i class="fas fa-envelope"></i>
            </a>
        
    </div>
</div>

<script>
    function goToVersion(version) {
        window.location.href = window.location.href.replace(
            "v6.16",
            version
        )
    }
</script>

        
        <div class="topbar" id="top">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div class="tabs" id="navrow1">
    <ul class="tablist">
      <li><a href="index.html"><span>Main Page</span></a></li>
      <li><a href="pages.html"><span>Related Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div class="MSearchBoxInactive" id="MSearchBox">
        <span class="left">
          <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png"/>
          <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
          </span><span class="right">
            <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png"/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2" id="navrow2">
    <ul class="tablist">
      <li><a href="files.html"><span>File List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="navpath" id="nav-path">
  <ul>
<li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_456207283565120b441ff9733579e7b8.html">connectivity</a></li><li class="navelem"><a class="el" href="dir_a9b0a4f8a11c2540ce1e65185f830e6a.html">FEATURE_BLE</a></li><li class="navelem"><a class="el" href="dir_ccd5a0052afa8b7d8e85ab9f2949e840.html">include</a></li><li class="navelem"><a class="el" href="dir_eebce072506fd4eea19002897354326a.html">ble</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SecurityManager.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> <span class="comment">/* mbed Microcontroller Library</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> <span class="comment"> * Copyright (c) 2006-2020 ARM Limited</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span> <span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span> <span class="comment"> * SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span> <span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span> <span class="comment"> * Licensed under the Apache License, Version 2.0 (the "License");</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span> <span class="comment"> * you may not use this file except in compliance with the License.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span> <span class="comment"> * You may obtain a copy of the License at</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span> <span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span> <span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span> <span class="comment"> *</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span> <span class="comment"> * Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span> <span class="comment"> * distributed under the License is distributed on an "AS IS" BASIS,</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span> <span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span> <span class="comment"> * See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span> <span class="comment"> * limitations under the License.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span> <span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span> </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span> <span class="preprocessor">#ifndef BLE_SECURITY_MANAGER_H_</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span> <span class="preprocessor">#define BLE_SECURITY_MANAGER_H_</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span> </div><div class="line"><a name="l00022"></a><span class="lineno">   22</span> <span class="preprocessor">#include &lt;cstdint&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span> </div><div class="line"><a name="l00024"></a><span class="lineno">   24</span> <span class="preprocessor">#include "ble/common/BLETypes.h"</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span> <span class="preprocessor">#include "ble/common/blecommon.h"</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span> <span class="preprocessor">#include "ble/common/CallChainOfFunctionPointersWithContext.h"</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span> </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span> <span class="keyword">namespace </span><a class="code" href="namespaceble.html">ble</a> {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span> </div><div class="line"><a name="l00030"></a><span class="lineno">   30</span> <span class="preprocessor">#if !defined(DOXYGEN_ONLY)</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span> <span class="keyword">namespace </span>impl {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span> <span class="keyword">class </span><a class="code" href="classble_1_1_security_manager.html">SecurityManager</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span> }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span> <span class="preprocessor">#endif // !defined(DOXYGEN_ONLY)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span> <span class="comment"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span> <span class="comment">/**</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span> <span class="comment"> * Overview</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span> <span class="comment"> *</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span> <span class="comment"> * Security Manager is used to provide link security through encryption, signing and authentication</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span> <span class="comment"> * which are made possible by pairing and optionally bonding. Pairing is the process of establishing</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span> <span class="comment"> * and/or exchanging keys used for the current connection. Bonding means saving this information so that</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span> <span class="comment"> * it can later be used after reconnecting without having to pair again. This saves time and power.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span> <span class="comment"> *</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span> <span class="comment"> * @par Paring</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span> <span class="comment"> *</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span> <span class="comment"> * There are several ways to provide different levels of security during pairing depending on your requirements</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span> <span class="comment"> * and the facilities provided by the application. The process starts with initialising the SecurityManager</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span> <span class="comment"> * with default options for new connections. Some settings can later be changed per link or globally.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span> <span class="comment"> *</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span> <span class="comment"> * The important settings in the init() function are the MITM requirement and IO capabilities. Man in the</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span> <span class="comment"> * Middle (MITM) protection prevents an attack where one device can impersonate another device by</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span> <span class="comment"> * pairing with both devices at the same time. This protection is achieved by sharing some information</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span> <span class="comment"> * between the devices through some independent channel. The IO capabilities of both devices dictate</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span> <span class="comment"> * what algorithm is used. For details @see BLUETOOTH SPECIFICATION Version 5.0 | Vol 3, Part H - 2.3.5.1.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span> <span class="comment"> * You can change the IO capabilities after initialisation with setIoCapability(). This will take effect</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span> <span class="comment"> * for all subsequent pairings.</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span> <span class="comment"> *</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span> <span class="comment"> * @par Out of Band data used in pairing</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span> <span class="comment"> *</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span> <span class="comment"> * Sharing this information through IO capabilities means user interaction which limits the degree of</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span> <span class="comment"> * protection due to the limit of the amount of data that we can expect the user to transfer. Another</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span> <span class="comment"> * solution is using OOB (out of band) communication to transfer this data instead which can send much</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span> <span class="comment"> * more data making MITM attack even less likely to succeed. OOB data has to be exchanged by the application</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span> <span class="comment"> * and provided to the Security Manager. Use setOOBDataUsage() to indicate you want to use it. The same call also</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span> <span class="comment"> * allows you to set whether or not the communication channel you are using to transmit the OOB data is</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span> <span class="comment"> * itself secure against MITM protection - this will set the level of the link security achieved using pairing</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span> <span class="comment"> * that uses this data.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span> <span class="comment"> *</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span> <span class="comment"> * The most secure pairing is provided by Secure Connections which relies on Elliptical Curve Cryptography.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span> <span class="comment"> * Support for Secure Connections is dependent on both the stack and controller on both sides supporting</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span> <span class="comment"> * it. If either side doesn't support it Legacy Pairing will be used. This is an older standard of pairing.</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span> <span class="comment"> * If higher security is required legacy pairing can be disabled by calling allowLegacyPairing(false);</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span> <span class="comment"> *</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span> <span class="comment"> * @par Signing</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span> <span class="comment"> *</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span> <span class="comment"> * Applications may require a level of security providing confidence that data transfers are coming</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span> <span class="comment"> * from a trusted source. This can be achieved by encrypting the link which also provides added confidentiality.</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span> <span class="comment"> * Encryption is a good choice when a device stays connected but introduces latency due to the need of encrypting the</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span> <span class="comment"> * link if the device only connects periodically to transfer data. If confidentiality is not required data GATT</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span> <span class="comment"> * server may allow writes to happen over an unencrypted link but authenticated by a signature present in each packet.</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span> <span class="comment"> * This signature relies on having sent a signing key to the peer during pairing prior to sending any signed packets.</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span> <span class="comment"> *</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span> <span class="comment"> * @par Persistence of Security information</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span> <span class="comment"> *</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span> <span class="comment"> * Security Manager stores all the data required for its operation on active links. Depending on resources</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span> <span class="comment"> * available on the device it will also attempt to store data for disconnected devices which have bonded to be</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span> <span class="comment"> * reused when reconnected.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span> <span class="comment"> *</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span> <span class="comment"> * If the application has initialised a filesystem and the Security Manager has been provided with a</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span> <span class="comment"> * filepath during the init() call it may also provide data persistence across resets. This must be enabled by</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span> <span class="comment"> * calling preserveBondingStateOnReset(). Persistence is not guaranteed and may fail if abnormally terminated.</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span> <span class="comment"> * The Security Manager may also fall back to a non-persistent implementation if the resources are too limited.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span> <span class="comment"> *</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span> <span class="comment"> * @par How to use</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span> <span class="comment"> *</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span> <span class="comment"> * First thing you need to do is to initialise the manager by calling init() with your chosen settings.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span> <span class="comment"> *</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span> <span class="comment"> * The SecurityManager communicates with your application through events. These will trigger calls in</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span> <span class="comment"> * the EventHandler which you must provide by calling the setSecurityManagerEventHandler() function.</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span> <span class="comment"> *</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span> <span class="comment"> * The most important process is pairing. This may be triggered manually by calling requestPairing() or</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span> <span class="comment"> * may be called as a result of the application requiring encryption by calling setLinkEncryption() or</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span> <span class="comment"> * as a result of the application requiring MITM protection through requestAuthentication().</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span> <span class="comment"> *</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span> <span class="comment"> * All these can be implicitly called by using setLinkSecurity() to conveniently set the required</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span> <span class="comment"> * security for the link. The SecurityManager will trigger all the process required to achieve the set</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span> <span class="comment"> * security level. Security level can only be escalated. Asking the Security Manager for a lower</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span> <span class="comment"> * security level than the existing one will not fail but will result in a event informing the</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span> <span class="comment"> * application through linkEncryptionResult() of the current level (which remains unchanged).</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span> <span class="comment"> *</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span> <span class="comment"> * Depending on the IO capabilities and OOB usage settings different pairing algorithms will be chosen.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span> <span class="comment"> * They will produce appropriate events which must be handled by your EventHandler. If your event handler</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span> <span class="comment"> * doesn't support all the calls you must not set IO capabilities or set OOB usage in such a way that would</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span> <span class="comment"> * trigger them or else the pairing will fail (usually by timing out).</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span> <span class="comment"> *</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span> <span class="comment"> * The simplest example is a pairing of a device with no IO capabilities and no OOB data available.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span> <span class="comment"> * With such limited pairing capabilities the "just works" method will be employed. This does not provide</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span> <span class="comment"> * any MITM protection. The pairing (triggered implicitly or called explicitly) will result in an event</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span> <span class="comment"> * being generated on the peer calling pairingRequest(). The event handler must make a decision (either in</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span> <span class="comment"> * the application itself or based on user interaction) whether to accept the pairing and call</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span> <span class="comment"> * accetPairing() or cancelPairing(). The result will be communicated on both peers through an event calling</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span> <span class="comment"> * pairingResult() in the EventHandler.</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span> <span class="comment"> *</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span> <span class="comment"> * @par Sequence diagrams</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span> <span class="comment"> *</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span> <span class="comment"> * Sequence diagram "Just Works" pairing</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span> <span class="comment"> *</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span> <span class="comment"> * \verbatim</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span> <span class="comment"> *  /-------- Device 1 ---------\  *----- BLE link -----*  /----------- Device 2-----------\</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span> <span class="comment"> *</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span> <span class="comment"> * App  EventHandler      SecurityManager            SecurityManager    EventHandler      App</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span> <span class="comment"> *  |        |                  |                          |                 |             |</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span> <span class="comment"> *  |-------------------&gt; requestPairing()                 |                 |             |</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span> <span class="comment"> *  |        |                  |-----[pairing start]-----&gt;|                 |             |</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span> <span class="comment"> *  |        |                  |                          |---------&gt; pairingRequest() --&gt;|</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span> <span class="comment"> *  |        |                  |                   acceptPairing() &lt;--------------------- |</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span> <span class="comment"> *  |        |                  |&lt;--[pairing complete]----&gt;|                 |             |</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span> <span class="comment"> *  |&lt;- pairingResult() &lt;-------|                          |---------&gt; pairingResult() ---&gt;|</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span> <span class="comment"> *  |        |                  |                          |                 |             |</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span> <span class="comment"> * @endverbatim</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span> <span class="comment"> *</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span> <span class="comment"> *  @note the requestPairing() call isn't required to trigger pairing. Pairing will also be triggered</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span> <span class="comment"> *  if you request encryption and authentication and no bonding information is available. The sequence will</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span> <span class="comment"> *  be the same save for the lack of explicit requestPairing() call.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span> <span class="comment"> *</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span> <span class="comment"> *</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span> <span class="comment"> *  Sequence diagram Encryption request when bonding information is available</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span> <span class="comment"> *</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span> <span class="comment"> * \verbatim</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span> <span class="comment"> *  /--------- Device 1 ---------\  *------ BLE link ------*  /--------- Device 2 ---------\</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span> <span class="comment"> *</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span> <span class="comment"> * App  EventHandler       SecurityManager              SecurityManager   EventHandler    App</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span> <span class="comment"> *  |       |                    |                            |                |           |</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span> <span class="comment"> *  |--------------------&gt; setLinkEncryption()                |                |           |</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span> <span class="comment"> *  |       |                    |&lt;-[encryption established]-&gt;|                |           |</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span> <span class="comment"> *  |&lt;- linkEncryptionResult() &lt;-|                            |-&gt; linkEncryptionResult() -&gt;|</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span> <span class="comment"> *  |       |                    |                            |                |           |</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span> <span class="comment"> * @endverbatim</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span> <span class="comment"> *</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span> <span class="comment"> * @note if bonding information is not available, pairing will be triggered</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span> <span class="comment"> *</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span> <span class="comment"> *</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span> <span class="comment"> * Sequence diagram for Secure Connections passkey entry pairing with one device having a display only</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span> <span class="comment"> * and other a keyboard</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span> <span class="comment"> *</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span> <span class="comment"> * \verbatim</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span> <span class="comment"> *  /---- Device 1 (keyboard) ---\  *------ BLE link ------*  /----- Device 2 (display) ---\</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span> <span class="comment"> *</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span> <span class="comment"> * App  EventHandler       SecurityManager              SecurityManager  EventHandler     App</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span> <span class="comment"> *  |       |                    |                            |               |            |</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span> <span class="comment"> *  |--------------------&gt; requestPairing()                   |               |            |</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span> <span class="comment"> *  |        |                   |------[pairing start]------&gt;|               |            |</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span> <span class="comment"> *  |        |                   |                            |-------&gt; pairingRequest() -&gt;|</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span> <span class="comment"> *  |        |                   |                        acceptPairing() &lt;--------------- |</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span> <span class="comment"> *  |        |                   |&lt;---[secure con. pairing]--&gt;|               |            |</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span> <span class="comment"> *  |&lt;- passkeyRequest() &lt;-------|                            |-------&gt; passkeyDisplay() -&gt;|</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span> <span class="comment"> *  |        |                   |                            |               |            |</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span> <span class="comment"> *</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span> <span class="comment"> *                  user reads the passkey on Device 2 and inputs it on Device 1</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span> <span class="comment"> *</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span> <span class="comment"> *  |        |                   |                            |               |            |</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span> <span class="comment"> *  |-------------------&gt;passkeyEntered()                     |               |            |</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span> <span class="comment"> *  |        |                   |&lt;---[pairing complete]-----&gt;|               |            |</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span> <span class="comment"> *  |&lt;- pairingResult() &lt;--------|                            |-------&gt; pairingResult() --&gt;|</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span> <span class="comment"> *  |        |                   |                            |               |            |</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span> <span class="comment"> * @endverbatim</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span> <span class="comment"> *</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span> <span class="comment"> */</span></div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html">  189</a></span> <span class="keyword">class </span><a class="code" href="classble_1_1_security_manager.html">SecurityManager</a></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span> {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span> <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span> <span class="comment">    /** level of security required from the link by the application */</span></div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179">  193</a></span>     <span class="keyword">enum</span> <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179">SecurityMode_t</a> {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>         SECURITY_MODE_NO_ACCESS,</div><div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a7f0c035d71f2d8581de2b2e4f489cd6c">  195</a></span>         <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a7f0c035d71f2d8581de2b2e4f489cd6c">SECURITY_MODE_ENCRYPTION_OPEN_LINK</a>, <span class="comment">/**&lt; Require no protection, open link. */</span></div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179ae1e001d842b41617ad21bc0a43cc061b">  196</a></span>         <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179ae1e001d842b41617ad21bc0a43cc061b">SECURITY_MODE_ENCRYPTION_NO_MITM</a>,   <span class="comment">/**&lt; Require encryption, but no MITM protection. */</span></div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179ad2fa88a39cea0e1082ece66ad26a32c1">  197</a></span>         <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179ad2fa88a39cea0e1082ece66ad26a32c1">SECURITY_MODE_ENCRYPTION_WITH_MITM</a>, <span class="comment">/**&lt; Require encryption and MITM protection. */</span></div><div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a2462fe750331b4a1c9a1d617c1642328">  198</a></span>         <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a2462fe750331b4a1c9a1d617c1642328">SECURITY_MODE_SIGNED_NO_MITM</a>,       <span class="comment">/**&lt; Require signing or encryption, but no MITM protection. */</span></div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a9a201e6c6592a963f9c5c597ecb5cfe8">  199</a></span>         <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a9a201e6c6592a963f9c5c597ecb5cfe8">SECURITY_MODE_SIGNED_WITH_MITM</a>,     <span class="comment">/**&lt; Require signing or encryption, and MITM protection. */</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>     };</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span> <span class="comment"></span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span> <span class="comment">    /** Input/output capability of the device and application */</span></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65">  203</a></span>     <span class="keyword">enum</span> <a class="code" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65">SecurityIOCapabilities_t</a> {</div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65aafd82266369f626dc1702b54590176ff">  204</a></span>         IO_CAPS_DISPLAY_ONLY = 0x00,     <span class="comment">/**&lt; Display only. */</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65ac99a90f0752058d15a7c4b146436ab79">  205</a></span>         IO_CAPS_DISPLAY_YESNO = 0x01,    <span class="comment">/**&lt; Display and yes/no entry. */</span></div><div class="line"><a name="l00206"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65a043ef14c3af5de229571af4b6975b137">  206</a></span>         IO_CAPS_KEYBOARD_ONLY = 0x02,    <span class="comment">/**&lt; Keyboard only. */</span></div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65a4a0686a09a13b402277d11b7d33c13a1">  207</a></span>         IO_CAPS_NONE = 0x03,             <span class="comment">/**&lt; No I/O capabilities. */</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65a368fab824cc65e3750b9b29ee8de7aee">  208</a></span>         IO_CAPS_KEYBOARD_DISPLAY = 0x04, <span class="comment">/**&lt; Keyboard and display. */</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>     };</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span> <span class="comment"></span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span> <span class="comment">    /** Result of security requests */</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8c">  212</a></span>     <span class="keyword">enum</span> <a class="code" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8c">SecurityCompletionStatus_t</a> {</div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca7ea003f08a9e540073ec9f82e68e4bf7">  213</a></span>         SEC_STATUS_SUCCESS              = 0x00,  <span class="comment">/**&lt; Procedure completed with success. */</span></div><div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca9b49377452239c2afb686c161586645f">  214</a></span>         SEC_STATUS_TIMEOUT              = 0x01,  <span class="comment">/**&lt; Procedure timed out. */</span></div><div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca35389ceec850cc88c3df99769c48f8f8">  215</a></span>         SEC_STATUS_PDU_INVALID          = 0x02,  <span class="comment">/**&lt; Invalid PDU received. */</span></div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8cac005962fe43dd052b687457d066b4b10">  216</a></span>         SEC_STATUS_PASSKEY_ENTRY_FAILED = 0x81,  <span class="comment">/**&lt; Passkey entry failed (user cancelled or other). */</span></div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca522bde408726a9febfddff048dcb2b6c">  217</a></span>         SEC_STATUS_OOB_NOT_AVAILABLE    = 0x82,  <span class="comment">/**&lt; Out of Band Key not available. */</span></div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca388dcaa70f8eeb58aa6c703047689741">  218</a></span>         SEC_STATUS_AUTH_REQ             = 0x83,  <span class="comment">/**&lt; Authentication requirements not met. */</span></div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8cad70544d3354dc2a16516d15a31b4941c">  219</a></span>         SEC_STATUS_CONFIRM_VALUE        = 0x84,  <span class="comment">/**&lt; Confirm value failed. */</span></div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8cac4d3e0e9911d83530995bed6be2615dc">  220</a></span>         SEC_STATUS_PAIRING_NOT_SUPP     = 0x85,  <span class="comment">/**&lt; Pairing not supported.  */</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca67213a5c6e0e0c83e35aa89b2b0b4e71">  221</a></span>         SEC_STATUS_ENC_KEY_SIZE         = 0x86,  <span class="comment">/**&lt; Encryption key size. */</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca8644843d8b7aa10569de993882eaf0b2">  222</a></span>         SEC_STATUS_SMP_CMD_UNSUPPORTED  = 0x87,  <span class="comment">/**&lt; Unsupported SMP command. */</span></div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca907e96fc4be924ff96d3bca4c95c32d8">  223</a></span>         SEC_STATUS_UNSPECIFIED          = 0x88,  <span class="comment">/**&lt; Unspecified reason. */</span></div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8ca60299539d4d40ed67584e209e28c3b78">  224</a></span>         SEC_STATUS_REPEATED_ATTEMPTS    = 0x89,  <span class="comment">/**&lt; Too little time elapsed since last attempt. */</span></div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8cac59f728f7ee2a685de192d28dcb8c207">  225</a></span>         SEC_STATUS_INVALID_PARAMS       = 0x8A,  <span class="comment">/**&lt; Invalid parameters. */</span></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8cab3a8b83ce7c1096207b25e471d393c0a">  226</a></span>         SEC_STATUS_DHKEY_CHECK_FAILED   = 0x8B,  <span class="comment">/**&lt; DHKey received doesn’t match locally calculated one. */</span></div><div class="line"><a name="l00227"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8cadba024c5fcd0c4cd552b061dbbd400ee">  227</a></span>         SEC_STATUS_COMPARISON_FAILED    = 0x8C,  <span class="comment">/**&lt; Values in the numeric comparison protocol do not match. */</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>     };</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span> <span class="comment"></span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span> <span class="comment">    /**</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span> <span class="comment">     * Declaration of type containing a passkey to be used during pairing. This</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span> <span class="comment">     * is passed into initializeSecurity() to specify a pre-programmed passkey</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span> <span class="comment">     * for authentication instead of generating a random one.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span> <span class="comment">     */</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#a1d48c3dc2c084629f12766660ac97333">  235</a></span>     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> PASSKEY_LEN = 6;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager.html#ae0d0f7d72a94e9dac5051e5df42d43d5">  236</a></span>     <span class="keyword">typedef</span> uint8_t Passkey_t[PASSKEY_LEN]; <span class="comment">/**&lt; 6-digit passkey in ASCII ('0'-'9' digits only). */</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span> </div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>     <span class="keyword">typedef</span> <a class="code" href="class_function_pointer_with_context.html">FunctionPointerWithContext&lt;const SecurityManager *&gt;</a> <a class="code" href="class_function_pointer_with_context.html">SecurityManagerShutdownCallback_t</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>     <span class="keyword">typedef</span> <a class="code" href="class_call_chain_of_function_pointers_with_context.html">CallChainOfFunctionPointersWithContext&lt;const SecurityManager *&gt;</a> <a class="code" href="class_call_chain_of_function_pointers_with_context.html">SecurityManagerShutdownCallbackChain_t</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span> <span class="comment"></span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span> <span class="comment">    /** The stack will use these functions to signal events to the application,</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span> <span class="comment">     *  subclass to override handlers. Use SecurityManager::setSecurityManagerEventHandler</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span> <span class="comment">     *  to set the interface implementation to be used. */</span></div><div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html">  244</a></span>     <span class="keyword">class </span><a class="code" href="classble_1_1_security_manager_1_1_event_handler.html">EventHandler</a> {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>     <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span> <span class="comment">        ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span> <span class="comment"></span>        <span class="comment">// Pairing</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>         <span class="comment">//</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span> </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span> <span class="preprocessor">#if BLE_ROLE_PERIPHERAL</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span> <span class="comment">        /**</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span> <span class="comment">         * Called when a pairing request is received. Application should respond by</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span> <span class="comment">         * calling the appropriate function: acceptPairingRequest() or cancelPairingRequest().</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span> <span class="comment">         * This event will only trigger if setPairingRequestAuthorisation() was called with true.</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span> <span class="comment">         * Otherwise the stack will handle the requests.</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span> <span class="comment">         *</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span> <span class="comment">         *</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span> <span class="comment">         * @see requestPairing()</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span> <span class="comment">         * @see requestAuthentication()</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span> <span class="comment">         * @see setLinkEncryption()</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span> <span class="comment">         * @see setPairingRequestAuthorisation()</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span> <span class="comment">         */</span></div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#ad401e31302efa266bf13b60d3d1bf8dc">  264</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#ad401e31302efa266bf13b60d3d1bf8dc">pairingRequest</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>             (void)connectionHandle;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>         }</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span> <span class="preprocessor">#endif // BLE_ROLE_PERIPHERAL</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span> <span class="comment"></span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span> <span class="comment">        /**</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span> <span class="comment">         * Indicate to the application that pairing has completed.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span> <span class="comment">         *</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span> <span class="comment">         * @param[in] result result of the pairing indicating success or reason for failure</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span> <span class="comment">         *</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span> <span class="comment">         * @see acceptPairingRequest()</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span> <span class="comment">         * @see requestPairing()</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span> <span class="comment">         */</span></div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a41a793961bdc2e09abe735287423c40e">  278</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a41a793961bdc2e09abe735287423c40e">pairingResult</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8c">SecurityCompletionStatus_t</a> result) {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>             (void)connectionHandle;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>             (void)result;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>         }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span> <span class="comment"></span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span> <span class="comment">        /**</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span> <span class="comment">         * Indicate that a peer address has been saved by the security manager or if we are</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span> <span class="comment">         * bonded to the peer the identity has been retrieved from the database on connection.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span> <span class="comment">         *</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span> <span class="comment">         * @param[in] connectionHandle Connection handle.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span> <span class="comment">         * @param[in] peer_address Peer address that has been saved by the security database, NULL it not found.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span> <span class="comment">         * @param[in] address_is_public Address type, true if public. Invalid if peer_address NULL.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span> <span class="comment">         *</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span> <span class="comment">         * @see getPeerIdentity()</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span> <span class="comment">         */</span></div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#afd3906e75c4bc4d7e6aae5e27288758a">  293</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#afd3906e75c4bc4d7e6aae5e27288758a">peerIdentity</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle,</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>                                   <span class="keyword">const</span> <a class="code" href="structble_1_1address__t.html">address_t</a> *peer_address,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>                                   <span class="keywordtype">bool</span> address_is_public) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>             (void)connectionHandle;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>             (void)peer_address;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>             (void)address_is_public;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>         }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span> <span class="comment"></span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span> <span class="comment">        ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span> <span class="comment"></span>        <span class="comment">// Security</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>         <span class="comment">//</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span> <span class="comment"></span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span> <span class="comment">        /**</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span> <span class="comment">         * Deliver the requested whitelist to the application.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span> <span class="comment">         *</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span> <span class="comment">         * @param[in] whitelist pointer to the whitelist filled with entries based on bonding information</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span> <span class="comment">         *</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span> <span class="comment">         * @see generateWhitelistFromBondTable()</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span> <span class="comment">         */</span></div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a068ce5188b3d0175e6fcdb5b04b76356">  312</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a068ce5188b3d0175e6fcdb5b04b76356">whitelistFromBondTable</a>(::<a class="code" href="structble_1_1whitelist__t.html">ble::whitelist_t</a>* whitelist) {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>             (void)whitelist;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>         }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span> <span class="comment"></span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span> <span class="comment">        ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span> <span class="comment"></span>        <span class="comment">// Encryption</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>         <span class="comment">//</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span> <span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span> <span class="comment">        /**</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span> <span class="comment">         * Triggered by change of encryption state on a link. This change can be initiated</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span> <span class="comment">         * locally or by the remote peer.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span> <span class="comment">         *</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span> <span class="comment">         * @param[in] result encryption state of the link</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span> <span class="comment">         *</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span> <span class="comment">         * @see requestAuthentication()</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span> <span class="comment">         * @see setLinkEncryption()</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span> <span class="comment">         */</span></div><div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a11d05969cbd7e7f0d81fbe71d382b004">  330</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a11d05969cbd7e7f0d81fbe71d382b004">linkEncryptionResult</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="structble_1_1link__encryption__t.html">ble::link_encryption_t</a> result) {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>             (void)connectionHandle;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>             (void)result;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>         }</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span> <span class="comment"></span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span> <span class="comment">        ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span> <span class="comment"></span>        <span class="comment">// MITM</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>         <span class="comment">//</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span> <span class="comment"></span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span> <span class="comment">        /**</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span> <span class="comment">         * Triggered during pairing based on IO capabilities of devices. Display the given</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span> <span class="comment">         * passkey on the local device for user verification.</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span> <span class="comment">         *</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span> <span class="comment">         * @param[in] passkey 6 digit passkey to be displayed</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span> <span class="comment">         *</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span> <span class="comment">         * @see init()</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span> <span class="comment">         * @see setIoCapability()</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span> <span class="comment">         */</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span> <span class="preprocessor">#if BLE_PASSKEY_DISPLAY_REVERSED_DIGITS_DEPRECATION</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>         <a class="code" href="group__platform__toolchain.html#ga2822a5c443e30d9fff9c591743ac616d">MBED_DEPRECATED_SINCE</a>(<span class="stringliteral">"mbed-os-6.8.0"</span>, <span class="stringliteral">"This returns the passkey in reverse order. Please set the config option ble.ble-passkey-display-reversed-digits-deprecation in your mbed_app.json override section to false. This will then return the passkey in the correct order."</span>)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span> <span class="preprocessor">#endif // BLE_PASSKEY_DISPLAY_REVERSED_DIGITS_DEPRECATION</span></div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a2454fd5afbe95c69b67936855bf0219d">  352</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a2454fd5afbe95c69b67936855bf0219d">passkeyDisplay</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <span class="keyword">const</span> Passkey_t passkey) {</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>             (void)connectionHandle;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>             (void)passkey;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>         }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span> </div><div class="line"><a name="l00357"></a><span class="lineno">  357</span> <span class="preprocessor">#if BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span> <span class="comment">        /**</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span> <span class="comment">         * Indicate to the application that a confirmation is required. This is used</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span> <span class="comment">         * when the device does not have a keyboard but has a yes/no button. The device</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span> <span class="comment">         * displays numbers on its display in response to passkeyDisplay and the user</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span> <span class="comment">         * checks if they are the same on both devices. The application should proceed</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span> <span class="comment">         * by supplying the confirmation using the confirmationEntered function.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span> <span class="comment">         *</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span> <span class="comment">         *</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span> <span class="comment">         * @see init()</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span> <span class="comment">         * @see setIoCapability()</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span> <span class="comment">         * @see confirmationEntered()</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span> <span class="comment">         */</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a566a9f17c6b055994ce993623845b0e8">  371</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a566a9f17c6b055994ce993623845b0e8">confirmationRequest</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle) {</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>             (void)connectionHandle;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>         }</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span> <span class="preprocessor">#endif // BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span> <span class="comment"></span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span> <span class="comment">        /**</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span> <span class="comment">         * Indicate to the application that a passkey is required. The application should</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span> <span class="comment">         * proceed by supplying the passkey through the passkeyEntered function.</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span> <span class="comment">         *</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span> <span class="comment">         *</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span> <span class="comment">         * @see init()</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span> <span class="comment">         * @see setIoCapability()</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span> <span class="comment">         * @see passkeyEntered()</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span> <span class="comment">         */</span></div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a4c15d8354045b6d798b9f923b998c3b5">  386</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a4c15d8354045b6d798b9f923b998c3b5">passkeyRequest</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle) {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>             (void)connectionHandle;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>         }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span> </div><div class="line"><a name="l00390"></a><span class="lineno">  390</span> <span class="preprocessor">#if BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span> <span class="comment">        /**</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span> <span class="comment">         * Notify the application that a key was pressed by the peer during passkey entry.</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span> <span class="comment">         * This is only informative to provide feedback to the user. These events will only</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span> <span class="comment">         * be triggered if you call setKeypressNotification()</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span> <span class="comment">         *</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span> <span class="comment">         * @param[in] keypress type of keypress event</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span> <span class="comment">         *</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span> <span class="comment">         * @see setKeypressNotification()</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span> <span class="comment">         */</span></div><div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a50b701c84896761ad31cd8ed70fdd6d0">  401</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a50b701c84896761ad31cd8ed70fdd6d0">keypressNotification</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="namespaceble.html#ad795c6b00632415eb3f54a1115b81653">ble::Keypress_t</a> keypress) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>             (void)connectionHandle;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>             (void)keypress;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>         }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span> <span class="preprocessor">#endif // BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span> <span class="comment"></span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span> <span class="comment">        /**</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span> <span class="comment">         * Indicate to the application it needs to return legacy pairing OOB to the stack</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span> <span class="comment">         * using legacyPairingOobReceived().</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span> <span class="comment">         *</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span> <span class="comment">         *</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span> <span class="comment">         * @see legacyPairingOobReceived()</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span> <span class="comment">         */</span></div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#ae957cf4608b091de66d5b4275c2f2a07">  415</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#ae957cf4608b091de66d5b4275c2f2a07">legacyPairingOobRequest</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle) {</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>             (void)connectionHandle;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>         }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span> <span class="comment"></span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span> <span class="comment">        /**</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span> <span class="comment">         * Indicate that the application needs to send legacy pairing OOB data to the peer through</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span> <span class="comment">         * another communication channel.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span> <span class="comment">         *</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span> <span class="comment">         * @param[in] address address that will be used in the pairing</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span> <span class="comment">         * @param[in] temporaryKey temporary key to be used in legacy pairing</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span> <span class="comment">         */</span></div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#aaed95f977e596014008b063130fb9eff">  426</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#aaed95f977e596014008b063130fb9eff">legacyPairingOobGenerated</a>(<span class="keyword">const</span> <a class="code" href="structble_1_1address__t.html">ble::address_t</a> *address,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>                                                <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::oob_tk_t</a> *temporaryKey) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>             (void)address;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>             (void)temporaryKey;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>         }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span> <span class="comment"></span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span> <span class="comment">        /**</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span> <span class="comment">         * Indicate that the application needs to send secure connections OOB data to the peer.</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span> <span class="comment">         *</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span> <span class="comment">         * @param[in] address address that will be used in the pairing</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span> <span class="comment">         * @param[in] random random number used to generate the confirmation</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span> <span class="comment">         * @param[in] confirm confirmation value to be use for authentication</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span> <span class="comment">         *                    in secure connections pairing</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span> <span class="comment">         *</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span> <span class="comment">         * @see generateOOB()</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span> <span class="comment">         */</span></div><div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a1aeff70cff4bdbc80c2d7bf2f7090bd3">  442</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a1aeff70cff4bdbc80c2d7bf2f7090bd3">oobGenerated</a>(<span class="keyword">const</span> <a class="code" href="structble_1_1address__t.html">ble::address_t</a> *address,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>                                   <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::oob_lesc_value_t</a> *random,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>                                   <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::oob_confirm_t</a> *confirm) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>             (void)address;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>             (void)random;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>             (void)confirm;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>         }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span> <span class="comment"></span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span> <span class="comment">        ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span> <span class="comment"></span>        <span class="comment">// Keys</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>         <span class="comment">//</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span> </div><div class="line"><a name="l00454"></a><span class="lineno">  454</span> <span class="preprocessor">#if BLE_FEATURE_SIGNING</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span> <span class="comment">        /**</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span> <span class="comment">         * Deliver the signing key to the application.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span> <span class="comment">         *</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span> <span class="comment">         * @param[in] connectionHandle connection connectionHandle</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span> <span class="comment">         * @param[in] csrk signing key, pointer only valid during call</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span> <span class="comment">         * @param[in] authenticated indicates if the signing key is authenticated</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span> <span class="comment">         *</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span> <span class="comment">         * @see getSigningKey()</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span> <span class="comment">         */</span></div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="classble_1_1_security_manager_1_1_event_handler.html#a2763a67f9155c3e4f209599ea29654cd">  464</a></span>         <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classble_1_1_security_manager_1_1_event_handler.html#a2763a67f9155c3e4f209599ea29654cd">signingKey</a>(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::csrk_t</a> *csrk, <span class="keywordtype">bool</span> authenticated) {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>             (void)connectionHandle;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>             (void)csrk;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>             (void)authenticated;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>         }</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span> <span class="preprocessor">#endif // BLE_FEATURE_SIGNING</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span> <span class="comment"></span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span> <span class="comment">        /**</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span> <span class="comment">         * Prevent polymorphic deletion and avoid unnecessary virtual destructor</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span> <span class="comment">         * as the SecurityManager class will never delete the instance it contains.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span> <span class="comment">         */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>         ~<a class="code" href="classble_1_1_security_manager_1_1_event_handler.html">EventHandler</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>     };</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span> </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>     <span class="comment">/*</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span> <span class="comment">     * The following functions are meant to be overridden in the platform-specific sub-class.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span> <span class="comment">     */</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span> <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span> <span class="comment"></span>    <span class="comment">// SM lifecycle management</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>     <span class="comment">//</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span> <span class="comment"></span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span> <span class="comment">    /**</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span> <span class="comment">     * Enable the BLE stack's Security Manager. The Security Manager implements</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span> <span class="comment">     * the actual cryptographic algorithms and protocol exchanges that allow two</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span> <span class="comment">     * devices to securely exchange data and privately detect each other.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span> <span class="comment">     * Calling this API is a prerequisite for encryption and pairing (bonding).</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span> <span class="comment">     *</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span> <span class="comment">     * @param[in]  enableBonding Allow for bonding.</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span> <span class="comment">     * @param[in]  requireMITM   Require protection for man-in-the-middle attacks.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span> <span class="comment">     * @param[in]  iocaps        To specify the I/O capabilities of this peripheral,</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span> <span class="comment">     *                           such as availability of a display or keyboard, to</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span> <span class="comment">     *                           support out-of-band exchanges of security data.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span> <span class="comment">     * @param[in]  passkey       To specify a static passkey.</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span> <span class="comment">     * @param[in]  signing       Generate and distribute signing key during pairing</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span> <span class="comment">     * @param[in]  dbFilepath    Path to the file used to store keys in the filesystem,</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span> <span class="comment">     *                           if NULL keys will be only stored in memory</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span> <span class="comment">     *</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span> <span class="comment">     *</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span> <span class="comment">     * @return BLE_ERROR_NONE on success.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span> <span class="comment">     */</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> init(</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>         <span class="keywordtype">bool</span>                     enableBonding = <span class="keyword">true</span>,</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>         <span class="keywordtype">bool</span>                     requireMITM   = <span class="keyword">true</span>,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>         <a class="code" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65">SecurityIOCapabilities_t</a> iocaps        = IO_CAPS_NONE,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>         <span class="keyword">const</span> Passkey_t          passkey       = <span class="keyword">nullptr</span>,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>         <span class="keywordtype">bool</span>                     signing       = <span class="keyword">true</span>,</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>         <span class="keyword">const</span> <span class="keywordtype">char</span>              *dbFilepath    = <span class="keyword">nullptr</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>     );</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span> <span class="comment"></span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span> <span class="comment">    /**</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span> <span class="comment">     * Change the file used for the security database. If path is invalid or a NULL is passed</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span> <span class="comment">     * keys will only be stored in memory.</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span> <span class="comment">     *</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span> <span class="comment">     * @note This operation is only allowed with no active connections.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span> <span class="comment">     *</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span> <span class="comment">     * @param[in]  dbFilepath    Path to the file used to store keys in the filesystem,</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span> <span class="comment">     *                           if NULL keys will be only stored in memory</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span> <span class="comment">     *</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span> <span class="comment">     * @return BLE_ERROR_NONE on success.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span> <span class="comment">     */</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setDatabaseFilepath(<span class="keyword">const</span> <span class="keywordtype">char</span> *dbFilepath = <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span> <span class="comment"></span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span> <span class="comment">    /**</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span> <span class="comment">     * Notify all registered onShutdown callbacks that the SecurityManager is</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span> <span class="comment">     * about to be shutdown and clear all SecurityManager state of the</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span> <span class="comment">     * associated object.</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span> <span class="comment">     *</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span> <span class="comment">     * This function is meant to be overridden in the platform-specific</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span> <span class="comment">     * sub-class. Nevertheless, the sub-class is only expected to reset its</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span> <span class="comment">     * state and not the data held in SecurityManager members. This shall be</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span> <span class="comment">     * achieved by a call to SecurityManager::reset() from the sub-class'</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span> <span class="comment">     * reset() implementation.</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span> <span class="comment">     *</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span> <span class="comment">     * @return BLE_ERROR_NONE on success.</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span> <span class="comment">     */</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> reset();</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span> <span class="comment"></span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span> <span class="comment">    /**</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span> <span class="comment">     * Normally all bonding information is lost when device is reset, this requests that the stack</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span> <span class="comment">     * attempts to save the information and reload it during initialisation. This is not guaranteed.</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span> <span class="comment">     *</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span> <span class="comment">     * @note This option is itself saved together with bonding data. When data is read after reset,</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span> <span class="comment">     * the state of this option decides if data should be restored. If this option has not been saved</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span> <span class="comment">     * the data will not be restored even if partial data is present.</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span> <span class="comment">     *</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span> <span class="comment">     * @param[in] enable if true the stack will attempt to preserve bonding information on reset.</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span> <span class="comment">     */</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> preserveBondingStateOnReset(<span class="keywordtype">bool</span> enable);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span> <span class="comment"></span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span> <span class="comment">    /**</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span> <span class="comment">     * Some or all of bonding information may be stored in memory while in use. This will write</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span> <span class="comment">     * bonding data to persistent storage. This will have no effect if no persistent storage is enabled.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span> <span class="comment">     *</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span> <span class="comment">     * @note This implicitly also calls preserveBondingStateOnReset(true) inside.</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span> <span class="comment">     *</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span> <span class="comment">     * @note Depending on the driver used to implement the storage solution used this may be a disruptive</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span> <span class="comment">     * operation and may cause active connections to drop due to failed processing deadlines.</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span> <span class="comment">     *</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span> <span class="comment">     */</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> writeBondingStateToPersistentStorage();</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span> <span class="comment"></span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span> <span class="comment"></span>    <span class="comment">// List management</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>     <span class="comment">//</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span> <span class="comment"></span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span> <span class="comment">    /**</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span> <span class="comment">     * Delete all peer device context and all related bonding information from</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span> <span class="comment">     * the database within the security manager.</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span> <span class="comment">     *</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span> <span class="comment">     * @retval BLE_ERROR_NONE             On success, else an error code indicating reason for failure.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span> <span class="comment">     * @retval BLE_ERROR_INVALID_STATE    If the API is called without module initialization or</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span> <span class="comment">     *                                    application registration.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span> <span class="comment">     */</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> purgeAllBondingState();</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span> <span class="comment"></span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span> <span class="comment">    /**</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span> <span class="comment">     * Create a list of addresses from all peers in the bond table and generate</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span> <span class="comment">     * an event which returns it as a whitelist. Pass in the container for the whitelist.</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span> <span class="comment">     * This will be returned by the event.</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span> <span class="comment">     *</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span> <span class="comment">     * @param[in] whitelist Preallocated whitelist which will be filled up to its capacity.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span> <span class="comment">     *                      If whitelist already contains entries this will be appended to.</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span> <span class="comment">     *                      Do not access the whitelist until callback has been called,</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span> <span class="comment">     *                      returning the filled whitelist.</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span> <span class="comment">     *</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span> <span class="comment">     * @retval BLE_ERROR_NONE On success, else an error code indicating reason for failure</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span> <span class="comment">     */</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> generateWhitelistFromBondTable(::<a class="code" href="structble_1_1whitelist__t.html">ble::whitelist_t</a> *whitelist) <span class="keyword">const</span>;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span> <span class="comment"></span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span> <span class="comment"></span>    <span class="comment">// Pairing</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>     <span class="comment">//</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span> </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span> <span class="preprocessor">#if BLE_ROLE_CENTRAL</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span> <span class="comment">    /**</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span> <span class="comment">     * Request pairing with the peer. Called by the master.</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span> <span class="comment">     * @note Slave can call requestAuthentication or setLinkEncryption to achieve security.</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span> <span class="comment">     *</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span> <span class="comment">     *</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span> <span class="comment">     * @see EventHandler::pairingResult()</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span> <span class="comment">     */</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> requestPairing(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span> <span class="preprocessor">#endif // BLE_ROLE_CENTRAL</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span> </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span> <span class="preprocessor">#if BLE_ROLE_PERIPHERAL</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span> <span class="comment">    /**</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span> <span class="comment">     * Accept the pairing request. Called as a result of pairingRequest being called</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span> <span class="comment">     * on the event handler.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span> <span class="comment">     *</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span> <span class="comment">     *</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span> <span class="comment">     * @see EventHandler::pairingRequest()</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span> <span class="comment">     */</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> acceptPairingRequest(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span> <span class="preprocessor">#endif // BLE_ROLE_PERIPHERAL</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span> <span class="comment"></span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span> <span class="comment">    /**</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span> <span class="comment">     * Reject pairing request if the local device is the slave or cancel an outstanding</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span> <span class="comment">     * pairing request if master.</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span> <span class="comment">     *</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span> <span class="comment">     *</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span> <span class="comment">     * @see EventHandler::pairingRequest()</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span> <span class="comment">     */</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> cancelPairingRequest(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span> <span class="comment"></span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span> <span class="comment">    /**</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span> <span class="comment">     * Tell the stack whether the application needs to authorise pairing requests or should</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span> <span class="comment">     * they be automatically accepted.</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span> <span class="comment">     *</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span> <span class="comment">     * @param[in] required If set to true, pairingRequest in the event handler will</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span> <span class="comment">     *                     will be called and will require an action from the application</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span> <span class="comment">     *                     to continue with pairing by calling acceptPairingRequest</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span> <span class="comment">     *                     or cancelPairingRequest if the user wishes to reject it.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span> <span class="comment">     *</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span> <span class="comment">     * @see EventHandler::pairingRequest()</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span> <span class="comment">     * @see EventHandler::acceptPairingRequest()</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span> <span class="comment">     * @see EventHandler::cancelPairingRequest()</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span> <span class="comment">     */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setPairingRequestAuthorisation(<span class="keywordtype">bool</span> required = <span class="keyword">true</span>);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span> <span class="comment"></span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span> <span class="comment">    /**</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span> <span class="comment">     * Retrieve identity address for the peer on the given connection.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span> <span class="comment">     *</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span> <span class="comment">     *</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span> <span class="comment">     * @see EventHandler::peerIdentity()</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span> <span class="comment">     */</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> getPeerIdentity(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span> <span class="comment"></span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span> <span class="comment"></span>    <span class="comment">// Feature support</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>     <span class="comment">//</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span> </div><div class="line"><a name="l00667"></a><span class="lineno">  667</span> <span class="preprocessor">#if BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span> <span class="comment">    /**</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span> <span class="comment">     * Allow or disallow the use of legacy pairing in case the application only wants</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span> <span class="comment">     * to force the use of Secure Connections. If legacy pairing is disallowed and either</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span> <span class="comment">     * side doesn't support Secure Connections the pairing will fail.</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span> <span class="comment">     *</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span> <span class="comment">     * @param[out] allow If true legacy pairing will be used if either side doesn't support Secure Connections.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span> <span class="comment">     */</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> allowLegacyPairing(<span class="keywordtype">bool</span> allow = <span class="keyword">true</span>);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span> <span class="comment"></span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span> <span class="comment">    /**</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span> <span class="comment">     * Check if the Secure Connections feature is supported by the stack and controller.</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span> <span class="comment">     *</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span> <span class="comment">     * @param[out] enabled true if SC are supported</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span> <span class="comment">     */</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> getSecureConnectionsSupport(<span class="keywordtype">bool</span> *enabled);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span> <span class="preprocessor">#endif // BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span> <span class="comment"></span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span> <span class="comment"></span>    <span class="comment">// Security settings</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>     <span class="comment">//</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span> <span class="comment"></span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span> <span class="comment">    /**</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span> <span class="comment">     * Set the IO capability of the local device.</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span> <span class="comment">     *</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span> <span class="comment">     * @param[in] iocaps type of IO capabilities available on the local device</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span> <span class="comment">     */</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setIoCapability(<a class="code" href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65">SecurityIOCapabilities_t</a> iocaps);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span> <span class="comment"></span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span> <span class="comment">    /**</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span> <span class="comment">     * Set the passkey that is displayed on the local device instead of using</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span> <span class="comment">     * a randomly generated one. This will be used during pairing</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span> <span class="comment">     *</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span> <span class="comment">     * @param[in] passkey ASCII string of 6 digits</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span> <span class="comment">     *</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span> <span class="comment">     * @see EventHandler::passkeyRequest() - this will be called on the peer which will have</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span> <span class="comment">     * to use passkeyEntered() to send this passkey back to us.</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span> <span class="comment">     */</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setDisplayPasskey(<span class="keyword">const</span> Passkey_t passkey);</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span> <span class="comment"></span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span> <span class="comment">    /**</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span> <span class="comment">     * Set the security mode on a connection. Useful for elevating the security mode</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span> <span class="comment">     * once certain conditions are met, e.g., a particular service is found.</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span> <span class="comment">     * This call is a request for the stack to take appropriate action and may result</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span> <span class="comment">     * in (re)pairing or encryption. Wait for events in your registered EventHandler.</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span> <span class="comment">     *</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span> <span class="comment">     * @param[in]  connectionHandle   Handle to identify the connection.</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span> <span class="comment">     * @param[in]  securityMode       Requested security mode.</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span> <span class="comment">     *</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span> <span class="comment">     *</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span> <span class="comment">     * @see EventHandler::linkEncryptionResult()</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span> <span class="comment">     * @see EventHandler::pairingResult()</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span> <span class="comment">     */</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setLinkSecurity(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179">SecurityMode_t</a> securityMode);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span> <span class="comment"></span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span> <span class="comment">    /**</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span> <span class="comment">     * Set whether or not we want to send and receive keypress notifications</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span> <span class="comment">     * during passkey entry.</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span> <span class="comment">     *</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span> <span class="comment">     * @param[in] enabled if true pairing will try to enable keypress notifications</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span> <span class="comment">     * (dependent on other side supporting it)</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span> <span class="comment">     *</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span> <span class="comment">     */</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setKeypressNotification(<span class="keywordtype">bool</span> enabled = <span class="keyword">true</span>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span> </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span> <span class="preprocessor">#if BLE_FEATURE_SIGNING</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span> <span class="comment">    /**</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span> <span class="comment">     * Request generation and exchange of signing keys so that packet signing can be utilised</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span> <span class="comment">     * on this connection.</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span> <span class="comment">     * @note This does not generate a signingKey event. Use getSigningKey for that.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span> <span class="comment">     *</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span> <span class="comment">     * @param[in] enabled          If set to true, signing keys will be exchanged</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span> <span class="comment">     *                             during subsequent pairing.</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span> <span class="comment">     */</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> enableSigning(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <span class="keywordtype">bool</span> enabled = <span class="keyword">true</span>);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span> <span class="preprocessor">#endif // BLE_FEATURE_SIGNING</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span> <span class="comment"></span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span> <span class="comment">    /**</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span> <span class="comment">     * Give a hint to the stack that the master/slave role might change in the future.</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span> <span class="comment">     *</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span> <span class="comment">     * @param[in] enable If set to true it hints the roles are likely to swap in the future.</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span> <span class="comment">     *</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span> <span class="comment">     */</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setHintFutureRoleReversal(<span class="keywordtype">bool</span> enable = <span class="keyword">true</span>);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span> <span class="comment"></span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span> <span class="comment"></span>    <span class="comment">// Encryption</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>     <span class="comment">//</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span> <span class="comment"></span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span> <span class="comment">    /**</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span> <span class="comment">     * Current state of encryption on the link.</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span> <span class="comment">     *</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span> <span class="comment">     * @param[out] encryption</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span> <span class="comment">     */</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> getLinkEncryption(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="structble_1_1link__encryption__t.html">ble::link_encryption_t</a> *encryption);</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span> <span class="comment"></span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span> <span class="comment">    /**</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span> <span class="comment">     * Enabled or disable encryption on the link. The result of this request will be indicated</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span> <span class="comment">     * by a call to linkEncryptionResult in the event handler when the action is completed.</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span> <span class="comment">     *</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span> <span class="comment">     * @param[in] encryption encryption state requested</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span> <span class="comment">     *</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span> <span class="comment">     * @see EventHandler::linkEncryptionResult()</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span> <span class="comment">     */</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setLinkEncryption(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="structble_1_1link__encryption__t.html">ble::link_encryption_t</a> encryption);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span> <span class="comment"></span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span> <span class="comment">    /**</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span> <span class="comment">     * Set the requirements for encryption key size. If the peer cannot comply with the requirements</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span> <span class="comment">     * paring will fail.</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span> <span class="comment">     *</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span> <span class="comment">     * @param[in] minimumByteSize Smallest allowed encryption key size in bytes. (no smaller than 7)</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span> <span class="comment">     * @param[in] maximumByteSize Largest allowed encryption key size in bytes. (no larger than 16)</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span> <span class="comment">     */</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setEncryptionKeyRequirements(uint8_t minimumByteSize, uint8_t maximumByteSize);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span> <span class="comment"></span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span> <span class="comment">    /**</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span> <span class="comment">     * Get encryption key size for given connection.</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span> <span class="comment">     *</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span> <span class="comment">     * @param[out] size Returns the key size in bits.</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span> <span class="comment">     *</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span> <span class="comment">     */</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> getEncryptionKeySize(</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>         <a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">connection_handle_t</a> connectionHandle,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>         uint8_t *size</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>     );</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span> <span class="comment"></span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span> <span class="comment"></span>    <span class="comment">// Authentication</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>     <span class="comment">//</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span> <span class="comment"></span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span> <span class="comment">    /**</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span> <span class="comment">     * Request that the link be authenticated (keys with MITM protection). This might trigger encryption</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span> <span class="comment">     * or pairing/re-pairing. The success will be indicated through an event indicating security level change.</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span> <span class="comment">     *</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span> <span class="comment">     *</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span> <span class="comment">     * @see EventHandler::linkEncryptionResult()</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span> <span class="comment">     * @see EventHandler::pairingResult()</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span> <span class="comment">     */</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> requestAuthentication(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span> <span class="comment"></span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span> <span class="comment"></span>    <span class="comment">// MITM</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>     <span class="comment">//</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span> <span class="comment"></span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span> <span class="comment">    /**</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span> <span class="comment">     * Generate OOB data with the given address. If Secure Connections is supported this will</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span> <span class="comment">     * also generate Secure Connections OOB data on top of legacy pairing OOB data. This can be used</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span> <span class="comment">     * to generate such data before the connection takes place.</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span> <span class="comment">     *</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span> <span class="comment">     * In this model the OOB exchange takes place before the devices connect. Devices should establish</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span> <span class="comment">     * communication over another channel and exchange the OOB data. The address provided will be used</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span> <span class="comment">     * by the peer to associate the received data with the address of the device it will then connect</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span> <span class="comment">     * to over BLE.</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span> <span class="comment">     *</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span> <span class="comment">     * @param[in] address The local address you will use in the connection using this OOB data. This</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span> <span class="comment">     *                    address will be returned along with the rest of the OOB data when generation</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span> <span class="comment">     *                    is complete. Using an invalid address is illegal.</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span> <span class="comment">     *</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span> <span class="comment">     * @see EventHandler::oobGenerated()</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span> <span class="comment">     */</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> generateOOB(<span class="keyword">const</span> <a class="code" href="structble_1_1address__t.html">ble::address_t</a> *address);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span> <span class="comment"></span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span> <span class="comment">    /**</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span> <span class="comment">     * Enable OOB data usage during paring. If Secure Connections is supported enabling useOOB will</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span> <span class="comment">     * generate Secure Connections OOB data through oobGenerated() on top of legacy pairing OOB data.</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span> <span class="comment">     *</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span> <span class="comment">     * You do not have to call this function to return received OOB data. Use legacyPairingOobReceived</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span> <span class="comment">     * or oobReceived to hand it in. This will allow the stack to use it if possible. You only need to</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span> <span class="comment">     * call this function to attempt legacy OOB data exchange after pairing start and to inform</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span> <span class="comment">     * the stack OOB data does not provide MITM protection (by default it is set to provide this).</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span> <span class="comment">     *</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span> <span class="comment">     * In this model the OOB exchange takes places after the devices have connected but possibly</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span> <span class="comment">     * prior to pairing. For secure connections pairing must not be started until after the OOB</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span> <span class="comment">     * data has been sent and/or received. The address in the OOB data generated will match</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span> <span class="comment">     * the original address used to establish the connection and will be used by the peer to</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span> <span class="comment">     * identify which connection the OOB data belongs to.</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span> <span class="comment">     *</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span> <span class="comment">     * @param[in] useOOB If set to true, authenticate using OOB data.</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span> <span class="comment">     * @param[in] OOBProvidesMITM If set to true keys exchanged during pairing using OOB data</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span> <span class="comment">     *                            will provide Man-in-the-Middle protection. This indicates that</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span> <span class="comment">     *                            the form of exchange used by the OOB data itself provides MITM</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span> <span class="comment">     *                            protection.</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span> <span class="comment">     */</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setOOBDataUsage(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <span class="keywordtype">bool</span> useOOB, <span class="keywordtype">bool</span> OOBProvidesMITM = <span class="keyword">true</span>);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span> </div><div class="line"><a name="l00873"></a><span class="lineno">  873</span> <span class="preprocessor">#if BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span> <span class="comment">    /**</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span> <span class="comment">     * Report to the stack if the passkey matches or not. Used during pairing to provide MITM protection.</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span> <span class="comment">     *</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span> <span class="comment">     * @param[in] confirmation True value indicates the passkey displayed matches.</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span> <span class="comment">     *</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span> <span class="comment">     * @see EventHandler::confirmationRequest()</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span> <span class="comment">     */</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> confirmationEntered(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <span class="keywordtype">bool</span> confirmation);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span> <span class="preprocessor">#endif // BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span> <span class="comment"></span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span> <span class="comment">    /**</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span> <span class="comment">     * Supply the stack with the user entered passkey.</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span> <span class="comment">     *</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span> <span class="comment">     * @param[in] passkey ASCII string of digits entered by the user.</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span> <span class="comment">     *</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span> <span class="comment">     * @see EventHandler::passkeyRequest()</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span> <span class="comment">     */</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> passkeyEntered(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, Passkey_t passkey);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span> </div><div class="line"><a name="l00897"></a><span class="lineno">  897</span> <span class="preprocessor">#if BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span> <span class="comment">    /**</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span> <span class="comment">     * Send a notification to the peer that the user pressed a key on the local device.</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span> <span class="comment">     * @note This will only be delivered if the keypress notifications have been enabled during pairing.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span> <span class="comment">     *</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span> <span class="comment">     * @param[in] keypress Type of keypress event.</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span> <span class="comment">     *</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span> <span class="comment">     * @see EventHandler::keypressNotification() - this will be trigger on the peer</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span> <span class="comment">     */</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> sendKeypressNotification(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <a class="code" href="namespaceble.html#ad795c6b00632415eb3f54a1115b81653">ble::Keypress_t</a> keypress);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span> <span class="preprocessor">#endif // BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span> <span class="comment"></span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span> <span class="comment">    /**</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span> <span class="comment">     * Supply the stack with the OOB data for legacy connections.</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span> <span class="comment">     *</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span> <span class="comment">     * @param[in] address address of the peer device this data comes from</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span> <span class="comment">     * @param[in] tk pointer to out of band data received containing the temporary key.</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span> <span class="comment">     *</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span> <span class="comment">     * @see legacyPairingOobRequest</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span> <span class="comment">     */</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> legacyPairingOobReceived(<span class="keyword">const</span> <a class="code" href="structble_1_1address__t.html">ble::address_t</a> *address, <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::oob_tk_t</a> *tk);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span> </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span> <span class="preprocessor">#if BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span> <span class="comment">    /**</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span> <span class="comment">     * Supply the stack with the OOB data for secure connections. This data is generated on the peer</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span> <span class="comment">     * and is received through another communication channel.</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span> <span class="comment">     *</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span> <span class="comment">     * @param[in] address address of the peer device this data comes from</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span> <span class="comment">     * @param[in] random random number used to generate the confirmation</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span> <span class="comment">     * @param[in] confirm confirmation value to be use for authentication</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span> <span class="comment">     *                    in secure connections pairing</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span> <span class="comment">     */</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> oobReceived(<span class="keyword">const</span> <a class="code" href="structble_1_1address__t.html">ble::address_t</a> *address, <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::oob_lesc_value_t</a> *random, <span class="keyword">const</span> <a class="code" href="structble_1_1byte__array__t.html">ble::oob_confirm_t</a> *confirm);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span> <span class="preprocessor">#endif // BLE_FEATURE_SECURE_CONNECTIONS</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span> <span class="comment"></span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span> <span class="comment"></span>    <span class="comment">// Keys</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>     <span class="comment">//</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span> </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span> <span class="preprocessor">#if BLE_FEATURE_SIGNING</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span> <span class="comment">    /**</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span> <span class="comment">     * Retrieves a signing key through a signingKey event.</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span> <span class="comment">     * If a signing key is not present, pairing/authentication will be attempted.</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span> <span class="comment">     * @note This will attempt to retrieve the key even if enableSigning hasn't been called prior to pairing.</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span> <span class="comment">     *</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span> <span class="comment">     * @param[in] connectionHandle Handle to identify the connection.</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span> <span class="comment">     * @param[in] authenticated    Whether the signing key needs to be authenticated</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span> <span class="comment">     *                             (provide MITM protection).</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span> <span class="comment">     *</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span> <span class="comment">     *</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span> <span class="comment">     * @see EventHandler::signingKey()</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span> <span class="comment">     */</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> getSigningKey(<a class="code" href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a> connectionHandle, <span class="keywordtype">bool</span> authenticated);</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span> <span class="preprocessor">#endif // BLE_FEATURE_SIGNING</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span> <span class="comment"></span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span> <span class="comment">    ////////////////////////////////////////////////////////////////////////////</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span> <span class="comment"></span>    <span class="comment">// Privacy</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>     <span class="comment">//</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span> </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span> <span class="preprocessor">#if BLE_FEATURE_PRIVACY</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span> <span class="comment">    /**</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span> <span class="comment">     * Sets how often the address is rotated when privacy is enabled.</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span> <span class="comment">     *</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span> <span class="comment">     * @param[in] timeout_in_seconds How many seconds to wait before starting generation of a new address.</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span> <span class="comment">     *</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span> <span class="comment">     * @return BLE_ERROR_NONE or appropriate error code indicating the failure reason.</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span> <span class="comment">     */</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>     <a class="code" href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a> setPrivateAddressTimeout(</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>         uint16_t timeout_in_seconds</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>     );</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span> <span class="preprocessor">#endif // BLE_FEATURE_PRIVACY</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span> </div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>     <span class="comment">/* Event callback handlers. */</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span> <span class="keyword">public</span>:<span class="comment"></span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span> <span class="comment">    /**</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span> <span class="comment">     * Setup a callback to be invoked to notify the user application that the</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span> <span class="comment">     * SecurityManager instance is about to shutdown (possibly as a result of a call</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span> <span class="comment">     * to BLE::shutdown()).</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span> <span class="comment">     *</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span> <span class="comment">     * @note  It is possible to chain together multiple onShutdown callbacks</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span> <span class="comment">     * (potentially from different modules of an application) to be notified</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span> <span class="comment">     * before the SecurityManager is shutdown.</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span> <span class="comment">     *</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span> <span class="comment">     * @note  It is also possible to set up a callback into a member function of</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span> <span class="comment">     * some object.</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span> <span class="comment">     *</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span> <span class="comment">     * @note It is possible to unregister a callback using onShutdown().detach(callback)</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span> <span class="comment">     */</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>     <span class="keywordtype">void</span> onShutdown(<span class="keyword">const</span> SecurityManagerShutdownCallback_t&amp; <a class="code" href="group__platform___callback.html#ga1104a807bfce1d1dc38e4d1eeba6ed17">callback</a>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span> </div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>     <span class="keywordtype">void</span> onShutdown(T *objPtr, <span class="keywordtype">void</span> (T::*memberPtr)(<span class="keyword">const</span> <a class="code" href="classble_1_1_security_manager.html">SecurityManager</a> *))</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>     {</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>         onShutdown({objPtr, memberPtr});</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>     }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span> <span class="comment"></span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span> <span class="comment">    /**</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span> <span class="comment">     * Provide access to the callchain of shutdown event callbacks.</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span> <span class="comment">     * It is possible to register callbacks using onShutdown().add(callback).</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span> <span class="comment">     * It is possible to unregister callbacks using onShutdown().detach(callback).</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span> <span class="comment">     *</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span> <span class="comment">     * @return The shutdown event callbacks chain</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span> <span class="comment">     */</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>     SecurityManagerShutdownCallbackChain_t&amp; onShutdown();</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span> <span class="comment"></span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span> <span class="comment">    /**</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span> <span class="comment">     * Assign the event handler implementation that will be used by the stack to signal events</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span> <span class="comment">     * back to the application.</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span> <span class="comment">     *</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span> <span class="comment">     * @param[in] handler Event Handler interface implementation.</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span> <span class="comment">     */</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>     <span class="keywordtype">void</span> setSecurityManagerEventHandler(<a class="code" href="classble_1_1_security_manager_1_1_event_handler.html">EventHandler</a>* handler);</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span> </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span> <span class="keyword">public</span>:</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span> <span class="preprocessor">#if !defined(DOXYGEN_ONLY)</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span> <span class="comment">    /** For backwards compatibility. This enum is now in BLETypes.h</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span> <span class="comment">     * @deprecated use the enum in ble namespace */</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>     <span class="keyword">typedef</span> <a class="code" href="namespaceble.html#ad795c6b00632415eb3f54a1115b81653">ble::Keypress_t</a> <a class="code" href="namespaceble.html#ad795c6b00632415eb3f54a1115b81653">Keypress_t</a>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span> </div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>     <a class="code" href="classble_1_1_security_manager.html">SecurityManager</a>(impl::SecurityManager* impl) : impl(impl) {}</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>     <a class="code" href="classble_1_1_security_manager.html">SecurityManager</a>(<span class="keyword">const</span> <a class="code" href="classble_1_1_security_manager.html">SecurityManager</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>     <a class="code" href="classble_1_1_security_manager.html">SecurityManager</a>&amp; operator=(<span class="keyword">const</span> <a class="code" href="classble_1_1_security_manager.html">SecurityManager</a>&amp;) = <span class="keyword">delete</span>;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span> <span class="preprocessor">#endif // !defined(DOXYGEN_ONLY)</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span> </div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span> <span class="keyword">private</span>:</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>     impl::SecurityManager *impl;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span> };</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span> </div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span> } <span class="comment">// ble</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span> <span class="comment"></span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span> <span class="comment">/** @deprecated Use the namespaced ble::SecurityManager instead of the global SecurityManager. */</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span> <span class="keyword">using</span> <a class="code" href="classble_1_1_security_manager.html">ble::SecurityManager</a>;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span> </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span> <span class="preprocessor">#endif </span><span class="comment">/*BLE_SECURITY_MANAGER_H_*/</span><span class="preprocessor"></span></div><div class="ttc" id="class_function_pointer_with_context_html"><div class="ttname"><a href="class_function_pointer_with_context.html">FunctionPointerWithContext</a></div><div class="ttdoc">Function like object adapter over freestanding and member functions. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_function_pointer_with_context_8h_source.html#l00058">common/FunctionPointerWithContext.h:58</a></div></div>
<div class="ttc" id="namespaceble_html_af5f34d537045518aa5462a3d42a4b38f"><div class="ttname"><a href="namespaceble.html#af5f34d537045518aa5462a3d42a4b38f">ble::connection_handle_t</a></div><div class="ttdeci">uintptr_t connection_handle_t</div><div class="ttdoc">Opaque reference to a connection. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_b_l_e_types_8h_source.html#l00090">common/BLETypes.h:90</a></div></div>
<div class="ttc" id="structble_1_1byte__array__t_html"><div class="ttname"><a href="structble_1_1byte__array__t.html">ble::byte_array_t</a></div><div class="ttdoc">Model fixed size array values. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_b_l_e_types_8h_source.html#l00344">common/BLETypes.h:344</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a4c15d8354045b6d798b9f923b998c3b5"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a4c15d8354045b6d798b9f923b998c3b5">ble::SecurityManager::EventHandler::passkeyRequest</a></div><div class="ttdeci">virtual void passkeyRequest(ble::connection_handle_t connectionHandle)</div><div class="ttdoc">Indicate to the application that a passkey is required. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00386">SecurityManager.h:386</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_ae957cf4608b091de66d5b4275c2f2a07"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#ae957cf4608b091de66d5b4275c2f2a07">ble::SecurityManager::EventHandler::legacyPairingOobRequest</a></div><div class="ttdeci">virtual void legacyPairingOobRequest(ble::connection_handle_t connectionHandle)</div><div class="ttdoc">Indicate to the application it needs to return legacy pairing OOB to the stack using legacyPairingOob...</div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00415">SecurityManager.h:415</a></div></div>
<div class="ttc" id="namespaceble_html_ad795c6b00632415eb3f54a1115b81653"><div class="ttname"><a href="namespaceble.html#ad795c6b00632415eb3f54a1115b81653">ble::Keypress_t</a></div><div class="ttdeci">Keypress_t</div><div class="ttdoc">events sent and received when passkey is being entered </div><div class="ttdef"><b>Definition:</b> <a href="common_2_b_l_e_types_8h_source.html#l00910">common/BLETypes.h:910</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a972b7d01fcaced15c737ba994a824179ae1e001d842b41617ad21bc0a43cc061b"><div class="ttname"><a href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179ae1e001d842b41617ad21bc0a43cc061b">ble::SecurityManager::SECURITY_MODE_ENCRYPTION_NO_MITM</a></div><div class="ttdoc">Require encryption, but no MITM protection. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00196">SecurityManager.h:196</a></div></div>
<div class="ttc" id="structble_1_1whitelist__t_html"><div class="ttname"><a href="structble_1_1whitelist__t.html">ble::whitelist_t</a></div><div class="ttdoc">Representation of a whitelist of addresses. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_b_l_e_types_8h_source.html#l00849">common/BLETypes.h:849</a></div></div>
<div class="ttc" id="group__platform___callback_html_ga1104a807bfce1d1dc38e4d1eeba6ed17"><div class="ttname"><a href="group__platform___callback.html#ga1104a807bfce1d1dc38e4d1eeba6ed17">mbed::callback</a></div><div class="ttdeci">Callback&lt; R(ArgTs...)&gt; callback(R(*func)(ArgTs...)=nullptr) noexcept</div><div class="ttdoc">Create a callback class with type inferred from the arguments. </div><div class="ttdef"><b>Definition:</b> <a href="_callback_8h_source.html#l00678">Callback.h:678</a></div></div>
<div class="ttc" id="structble_1_1address__t_html"><div class="ttname"><a href="structble_1_1address__t.html">ble::address_t</a></div><div class="ttdoc">MAC address data type. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_b_l_e_types_8h_source.html#l00484">common/BLETypes.h:484</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_ad401e31302efa266bf13b60d3d1bf8dc"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#ad401e31302efa266bf13b60d3d1bf8dc">ble::SecurityManager::EventHandler::pairingRequest</a></div><div class="ttdeci">virtual void pairingRequest(ble::connection_handle_t connectionHandle)</div><div class="ttdoc">Called when a pairing request is received. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00264">SecurityManager.h:264</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html"><div class="ttname"><a href="classble_1_1_security_manager.html">ble::SecurityManager</a></div><div class="ttdoc">Overview. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00189">SecurityManager.h:189</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a972b7d01fcaced15c737ba994a824179a7f0c035d71f2d8581de2b2e4f489cd6c"><div class="ttname"><a href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a7f0c035d71f2d8581de2b2e4f489cd6c">ble::SecurityManager::SECURITY_MODE_ENCRYPTION_OPEN_LINK</a></div><div class="ttdoc">Require no protection, open link. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00195">SecurityManager.h:195</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a068ce5188b3d0175e6fcdb5b04b76356"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a068ce5188b3d0175e6fcdb5b04b76356">ble::SecurityManager::EventHandler::whitelistFromBondTable</a></div><div class="ttdeci">virtual void whitelistFromBondTable(::ble::whitelist_t *whitelist)</div><div class="ttdoc">Deliver the requested whitelist to the application. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00312">SecurityManager.h:312</a></div></div>
<div class="ttc" id="structble_1_1link__encryption__t_html"><div class="ttname"><a href="structble_1_1link__encryption__t.html">ble::link_encryption_t</a></div><div class="ttdoc">Type that describes link&amp;#39;s encryption state. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_b_l_e_types_8h_source.html#l00172">common/BLETypes.h:172</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a972b7d01fcaced15c737ba994a824179"><div class="ttname"><a href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179">ble::SecurityManager::SecurityMode_t</a></div><div class="ttdeci">SecurityMode_t</div><div class="ttdoc">level of security required from the link by the application </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00193">SecurityManager.h:193</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a972b7d01fcaced15c737ba994a824179a2462fe750331b4a1c9a1d617c1642328"><div class="ttname"><a href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a2462fe750331b4a1c9a1d617c1642328">ble::SecurityManager::SECURITY_MODE_SIGNED_NO_MITM</a></div><div class="ttdoc">Require signing or encryption, but no MITM protection. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00198">SecurityManager.h:198</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a586672c6d6a27a6f033cc48bdf478c65"><div class="ttname"><a href="classble_1_1_security_manager.html#a586672c6d6a27a6f033cc48bdf478c65">ble::SecurityManager::SecurityIOCapabilities_t</a></div><div class="ttdeci">SecurityIOCapabilities_t</div><div class="ttdoc">Input/output capability of the device and application. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00203">SecurityManager.h:203</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a50b701c84896761ad31cd8ed70fdd6d0"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a50b701c84896761ad31cd8ed70fdd6d0">ble::SecurityManager::EventHandler::keypressNotification</a></div><div class="ttdeci">virtual void keypressNotification(ble::connection_handle_t connectionHandle, ble::Keypress_t keypress)</div><div class="ttdoc">Notify the application that a key was pressed by the peer during passkey entry. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00401">SecurityManager.h:401</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a972b7d01fcaced15c737ba994a824179a9a201e6c6592a963f9c5c597ecb5cfe8"><div class="ttname"><a href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179a9a201e6c6592a963f9c5c597ecb5cfe8">ble::SecurityManager::SECURITY_MODE_SIGNED_WITH_MITM</a></div><div class="ttdoc">Require signing or encryption, and MITM protection. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00199">SecurityManager.h:199</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a1aeff70cff4bdbc80c2d7bf2f7090bd3"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a1aeff70cff4bdbc80c2d7bf2f7090bd3">ble::SecurityManager::EventHandler::oobGenerated</a></div><div class="ttdeci">virtual void oobGenerated(const ble::address_t *address, const ble::oob_lesc_value_t *random, const ble::oob_confirm_t *confirm)</div><div class="ttdoc">Indicate that the application needs to send secure connections OOB data to the peer. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00442">SecurityManager.h:442</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a972b7d01fcaced15c737ba994a824179ad2fa88a39cea0e1082ece66ad26a32c1"><div class="ttname"><a href="classble_1_1_security_manager.html#a972b7d01fcaced15c737ba994a824179ad2fa88a39cea0e1082ece66ad26a32c1">ble::SecurityManager::SECURITY_MODE_ENCRYPTION_WITH_MITM</a></div><div class="ttdoc">Require encryption and MITM protection. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00197">SecurityManager.h:197</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a11d05969cbd7e7f0d81fbe71d382b004"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a11d05969cbd7e7f0d81fbe71d382b004">ble::SecurityManager::EventHandler::linkEncryptionResult</a></div><div class="ttdeci">virtual void linkEncryptionResult(ble::connection_handle_t connectionHandle, ble::link_encryption_t result)</div><div class="ttdoc">Triggered by change of encryption state on a link. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00330">SecurityManager.h:330</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_html_a686cd5fd54600e2376ac36ed86688d8c"><div class="ttname"><a href="classble_1_1_security_manager.html#a686cd5fd54600e2376ac36ed86688d8c">ble::SecurityManager::SecurityCompletionStatus_t</a></div><div class="ttdeci">SecurityCompletionStatus_t</div><div class="ttdoc">Result of security requests. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00212">SecurityManager.h:212</a></div></div>
<div class="ttc" id="class_call_chain_of_function_pointers_with_context_html"><div class="ttname"><a href="class_call_chain_of_function_pointers_with_context.html">CallChainOfFunctionPointersWithContext</a></div><div class="ttdoc">Function like object hosting a list of FunctionPointerWithContext. </div><div class="ttdef"><b>Definition:</b> <a href="common_2_call_chain_of_function_pointers_with_context_8h_source.html#l00085">common/CallChainOfFunctionPointersWithContext.h:85</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_aaed95f977e596014008b063130fb9eff"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#aaed95f977e596014008b063130fb9eff">ble::SecurityManager::EventHandler::legacyPairingOobGenerated</a></div><div class="ttdeci">virtual void legacyPairingOobGenerated(const ble::address_t *address, const ble::oob_tk_t *temporaryKey)</div><div class="ttdoc">Indicate that the application needs to send legacy pairing OOB data to the peer through another commu...</div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00426">SecurityManager.h:426</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a2763a67f9155c3e4f209599ea29654cd"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a2763a67f9155c3e4f209599ea29654cd">ble::SecurityManager::EventHandler::signingKey</a></div><div class="ttdeci">virtual void signingKey(ble::connection_handle_t connectionHandle, const ble::csrk_t *csrk, bool authenticated)</div><div class="ttdoc">Deliver the signing key to the application. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00464">SecurityManager.h:464</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a41a793961bdc2e09abe735287423c40e"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a41a793961bdc2e09abe735287423c40e">ble::SecurityManager::EventHandler::pairingResult</a></div><div class="ttdeci">virtual void pairingResult(ble::connection_handle_t connectionHandle, SecurityCompletionStatus_t result)</div><div class="ttdoc">Indicate to the application that pairing has completed. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00278">SecurityManager.h:278</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html">ble::SecurityManager::EventHandler</a></div><div class="ttdoc">The stack will use these functions to signal events to the application, subclass to override handlers...</div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00244">SecurityManager.h:244</a></div></div>
<div class="ttc" id="namespaceble_html"><div class="ttname"><a href="namespaceble.html">ble</a></div><div class="ttdoc">Entry namespace for all BLE API definitions. </div><div class="ttdef"><b>Definition:</b> <a href="_cy_h4_transport_driver_8h_source.html#l00034">CyH4TransportDriver.h:34</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_afd3906e75c4bc4d7e6aae5e27288758a"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#afd3906e75c4bc4d7e6aae5e27288758a">ble::SecurityManager::EventHandler::peerIdentity</a></div><div class="ttdeci">virtual void peerIdentity(ble::connection_handle_t connectionHandle, const address_t *peer_address, bool address_is_public)</div><div class="ttdoc">Indicate that a peer address has been saved by the security manager or if we are bonded to the peer t...</div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00293">SecurityManager.h:293</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a2454fd5afbe95c69b67936855bf0219d"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a2454fd5afbe95c69b67936855bf0219d">ble::SecurityManager::EventHandler::passkeyDisplay</a></div><div class="ttdeci">virtual void passkeyDisplay(ble::connection_handle_t connectionHandle, const Passkey_t passkey)</div><div class="ttdoc">Triggered during pairing based on IO capabilities of devices. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00352">SecurityManager.h:352</a></div></div>
<div class="ttc" id="group__platform__toolchain_html_ga2822a5c443e30d9fff9c591743ac616d"><div class="ttname"><a href="group__platform__toolchain.html#ga2822a5c443e30d9fff9c591743ac616d">MBED_DEPRECATED_SINCE</a></div><div class="ttdeci">#define MBED_DEPRECATED_SINCE(D, M)</div><div class="ttdoc">MBED_DEPRECATED("message string") Mark a function declaration as deprecated, if it used then a warnin...</div><div class="ttdef"><b>Definition:</b> <a href="mbed__toolchain_8h_source.html#l00429">mbed_toolchain.h:429</a></div></div>
<div class="ttc" id="classble_1_1_security_manager_1_1_event_handler_html_a566a9f17c6b055994ce993623845b0e8"><div class="ttname"><a href="classble_1_1_security_manager_1_1_event_handler.html#a566a9f17c6b055994ce993623845b0e8">ble::SecurityManager::EventHandler::confirmationRequest</a></div><div class="ttdeci">virtual void confirmationRequest(ble::connection_handle_t connectionHandle)</div><div class="ttdoc">Indicate to the application that a confirmation is required. </div><div class="ttdef"><b>Definition:</b> <a href="_security_manager_8h_source.html#l00371">SecurityManager.h:371</a></div></div>
<div class="ttc" id="group__common_html_ga6fb48b8f40e280c30d2ae3bd0c3712c4"><div class="ttname"><a href="group__common.html#ga6fb48b8f40e280c30d2ae3bd0c3712c4">ble_error_t</a></div><div class="ttdeci">ble_error_t</div><div class="ttdoc">Error codes for the BLE API. </div><div class="ttdef"><b>Definition:</b> <a href="common_2blecommon_8h_source.html#l00149">common/blecommon.h:149</a></div></div>
</div><!-- fragment --></div><!-- contents -->
        
    


        
<footer class="global-footer">
    <ul class="global-footer-media global-footer-row">
        <li>
            <a class="footer-media-icon" title="Twitter" href="https://twitter.com/ArmSoftwareDev">
                <span class="fab fa-twitter-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Twitter</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="YouTube" href="https://www.youtube.com/c/ArmSoftwareDevelopers">
                <span class="fab fa-youtube-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">YouTube</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Forum" href="http://forums.mbed.com/">
                <span class="fas fa-comments fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Forum</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Blog" href="http://blog.mbed.com/">
                <span class="fas fa-pen-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Blog</span>
            </a>
        </li>
    </ul>

    <div class="global-footer-copyright global-footer-row">
        <div class="copyright-statement">Copyright © <script>document.write(new Date().getFullYear());</script> Arm Limited (or its affiliates).</div>
        <ul class="copyright-links">
            <li><a href="https://os.mbed.com/">Home</a></li>
            <li><a href="https://www.arm.com/company/policies/terms-and-conditions">Website Terms</a></li>
            <li><a href="https://www.arm.com/company/policies/privacy">Privacy</a></li>
            <li><a href="https://www.arm.com/company/policies/cookies">Cookies</a></li>
            <li><a href="http://www.arm.com/company/policies/trademarks">Trademarks</a></li>
        </ul>
    </div>
</footer>



    <div id="cookiemodule">
    <h5>Important Information for this Arm website</h5>
    <div id="cookiecontent">
        <p>
            This site uses cookies to store information on your computer.
            By continuing to use our site, you consent to our cookies.
            If you are not happy with the use of these cookies, please review our
            <a href="https://www.arm.com/company/policies/cookies">Cookie Policy</a>
            to learn how they can be disabled.
            By disabling cookies, some features of the site will not work.
        </p>
        <button id="acceptcookie">Accept and hide this message</button>
    </div>
</div>
<script src="../../../../static/js/cookie_law.js"></script>




    </body>

<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_security_manager_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:28:06 GMT -->
</html>
