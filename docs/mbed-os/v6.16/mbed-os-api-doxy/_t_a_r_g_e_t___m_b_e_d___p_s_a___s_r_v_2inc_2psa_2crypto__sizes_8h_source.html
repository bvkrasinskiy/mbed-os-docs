<!DOCTYPE html>
<html>
    
<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__sizes_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:22:32 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        
        <meta charset="utf-8"/>
        <title>Mbed OS Reference | crypto_sizes.h Source File</title>
        <link href="../static/css/vendor/foundation-6.2.4.min.mbed-cache-4c48f6c816971070eb1e4eca75f0ec30.css" rel="stylesheet"/>
        <link href="search/search.css" rel="stylesheet"/>
        <link href="../static/css/app.mbed-cache-a44289fe9f5ca07036a335d6ad7ed8ad.css" rel="stylesheet"/>
        <script src="../static/js/vendor/jquery-3.2.1.min.mbed-cache-c9f5aeeca3ad37bf2aa006139b935f0a.js"></script>
        <script src="dynsections.js"></script>
        <script src="search/searchdata.js"></script>
        <script src="search/search.js"></script>
        <script>
            $(document).ready(function() {
                init_search();
            });
        </script>
    
        

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1447836-8');
ga('require', 'GTM-WXMLD4S')
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl+'&gtm_auth=SMYNPwM0ICsV00c1ZHETqQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M6FZ495');</script>


    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:971746,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>



<!-- Favicons -->
<link rel="apple-touch-icon" sizes="57x57" href="../../../../static/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../../static/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../../static/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../../static/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../../static/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../../static/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../../../static/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../../../static/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../../../static/img/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../../../static/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../static/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../../../static/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../static/img/favicons/favicon-16x16.png">
<link rel="manifest" href="https://os.mbed.com/static/img/favicons/manifest.json">
<link rel="shortcut icon" href="https://os.mbed.com/static/img/favicon.ico?">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">

<link rel="stylesheet" href="../../../../static/CACHE/css/output.811e2930ab34.css" type="text/css">

<link href="../../../../static/docs/css/doc_viewer.css" rel="stylesheet">
<link href="../../../../static/fonts.css" rel="stylesheet">
<link href="../../../../static/docs-nav-and-footer1b26.css?v2" rel="stylesheet">


<link rel="canonical" href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__sizes_8h_source.html">
<script src="../../../../static/mbed-nav-vertical-menu.js"></script>


    </head>
    <body>
        








<div class="mbed-nav">
    <div class="mbed-nav__mobile-menu-control">
        <i class="mbed-nav__mobile-menu-control-open fas fa-bars fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-close fas fa-times is-hidden fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-back fas fa-angle-left is-hidden fa-fw"></i>
    </div>
    <div class="mbed-nav__logo">
        <a href="https://os.mbed.com/">
            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#logo"></use></svg>
        </a>
    </div>
    <div class="mbed-nav__menu">

        <!-- Main menu -->
        <nav class="mbed-nav__main-menu">
            <ul class="mbed-nav__dropdown-menu">
                <li class="has-dropdown">
                    Overview

                    <div class="mbed-nav__dropdown-menu-content">

                        <!-- Overview dropdown menu -->
                        <div class="mbed-nav__overview-menu">
                            <section>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <div>
                                                <p>Mbed OS</p>
                                                <p>The open source OS for Cortex-M devices</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link-detail">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <div>
                                                <p>Keil Studio Cloud</p>
                                                <p>Arm's IDE for IoT, embedded and Mbed development</p>
                                            </div>
                                         </a>
                                     </li>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <div>
                                                <p>Mbed Studio</p>
                                                <p>Download the desktop IDE for Mbed OS</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link-detail">

                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <div>
                                               <p>Mbed CLI</p>
                                               <p>Command line access to Mbed tools and services</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Security and Connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <div>
                                                <p>Mbed TLS and Mbed Crypto</p>
                                                <p>Industry standard TLS stack and crypto library</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <div>
                                                <p>Connectivity</p>
                                                <p>BLE, WiFi, Cellular, LoRaWAN and more</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </li>
                <li class="has-dropdown">
                    Hardware

                    <!-- Hardware dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__hardware-dropdown">
                            <ul class="mbed-nav__hardware-menu">
                                <li>
                                    <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                        <div>
                                            <p>Boards</p>
                                            <p>Build your Mbed projects with development boards for Arm Cortex processors and MCUs</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                        <div>
                                            <p>Modules</p>
                                            <p>Modules include a MCU, connectivity and onboard memory, making them ideal for designing IoT products for mass production</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                        <div>
                                            <p>Components</p>
                                            <p>The component database hosts libraries for different sensors, actuators, radios, inputs, middleware and IoT services</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                        <div>
                                            <p>Hardware overview & Mbed Enabled</p>
                                            <p>Learn about hardware support for Mbed, as well as the Mbed Enabled program, which identifies Mbed compatible products</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                        <div>
                                            <p>Mbed HDK</p>
                                            <p>Reference designs, schematics and board layouts to develop production hardware and Mbed-compatible development boards</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li class="has-dropdown">
                    Documentation

                    <!-- Documentation dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__documentation-dropdown">
                            <ul class="mbed-nav__documentation-menu">
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a>
                                </li>
                                <li>
                                    <a
                                        href="https://developer.arm.com/documentation/102497/latest/Arm-Keil-Studio-Cloud">
                                        Keil Studio
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li class="has-dropdown">
                    Community

                    <!-- Community dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__community-dropdown">
                            <ul class="mbed-nav__community-menu">
                                <li>
                                    <a href="https://forums.mbed.com/">Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a>
                                </li>
                                <li>
                                    <a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/support/">Report a problem</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://os.mbed.com/blog/">Blog</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="mbed-nav__user-controls">
        <div class="mbed-nav__user-controls-top">
            <div class="mbed-nav__search">
                <form id="mbed-nav__search-box" class="is-hidden" action="https://os.mbed.com/search" method="GET">
                    <div class="mbed-nav__search-box">
                        <input type="search" name="q" placeholder="Search...">
                        <button type="submit">
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                        </button>
                    </div>
                </form>
                <i class="mbed-nav__search-close fas fa-times is-hidden"></i>
                <svg class="mbed-nav__search-open stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
            </div>
            <a class="mbed-nav__cta" href="https://studio.keil.arm.com/mbed" target="_blank">
                Keil Studio Cloud
            </a>

            
                
                <nav class="mbed-nav__logged-out-nav">
                    <ul class="mbed-nav__dropdown-menu">
                        <li>
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#profile"></use></svg>

                            <!-- Logged out dropdown menu -->
                            <div class="mbed-nav__dropdown-menu-content">
                                <div class="mbed-nav__logged-out-dropdown">
                                    <ul class="mbed-nav__logged-out-menu">
                                        <li><a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__sizes_8h_source.html">Log in or Sign up</a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </nav>
                
            
        </div>
    </div>
    <div class="mbed-nav__spacer"></div>
</div>
<div class="mbed-nav__mobile-menu-cover is-hidden">
    <div class="mbed-nav__mobile-menu">

        <div id="mbed-nav__main-menu-mobile">
            <div class="mbed-nav__user-controls-mobile">
                <div class="mbed-nav__user-controls-top-mobile">
                    <form action="https://os.mbed.com/search" method="GET">
                        <div class="mbed-nav__search-box mbed-nav__search-box--light">
                            <input type="search" name="q" placeholder="Search...">
                            <button type="submit">
                                <svg class="stroke-dark-grey"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                            </button>
                        </div>
                    </form>
                    
                        
                        <a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__sizes_8h_source.html">Log in or Sign up</a>
                        
                    
                </div>
            </div>

            <ul class="mbed-nav__side-menu">
                <li>
                    <input type="checkbox" name="accordion-toggle" id="overview-accordion">
                    <label for="overview-accordion">Overview</label>
                    <div class="accordion_content">
                        <ul class="overview-menu-mobile">
                            <li>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <p>Mbed OS</p>
                                        </a>
                                    </li>
                                    

                                </ul>
                            </li>
                            <li>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <p>Mbed Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <p>Keil Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <p>Mbed CLI</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Security and connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <p>Mbed TLS and Mbed Crypto</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <p>Connectivity</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="hardware-accordion">
                    <label for="hardware-accordion">Hardware</label>
                    <div class="accordion_content">
                        <ul>
                            <li>
                                <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                    <p>Boards</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                    <p>Modules</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                    <p>Components</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                    <p>Hardware overview & Mbed Enabled</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                    <p>Mbed HDK</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="documentation-accordion">
                    <label for="documentation-accordion">Documentation</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a></li>
                            <li>
                              <a
                                href="https://developer.arm.com/documentation/102497/1-5/Arm-Keil-Studio/?utm_source=mbed_com&amp;utm_medium=nav_docs_link&amp;utm_campaign=mbed_com_promo">
                                Keil Studio
                              </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="community-accordion">
                    <label for="community-accordion">Community</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://forums.mbed.com/">Forum</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a></li>
                            <li><a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a></li>
                            <li><a href="https://os.mbed.com/support/">Report a problem</a></li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/blog/">Blog</a></li>
            </ul>
        </div>

        
    </div>
</div>



<div class="version-picker-container">
    
    <select class="version-picker" onchange="goToVersion(this.value)">
        
            <option
                value="v6.16"
                selected
            >
                v6.16
            </option>
        
            <option
                value="v6.15"
                
            >
                v6.15
            </option>
        
            <option
                value="v6.14"
                
            >
                v6.14
            </option>
        
            <option
                value="v6.13"
                
            >
                v6.13
            </option>
        
            <option
                value="v6.12"
                
            >
                v6.12
            </option>
        
            <option
                value="v6.11"
                
            >
                v6.11
            </option>
        
            <option
                value="v6.10"
                
            >
                v6.10
            </option>
        
            <option
                value="v6.9"
                
            >
                v6.9
            </option>
        
            <option
                value="v6.8"
                
            >
                v6.8
            </option>
        
            <option
                value="v6.7"
                
            >
                v6.7
            </option>
        
            <option
                value="v6.6"
                
            >
                v6.6
            </option>
        
            <option
                value="v6.5"
                
            >
                v6.5
            </option>
        
            <option
                value="v5.15"
                
            >
                v5.15
            </option>
        
    </select>
    

    <div class="contact-us">
        Mistake on this page?
        
            <br>
            <a href="https://github.com/ARMmbed/mbed-os-5-docs/issues">
                Report an issue in GitHub
                <i class="fab fa-github"></i>
            </a>
            or
            <a href="mailto:mbed-support@arm.com">
                email us
                <i class="fas fa-envelope"></i>
            </a>
        
    </div>
</div>

<script>
    function goToVersion(version) {
        window.location.href = window.location.href.replace(
            "v6.16",
            version
        )
    }
</script>

        
        <div class="topbar" id="top">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div class="tabs" id="navrow1">
    <ul class="tablist">
      <li><a href="index.html"><span>Main Page</span></a></li>
      <li><a href="pages.html"><span>Related Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div class="MSearchBoxInactive" id="MSearchBox">
        <span class="left">
          <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png"/>
          <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
          </span><span class="right">
            <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png"/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2" id="navrow2">
    <ul class="tablist">
      <li><a href="files.html"><span>File List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="navpath" id="nav-path">
  <ul>
<li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_d00fafdb9414f6e624fcf4d73ffde065.html">platform</a></li><li class="navelem"><a class="el" href="dir_a72924067aea8bbead751f11070268f4.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_007a19531d3d09289f9f9c2cf309e91b.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_05e0d8a557d855fa23572451f1c8ea18.html">TARGET_MBED_PSA_SRV</a></li><li class="navelem"><a class="el" href="dir_4873970fac28857be75ffc795d800217.html">inc</a></li><li class="navelem"><a class="el" href="dir_8dc47cca0505aa6837fa09ab8303288c.html">psa</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TARGET_MBED_PSA_SRV/inc/psa/crypto_sizes.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> <span class="comment">/**</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> <span class="comment"> * \file psa/crypto_sizes.h</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span> <span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span> <span class="comment"> * \brief PSA cryptography module: Mbed TLS buffer size macros</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span> <span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span> <span class="comment"> * \note This file may not be included directly. Applications must</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span> <span class="comment"> * include psa/crypto.h.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span> <span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span> <span class="comment"> * This file contains the definitions of macros that are useful to</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span> <span class="comment"> * compute buffer sizes. The signatures and semantics of these macros</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span> <span class="comment"> * are standardized, but the definitions are not, because they depend on</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span> <span class="comment"> * the available algorithms and, in some cases, on permitted tolerances</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span> <span class="comment"> * on buffer sizes.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span> <span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span> <span class="comment"> * In implementations with isolation between the application and the</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span> <span class="comment"> * cryptography module, implementers should take care to ensure that</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span> <span class="comment"> * the definitions that are exposed to applications match what the</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span> <span class="comment"> * module implements.</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span> <span class="comment"> *</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span> <span class="comment"> * Macros that compute sizes whose values do not depend on the</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span> <span class="comment"> * implementation are in crypto.h.</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span> <span class="comment"> */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span> <span class="comment">/*</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span> <span class="comment"> *  Copyright The Mbed TLS Contributors</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span> <span class="comment"> *  SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span> <span class="comment"> *</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span> <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the "License"); you may</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span> <span class="comment"> *  not use this file except in compliance with the License.</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span> <span class="comment"> *  You may obtain a copy of the License at</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span> <span class="comment"> *</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span> <span class="comment"> *  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span> <span class="comment"> *</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span> <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span> <span class="comment"> *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span> <span class="comment"> *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span> <span class="comment"> *  See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span> <span class="comment"> *  limitations under the License.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span> <span class="comment"> */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span> </div><div class="line"><a name="l00040"></a><span class="lineno">   40</span> <span class="preprocessor">#ifndef PSA_CRYPTO_SIZES_H</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span> <span class="preprocessor">#define PSA_CRYPTO_SIZES_H</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span> </div><div class="line"><a name="l00043"></a><span class="lineno">   43</span> <span class="comment">/* Include the Mbed TLS configuration file, the way Mbed TLS does it</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span> <span class="comment"> * in each of its header files. */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span> <span class="preprocessor">#if !defined(MBEDTLS_CONFIG_FILE)</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span> <span class="preprocessor">#include "mbedtls/config.h"</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span> <span class="preprocessor">#else</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span> <span class="preprocessor">#include MBEDTLS_CONFIG_FILE</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span> </div><div class="line"><a name="l00051"></a><span class="lineno">   51</span> <span class="preprocessor">#define PSA_BITS_TO_BYTES(bits) (((bits) + 7) / 8)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span> <span class="preprocessor">#define PSA_BYTES_TO_BITS(bytes) ((bytes) * 8)</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span> </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span> <span class="preprocessor">#define PSA_ROUND_UP_TO_MULTIPLE(block_size, length) \</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span> <span class="preprocessor">    (((length) + (block_size) - 1) / (block_size) * (block_size))</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span> <span class="comment"></span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span> <span class="comment">/** The size of the output of psa_hash_finish(), in bytes.</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span> <span class="comment"> *</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span> <span class="comment"> * This is also the hash size that psa_hash_verify() expects.</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span> <span class="comment"> *</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span> <span class="comment"> * \param alg   A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span> <span class="comment"> *              #PSA_ALG_IS_HASH(\p alg) is true), or an HMAC algorithm</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span> <span class="comment"> *              (#PSA_ALG_HMAC(\c hash_alg) where \c hash_alg is a</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span> <span class="comment"> *              hash algorithm).</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span> <span class="comment"> *</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span> <span class="comment"> * \return The hash size for the specified hash algorithm.</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span> <span class="comment"> *         If the hash algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span> <span class="comment"> *         An implementation may return either 0 or the correct size</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span> <span class="comment"> *         for a hash algorithm that it recognizes, but does not support.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span> <span class="comment"> */</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span> <span class="preprocessor">#define PSA_HASH_SIZE(alg)                                      \</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span> <span class="preprocessor">    (                                                           \</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_MD2 ? 16 :            \</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_MD4 ? 16 :            \</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_MD5 ? 16 :            \</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_RIPEMD160 ? 20 :      \</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_1 ? 20 :          \</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_224 ? 28 :        \</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_256 ? 32 :        \</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_384 ? 48 :        \</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_512 ? 64 :        \</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_512_224 ? 28 :    \</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA_512_256 ? 32 :    \</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA3_224 ? 28 :       \</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA3_256 ? 32 :       \</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA3_384 ? 48 :       \</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span> <span class="preprocessor">        PSA_ALG_HMAC_GET_HASH(alg) == PSA_ALG_SHA3_512 ? 64 :       \</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span> <span class="preprocessor">        0)</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span> <span class="comment"></span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span> <span class="comment">/** \def PSA_HASH_MAX_SIZE</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span> <span class="comment"> *</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span> <span class="comment"> * Maximum size of a hash.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span> <span class="comment"> *</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span> <span class="comment"> * This macro must expand to a compile-time constant integer. This value</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span> <span class="comment"> * should be the maximum size of a hash supported by the implementation,</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span> <span class="comment"> * in bytes, and must be no smaller than this maximum.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span> <span class="comment"> */</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span> <span class="comment">/* Note: for HMAC-SHA-3, the block size is 144 bytes for HMAC-SHA3-226,</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span> <span class="comment"> * 136 bytes for HMAC-SHA3-256, 104 bytes for SHA3-384, 72 bytes for</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span> <span class="comment"> * HMAC-SHA3-512. */</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span> <span class="preprocessor">#if defined(MBEDTLS_SHA512_C)</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span> <span class="preprocessor">#define PSA_HASH_MAX_SIZE 64</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span> <span class="preprocessor">#define PSA_HMAC_MAX_HASH_BLOCK_SIZE 128</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span> <span class="preprocessor">#else</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span> <span class="preprocessor">#define PSA_HASH_MAX_SIZE 32</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span> <span class="preprocessor">#define PSA_HMAC_MAX_HASH_BLOCK_SIZE 64</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span> <span class="comment"></span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span> <span class="comment">/** \def PSA_MAC_MAX_SIZE</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span> <span class="comment"> *</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span> <span class="comment"> * Maximum size of a MAC.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span> <span class="comment"> *</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span> <span class="comment"> * This macro must expand to a compile-time constant integer. This value</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span> <span class="comment"> * should be the maximum size of a MAC supported by the implementation,</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span> <span class="comment"> * in bytes, and must be no smaller than this maximum.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span> <span class="comment"> */</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span> <span class="comment">/* All non-HMAC MACs have a maximum size that's smaller than the</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span> <span class="comment"> * minimum possible value of PSA_HASH_MAX_SIZE in this implementation. */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span> <span class="comment">/* Note that the encoding of truncated MAC algorithms limits this value</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span> <span class="comment"> * to 64 bytes.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span> <span class="comment"> */</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span> <span class="preprocessor">#define PSA_MAC_MAX_SIZE PSA_HASH_MAX_SIZE</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span> <span class="comment"></span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span> <span class="comment">/** The tag size for an AEAD algorithm, in bytes.</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span> <span class="comment"> *</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span> <span class="comment"> * \param alg                 An AEAD algorithm</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span> <span class="comment"> *                            (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span> <span class="comment"> *                            #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span> <span class="comment"> *</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span> <span class="comment"> * \return                    The tag size for the specified algorithm.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span> <span class="comment"> *                            If the AEAD algorithm does not have an identified</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span> <span class="comment"> *                            tag that can be distinguished from the rest of</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span> <span class="comment"> *                            the ciphertext, return 0.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span> <span class="comment"> *                            If the AEAD algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span> <span class="comment"> *                            An implementation may return either 0 or a</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span> <span class="comment"> *                            correct size for an AEAD algorithm that it</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span> <span class="comment"> *                            recognizes, but does not support.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span> <span class="comment"> */</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span> <span class="preprocessor">#define PSA_AEAD_TAG_LENGTH(alg)                                        \</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span> <span class="preprocessor">    (PSA_ALG_IS_AEAD(alg) ?                                             \</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span> <span class="preprocessor">     (((alg) &amp; PSA_ALG_AEAD_TAG_LENGTH_MASK) &gt;&gt; PSA_AEAD_TAG_LENGTH_OFFSET) : \</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span> </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span> <span class="comment">/* The maximum size of an RSA key on this implementation, in bits.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span> <span class="comment"> * This is a vendor-specific macro.</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span> <span class="comment"> *</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span> <span class="comment"> * Mbed TLS does not set a hard limit on the size of RSA keys: any key</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span> <span class="comment"> * whose parameters fit in a bignum is accepted. However large keys can</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span> <span class="comment"> * induce a large memory usage and long computation times. Unlike other</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span> <span class="comment"> * auxiliary macros in this file and in crypto.h, which reflect how the</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span> <span class="comment"> * library is configured, this macro defines how the library is</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span> <span class="comment"> * configured. This implementation refuses to import or generate an</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span> <span class="comment"> * RSA key whose size is larger than the value defined here.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span> <span class="comment"> *</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span> <span class="comment"> * Note that an implementation may set different size limits for different</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span> <span class="comment"> * operations, and does not need to accept all key sizes up to the limit. */</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span> <span class="preprocessor">#define PSA_VENDOR_RSA_MAX_KEY_BITS 4096</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span> </div><div class="line"><a name="l00159"></a><span class="lineno">  159</span> <span class="comment">/* The maximum size of an ECC key on this implementation, in bits.</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span> <span class="comment"> * This is a vendor-specific macro. */</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span> <span class="preprocessor">#if defined(MBEDTLS_ECP_DP_SECP521R1_ENABLED)</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 521</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_BP512R1_ENABLED)</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 512</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_CURVE448_ENABLED)</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 448</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP384R1_ENABLED)</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 384</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_BP384R1_ENABLED)</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 384</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP256R1_ENABLED)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 256</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP256K1_ENABLED)</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 256</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_BP256R1_ENABLED)</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 256</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_CURVE25519_ENABLED)</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 255</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP224R1_ENABLED)</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 224</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP224K1_ENABLED)</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 224</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP192R1_ENABLED)</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 192</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span> <span class="preprocessor">#elif defined(MBEDTLS_ECP_DP_SECP192K1_ENABLED)</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 192</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span> <span class="preprocessor">#else</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span> <span class="preprocessor">#define PSA_VENDOR_ECC_MAX_CURVE_BITS 0</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span> <span class="comment"></span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span> <span class="comment">/** \def PSA_ALG_TLS12_PSK_TO_MS_MAX_PSK_LEN</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span> <span class="comment"> *</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span> <span class="comment"> * This macro returns the maximum length of the PSK supported</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span> <span class="comment"> * by the TLS-1.2 PSK-to-MS key derivation.</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span> <span class="comment"> *</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span> <span class="comment"> * Quoting RFC 4279, Sect 5.3:</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span> <span class="comment"> * TLS implementations supporting these ciphersuites MUST support</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span> <span class="comment"> * arbitrary PSK identities up to 128 octets in length, and arbitrary</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span> <span class="comment"> * PSKs up to 64 octets in length.  Supporting longer identities and</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span> <span class="comment"> * keys is RECOMMENDED.</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span> <span class="comment"> *</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span> <span class="comment"> * Therefore, no implementation should define a value smaller than 64</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span> <span class="comment"> * for #PSA_ALG_TLS12_PSK_TO_MS_MAX_PSK_LEN.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span> <span class="comment"> */</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span> <span class="preprocessor">#define PSA_ALG_TLS12_PSK_TO_MS_MAX_PSK_LEN 128</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span> <span class="comment"></span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span> <span class="comment">/** The maximum size of a block cipher supported by the implementation. */</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span> <span class="preprocessor">#define PSA_MAX_BLOCK_CIPHER_BLOCK_SIZE 16</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span> <span class="comment"></span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span> <span class="comment">/** The size of the output of psa_mac_sign_finish(), in bytes.</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span> <span class="comment"> *</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span> <span class="comment"> * This is also the MAC size that psa_mac_verify_finish() expects.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span> <span class="comment"> *</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span> <span class="comment"> * \param key_type      The type of the MAC key.</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span> <span class="comment"> * \param key_bits      The size of the MAC key in bits.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span> <span class="comment"> * \param alg           A MAC algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span> <span class="comment"> *                      #PSA_ALG_IS_MAC(\p alg) is true).</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span> <span class="comment"> *</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span> <span class="comment"> * \return              The MAC size for the specified algorithm with</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span> <span class="comment"> *                      the specified key parameters.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span> <span class="comment"> * \return              0 if the MAC algorithm is not recognized.</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span> <span class="comment"> * \return              Either 0 or the correct size for a MAC algorithm that</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span> <span class="comment"> *                      the implementation recognizes, but does not support.</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span> <span class="comment"> * \return              Unspecified if the key parameters are not consistent</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span> <span class="comment"> *                      with the algorithm.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span> <span class="comment"> */</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span> <span class="preprocessor">#define PSA_MAC_FINAL_SIZE(key_type, key_bits, alg)                     \</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span> <span class="preprocessor">    ((alg) &amp; PSA_ALG_MAC_TRUNCATION_MASK ? PSA_MAC_TRUNCATED_LENGTH(alg) : \</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span> <span class="preprocessor">     PSA_ALG_IS_HMAC(alg) ? PSA_HASH_SIZE(PSA_ALG_HMAC_GET_HASH(alg)) : \</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span> <span class="preprocessor">     PSA_ALG_IS_BLOCK_CIPHER_MAC(alg) ? PSA_BLOCK_CIPHER_BLOCK_SIZE(key_type) : \</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span> <span class="preprocessor">     ((void)(key_type), (void)(key_bits), 0))</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span> <span class="comment"></span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span> <span class="comment">/** The maximum size of the output of psa_aead_encrypt(), in bytes.</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span> <span class="comment"> *</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span> <span class="comment"> * If the size of the ciphertext buffer is at least this large, it is</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span> <span class="comment"> * guaranteed that psa_aead_encrypt() will not fail due to an</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span> <span class="comment"> * insufficient buffer size. Depending on the algorithm, the actual size of</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span> <span class="comment"> * the ciphertext may be smaller.</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span> <span class="comment"> *</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span> <span class="comment"> * \param alg                 An AEAD algorithm</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span> <span class="comment"> *                            (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span> <span class="comment"> *                            #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span> <span class="comment"> * \param plaintext_length    Size of the plaintext in bytes.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span> <span class="comment"> *</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span> <span class="comment"> * \return                    The AEAD ciphertext size for the specified</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span> <span class="comment"> *                            algorithm.</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span> <span class="comment"> *                            If the AEAD algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span> <span class="comment"> *                            An implementation may return either 0 or a</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span> <span class="comment"> *                            correct size for an AEAD algorithm that it</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span> <span class="comment"> *                            recognizes, but does not support.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span> <span class="comment"> */</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span> <span class="preprocessor">#define PSA_AEAD_ENCRYPT_OUTPUT_SIZE(alg, plaintext_length)       \</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span> <span class="preprocessor">    (PSA_AEAD_TAG_LENGTH(alg) != 0 ?                              \</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span> <span class="preprocessor">     (plaintext_length) + PSA_AEAD_TAG_LENGTH(alg) :              \</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span> <span class="comment"></span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span> <span class="comment">/** The maximum size of the output of psa_aead_decrypt(), in bytes.</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span> <span class="comment"> *</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span> <span class="comment"> * If the size of the plaintext buffer is at least this large, it is</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span> <span class="comment"> * guaranteed that psa_aead_decrypt() will not fail due to an</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span> <span class="comment"> * insufficient buffer size. Depending on the algorithm, the actual size of</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span> <span class="comment"> * the plaintext may be smaller.</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span> <span class="comment"> *</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span> <span class="comment"> * \param alg                 An AEAD algorithm</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span> <span class="comment"> *                            (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span> <span class="comment"> *                            #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span> <span class="comment"> * \param ciphertext_length   Size of the plaintext in bytes.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span> <span class="comment"> *</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span> <span class="comment"> * \return                    The AEAD ciphertext size for the specified</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span> <span class="comment"> *                            algorithm.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span> <span class="comment"> *                            If the AEAD algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span> <span class="comment"> *                            An implementation may return either 0 or a</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span> <span class="comment"> *                            correct size for an AEAD algorithm that it</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span> <span class="comment"> *                            recognizes, but does not support.</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span> <span class="comment"> */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span> <span class="preprocessor">#define PSA_AEAD_DECRYPT_OUTPUT_SIZE(alg, ciphertext_length)      \</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span> <span class="preprocessor">    (PSA_AEAD_TAG_LENGTH(alg) != 0 ?                              \</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span> <span class="preprocessor">     (ciphertext_length) - PSA_AEAD_TAG_LENGTH(alg) :             \</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span> <span class="comment"></span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span> <span class="comment">/** A sufficient output buffer size for psa_aead_update().</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span> <span class="comment"> *</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span> <span class="comment"> * If the size of the output buffer is at least this large, it is</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span> <span class="comment"> * guaranteed that psa_aead_update() will not fail due to an</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span> <span class="comment"> * insufficient buffer size. The actual size of the output may be smaller</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span> <span class="comment"> * in any given call.</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span> <span class="comment"> *</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span> <span class="comment"> * \param alg                 An AEAD algorithm</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span> <span class="comment"> *                            (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span> <span class="comment"> *                            #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span> <span class="comment"> * \param input_length        Size of the input in bytes.</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span> <span class="comment"> *</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span> <span class="comment"> * \return                    A sufficient output buffer size for the specified</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span> <span class="comment"> *                            algorithm.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span> <span class="comment"> *                            If the AEAD algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span> <span class="comment"> *                            An implementation may return either 0 or a</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span> <span class="comment"> *                            correct size for an AEAD algorithm that it</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span> <span class="comment"> *                            recognizes, but does not support.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span> <span class="comment"> */</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span> <span class="comment">/* For all the AEAD modes defined in this specification, it is possible</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span> <span class="comment"> * to emit output without delay. However, hardware may not always be</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span> <span class="comment"> * capable of this. So for modes based on a block cipher, allow the</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span> <span class="comment"> * implementation to delay the output until it has a full block. */</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span> <span class="preprocessor">#define PSA_AEAD_UPDATE_OUTPUT_SIZE(alg, input_length)                  \</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span> <span class="preprocessor">    (PSA_ALG_IS_AEAD_ON_BLOCK_CIPHER(alg) ?                             \</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span> <span class="preprocessor">     PSA_ROUND_UP_TO_MULTIPLE(PSA_MAX_BLOCK_CIPHER_BLOCK_SIZE, (input_length)) : \</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span> <span class="preprocessor">     (input_length))</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span> <span class="comment"></span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span> <span class="comment">/** A sufficient ciphertext buffer size for psa_aead_finish().</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span> <span class="comment"> *</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span> <span class="comment"> * If the size of the ciphertext buffer is at least this large, it is</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span> <span class="comment"> * guaranteed that psa_aead_finish() will not fail due to an</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span> <span class="comment"> * insufficient ciphertext buffer size. The actual size of the output may</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span> <span class="comment"> * be smaller in any given call.</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span> <span class="comment"> *</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span> <span class="comment"> * \param alg                 An AEAD algorithm</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span> <span class="comment"> *                            (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span> <span class="comment"> *                            #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span> <span class="comment"> *</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span> <span class="comment"> * \return                    A sufficient ciphertext buffer size for the</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span> <span class="comment"> *                            specified algorithm.</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span> <span class="comment"> *                            If the AEAD algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span> <span class="comment"> *                            An implementation may return either 0 or a</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span> <span class="comment"> *                            correct size for an AEAD algorithm that it</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span> <span class="comment"> *                            recognizes, but does not support.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span> <span class="comment"> */</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span> <span class="preprocessor">#define PSA_AEAD_FINISH_OUTPUT_SIZE(alg)                                \</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span> <span class="preprocessor">    (PSA_ALG_IS_AEAD_ON_BLOCK_CIPHER(alg) ?                             \</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span> <span class="preprocessor">     PSA_MAX_BLOCK_CIPHER_BLOCK_SIZE :                                  \</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span> <span class="comment"></span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span> <span class="comment">/** A sufficient plaintext buffer size for psa_aead_verify().</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span> <span class="comment"> *</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span> <span class="comment"> * If the size of the plaintext buffer is at least this large, it is</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span> <span class="comment"> * guaranteed that psa_aead_verify() will not fail due to an</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span> <span class="comment"> * insufficient plaintext buffer size. The actual size of the output may</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span> <span class="comment"> * be smaller in any given call.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span> <span class="comment"> *</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span> <span class="comment"> * \param alg                 An AEAD algorithm</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span> <span class="comment"> *                            (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span> <span class="comment"> *                            #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span> <span class="comment"> *</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span> <span class="comment"> * \return                    A sufficient plaintext buffer size for the</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span> <span class="comment"> *                            specified algorithm.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span> <span class="comment"> *                            If the AEAD algorithm is not recognized, return 0.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span> <span class="comment"> *                            An implementation may return either 0 or a</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span> <span class="comment"> *                            correct size for an AEAD algorithm that it</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span> <span class="comment"> *                            recognizes, but does not support.</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span> <span class="comment"> */</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span> <span class="preprocessor">#define PSA_AEAD_VERIFY_OUTPUT_SIZE(alg)                                \</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span> <span class="preprocessor">    (PSA_ALG_IS_AEAD_ON_BLOCK_CIPHER(alg) ?                             \</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span> <span class="preprocessor">     PSA_MAX_BLOCK_CIPHER_BLOCK_SIZE :                                  \</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span> </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span> <span class="preprocessor">#define PSA_RSA_MINIMUM_PADDING_SIZE(alg)                         \</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span> <span class="preprocessor">    (PSA_ALG_IS_RSA_OAEP(alg) ?                                   \</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span> <span class="preprocessor">     2 * PSA_HASH_SIZE(PSA_ALG_RSA_OAEP_GET_HASH(alg)) + 1 :      \</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span> <span class="preprocessor">     11 </span><span class="comment">/*PKCS#1v1.5*/</span><span class="preprocessor">)</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span> <span class="comment"></span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span> <span class="comment">/**</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span> <span class="comment"> * \brief ECDSA signature size for a given curve bit size</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span> <span class="comment"> *</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span> <span class="comment"> * \param curve_bits    Curve size in bits.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span> <span class="comment"> * \return              Signature size in bytes.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span> <span class="comment"> *</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span> <span class="comment"> * \note This macro returns a compile-time constant if its argument is one.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span> <span class="comment"> */</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span> <span class="preprocessor">#define PSA_ECDSA_SIGNATURE_SIZE(curve_bits)    \</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span> <span class="preprocessor">    (PSA_BITS_TO_BYTES(curve_bits) * 2)</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span> <span class="comment"></span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span> <span class="comment">/** Sufficient signature buffer size for psa_sign_hash().</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span> <span class="comment"> *</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span> <span class="comment"> * This macro returns a sufficient buffer size for a signature using a key</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span> <span class="comment"> * of the specified type and size, with the specified algorithm.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span> <span class="comment"> * Note that the actual size of the signature may be smaller</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span> <span class="comment"> * (some algorithms produce a variable-size signature).</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span> <span class="comment"> *</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span> <span class="comment"> * \warning This function may call its arguments multiple times or</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span> <span class="comment"> *</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span> <span class="comment"> * \param key_type  An asymmetric key type (this may indifferently be a</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span> <span class="comment"> *                  key pair type or a public key type).</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span> <span class="comment"> * \param key_bits  The size of the key in bits.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span> <span class="comment"> * \param alg       The signature algorithm.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span> <span class="comment"> *</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span> <span class="comment"> * \return If the parameters are valid and supported, return</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span> <span class="comment"> *         a buffer size in bytes that guarantees that</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span> <span class="comment"> *         psa_sign_hash() will not fail with</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span> <span class="comment"> *         #PSA_ERROR_BUFFER_TOO_SMALL.</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span> <span class="comment"> *         If the parameters are a valid combination that is not supported</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span> <span class="comment"> *         by the implementation, this macro shall return either a</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span> <span class="comment"> *         sensible size or 0.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span> <span class="comment"> *         If the parameters are not valid, the</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span> <span class="comment"> *         return value is unspecified.</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span> <span class="comment"> */</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span> <span class="preprocessor">#define PSA_SIGN_OUTPUT_SIZE(key_type, key_bits, alg)        \</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span> <span class="preprocessor">    (PSA_KEY_TYPE_IS_RSA(key_type) ? ((void)alg, PSA_BITS_TO_BYTES(key_bits)) : \</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span> <span class="preprocessor">     PSA_KEY_TYPE_IS_ECC(key_type) ? PSA_ECDSA_SIGNATURE_SIZE(key_bits) : \</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span> <span class="preprocessor">     ((void)alg, 0))</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span> </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span> <span class="preprocessor">#define PSA_VENDOR_ECDSA_SIGNATURE_MAX_SIZE     \</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span> <span class="preprocessor">    PSA_ECDSA_SIGNATURE_SIZE(PSA_VENDOR_ECC_MAX_CURVE_BITS)</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span> <span class="comment"></span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span> <span class="comment">/** \def PSA_SIGNATURE_MAX_SIZE</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span> <span class="comment"> *</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span> <span class="comment"> * Maximum size of an asymmetric signature.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span> <span class="comment"> *</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span> <span class="comment"> * This macro must expand to a compile-time constant integer. This value</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span> <span class="comment"> * should be the maximum size of a signature supported by the implementation,</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span> <span class="comment"> * in bytes, and must be no smaller than this maximum.</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span> <span class="comment"> */</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span> <span class="preprocessor">#define PSA_SIGNATURE_MAX_SIZE                               \</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span> <span class="preprocessor">    (PSA_BITS_TO_BYTES(PSA_VENDOR_RSA_MAX_KEY_BITS) &gt; PSA_VENDOR_ECDSA_SIGNATURE_MAX_SIZE ? \</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span> <span class="preprocessor">     PSA_BITS_TO_BYTES(PSA_VENDOR_RSA_MAX_KEY_BITS) :                   \</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span> <span class="preprocessor">     PSA_VENDOR_ECDSA_SIGNATURE_MAX_SIZE)</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span> <span class="comment"></span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span> <span class="comment">/** Sufficient output buffer size for psa_asymmetric_encrypt().</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span> <span class="comment"> *</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span> <span class="comment"> * This macro returns a sufficient buffer size for a ciphertext produced using</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span> <span class="comment"> * a key of the specified type and size, with the specified algorithm.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span> <span class="comment"> * Note that the actual size of the ciphertext may be smaller, depending</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span> <span class="comment"> * on the algorithm.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span> <span class="comment"> *</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span> <span class="comment"> * \warning This function may call its arguments multiple times or</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span> <span class="comment"> *</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span> <span class="comment"> * \param key_type  An asymmetric key type (this may indifferently be a</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span> <span class="comment"> *                  key pair type or a public key type).</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span> <span class="comment"> * \param key_bits  The size of the key in bits.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span> <span class="comment"> * \param alg       The asymmetric encryption algorithm.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span> <span class="comment"> *</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span> <span class="comment"> * \return If the parameters are valid and supported, return</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span> <span class="comment"> *         a buffer size in bytes that guarantees that</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span> <span class="comment"> *         psa_asymmetric_encrypt() will not fail with</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span> <span class="comment"> *         #PSA_ERROR_BUFFER_TOO_SMALL.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span> <span class="comment"> *         If the parameters are a valid combination that is not supported</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span> <span class="comment"> *         by the implementation, this macro shall return either a</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span> <span class="comment"> *         sensible size or 0.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span> <span class="comment"> *         If the parameters are not valid, the</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span> <span class="comment"> *         return value is unspecified.</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span> <span class="comment"> */</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span> <span class="preprocessor">#define PSA_ASYMMETRIC_ENCRYPT_OUTPUT_SIZE(key_type, key_bits, alg)     \</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span> <span class="preprocessor">    (PSA_KEY_TYPE_IS_RSA(key_type) ?                                    \</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span> <span class="preprocessor">     ((void)alg, PSA_BITS_TO_BYTES(key_bits)) :                         \</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span> <span class="comment"></span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span> <span class="comment">/** Sufficient output buffer size for psa_asymmetric_decrypt().</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span> <span class="comment"> *</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span> <span class="comment"> * This macro returns a sufficient buffer size for a plaintext produced using</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span> <span class="comment"> * a key of the specified type and size, with the specified algorithm.</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span> <span class="comment"> * Note that the actual size of the plaintext may be smaller, depending</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span> <span class="comment"> * on the algorithm.</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span> <span class="comment"> *</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span> <span class="comment"> * \warning This function may call its arguments multiple times or</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span> <span class="comment"> *</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span> <span class="comment"> * \param key_type  An asymmetric key type (this may indifferently be a</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span> <span class="comment"> *                  key pair type or a public key type).</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span> <span class="comment"> * \param key_bits  The size of the key in bits.</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span> <span class="comment"> * \param alg       The asymmetric encryption algorithm.</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span> <span class="comment"> *</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span> <span class="comment"> * \return If the parameters are valid and supported, return</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span> <span class="comment"> *         a buffer size in bytes that guarantees that</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span> <span class="comment"> *         psa_asymmetric_decrypt() will not fail with</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span> <span class="comment"> *         #PSA_ERROR_BUFFER_TOO_SMALL.</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span> <span class="comment"> *         If the parameters are a valid combination that is not supported</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span> <span class="comment"> *         by the implementation, this macro shall return either a</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span> <span class="comment"> *         sensible size or 0.</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span> <span class="comment"> *         If the parameters are not valid, the</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span> <span class="comment"> *         return value is unspecified.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span> <span class="comment"> */</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span> <span class="preprocessor">#define PSA_ASYMMETRIC_DECRYPT_OUTPUT_SIZE(key_type, key_bits, alg)     \</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span> <span class="preprocessor">    (PSA_KEY_TYPE_IS_RSA(key_type) ?                                    \</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span> <span class="preprocessor">     PSA_BITS_TO_BYTES(key_bits) - PSA_RSA_MINIMUM_PADDING_SIZE(alg) :  \</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span> </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span> <span class="comment">/* Maximum size of the ASN.1 encoding of an INTEGER with the specified</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span> <span class="comment"> * number of bits.</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span> <span class="comment"> *</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span> <span class="comment"> * This definition assumes that bits &lt;= 2^19 - 9 so that the length field</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span> <span class="comment"> * is at most 3 bytes. The length of the encoding is the length of the</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span> <span class="comment"> * bit string padded to a whole number of bytes plus:</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span> <span class="comment"> * - 1 type byte;</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span> <span class="comment"> * - 1 to 3 length bytes;</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span> <span class="comment"> * - 0 to 1 bytes of leading 0 due to the sign bit.</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span> <span class="comment"> */</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span> <span class="preprocessor">#define PSA_KEY_EXPORT_ASN1_INTEGER_MAX_SIZE(bits)      \</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span> <span class="preprocessor">    ((bits) / 8 + 5)</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span> </div><div class="line"><a name="l00493"></a><span class="lineno">  493</span> <span class="comment">/* Maximum size of the export encoding of an RSA public key.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span> <span class="comment"> * Assumes that the public exponent is less than 2^32.</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span> <span class="comment"> *</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span> <span class="comment"> * RSAPublicKey  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span> <span class="comment"> *    modulus            INTEGER,    -- n</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span> <span class="comment"> *    publicExponent     INTEGER  }  -- e</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span> <span class="comment"> *</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span> <span class="comment"> * - 4 bytes of SEQUENCE overhead;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span> <span class="comment"> * - n : INTEGER;</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span> <span class="comment"> * - 7 bytes for the public exponent.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span> <span class="comment"> */</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span> <span class="preprocessor">#define PSA_KEY_EXPORT_RSA_PUBLIC_KEY_MAX_SIZE(key_bits)        \</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span> <span class="preprocessor">    (PSA_KEY_EXPORT_ASN1_INTEGER_MAX_SIZE(key_bits) + 11)</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span> </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span> <span class="comment">/* Maximum size of the export encoding of an RSA key pair.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span> <span class="comment"> * Assumes thatthe public exponent is less than 2^32 and that the size</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span> <span class="comment"> * difference between the two primes is at most 1 bit.</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span> <span class="comment"> *</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span> <span class="comment"> * RSAPrivateKey ::= SEQUENCE {</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span> <span class="comment"> *     version           Version,  -- 0</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span> <span class="comment"> *     modulus           INTEGER,  -- N-bit</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span> <span class="comment"> *     publicExponent    INTEGER,  -- 32-bit</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span> <span class="comment"> *     privateExponent   INTEGER,  -- N-bit</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span> <span class="comment"> *     prime1            INTEGER,  -- N/2-bit</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span> <span class="comment"> *     prime2            INTEGER,  -- N/2-bit</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span> <span class="comment"> *     exponent1         INTEGER,  -- N/2-bit</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span> <span class="comment"> *     exponent2         INTEGER,  -- N/2-bit</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span> <span class="comment"> *     coefficient       INTEGER,  -- N/2-bit</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span> <span class="comment"> * }</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span> <span class="comment"> *</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span> <span class="comment"> * - 4 bytes of SEQUENCE overhead;</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span> <span class="comment"> * - 3 bytes of version;</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span> <span class="comment"> * - 7 half-size INTEGERs plus 2 full-size INTEGERs,</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span> <span class="comment"> *   overapproximated as 9 half-size INTEGERS;</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span> <span class="comment"> * - 7 bytes for the public exponent.</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span> <span class="comment"> */</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span> <span class="preprocessor">#define PSA_KEY_EXPORT_RSA_KEY_PAIR_MAX_SIZE(key_bits)   \</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span> <span class="preprocessor">    (9 * PSA_KEY_EXPORT_ASN1_INTEGER_MAX_SIZE((key_bits) / 2 + 1) + 14)</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span> </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span> <span class="comment">/* Maximum size of the export encoding of a DSA public key.</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span> <span class="comment"> *</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span> <span class="comment"> * SubjectPublicKeyInfo  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span> <span class="comment"> *      algorithm            AlgorithmIdentifier,</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span> <span class="comment"> *      subjectPublicKey     BIT STRING  } -- contains DSAPublicKey</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span> <span class="comment"> * AlgorithmIdentifier  ::=  SEQUENCE  {</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span> <span class="comment"> *      algorithm               OBJECT IDENTIFIER,</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span> <span class="comment"> *      parameters              Dss-Parms  } -- SEQUENCE of 3 INTEGERs</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span> <span class="comment"> * DSAPublicKey  ::=  INTEGER -- public key, Y</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span> <span class="comment"> *</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span> <span class="comment"> * - 3 * 4 bytes of SEQUENCE overhead;</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span> <span class="comment"> * - 1 + 1 + 7 bytes of algorithm (DSA OID);</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span> <span class="comment"> * - 4 bytes of BIT STRING overhead;</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span> <span class="comment"> * - 3 full-size INTEGERs (p, g, y);</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span> <span class="comment"> * - 1 + 1 + 32 bytes for 1 sub-size INTEGER (q &lt;= 256 bits).</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span> <span class="comment"> */</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span> <span class="preprocessor">#define PSA_KEY_EXPORT_DSA_PUBLIC_KEY_MAX_SIZE(key_bits)        \</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span> <span class="preprocessor">    (PSA_KEY_EXPORT_ASN1_INTEGER_MAX_SIZE(key_bits) * 3 + 59)</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span> </div><div class="line"><a name="l00551"></a><span class="lineno">  551</span> <span class="comment">/* Maximum size of the export encoding of a DSA key pair.</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span> <span class="comment"> *</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span> <span class="comment"> * DSAPrivateKey ::= SEQUENCE {</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span> <span class="comment"> *     version             Version,  -- 0</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span> <span class="comment"> *     prime               INTEGER,  -- p</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span> <span class="comment"> *     subprime            INTEGER,  -- q</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span> <span class="comment"> *     generator           INTEGER,  -- g</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span> <span class="comment"> *     public              INTEGER,  -- y</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span> <span class="comment"> *     private             INTEGER,  -- x</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span> <span class="comment"> * }</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span> <span class="comment"> *</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span> <span class="comment"> * - 4 bytes of SEQUENCE overhead;</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span> <span class="comment"> * - 3 bytes of version;</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span> <span class="comment"> * - 3 full-size INTEGERs (p, g, y);</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span> <span class="comment"> * - 2 * (1 + 1 + 32) bytes for 2 sub-size INTEGERs (q, x &lt;= 256 bits).</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span> <span class="comment"> */</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span> <span class="preprocessor">#define PSA_KEY_EXPORT_DSA_KEY_PAIR_MAX_SIZE(key_bits)   \</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span> <span class="preprocessor">    (PSA_KEY_EXPORT_ASN1_INTEGER_MAX_SIZE(key_bits) * 3 + 75)</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span> </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span> <span class="comment">/* Maximum size of the export encoding of an ECC public key.</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span> <span class="comment"> *</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span> <span class="comment"> * The representation of an ECC public key is:</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span> <span class="comment"> *      - The byte 0x04;</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span> <span class="comment"> *      - `x_P` as a `ceiling(m/8)`-byte string, big-endian;</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span> <span class="comment"> *      - `y_P` as a `ceiling(m/8)`-byte string, big-endian;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span> <span class="comment"> *      - where m is the bit size associated with the curve.</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span> <span class="comment"> *</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span> <span class="comment"> * - 1 byte + 2 * point size.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span> <span class="comment"> */</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span> <span class="preprocessor">#define PSA_KEY_EXPORT_ECC_PUBLIC_KEY_MAX_SIZE(key_bits)        \</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span> <span class="preprocessor">    (2 * PSA_BITS_TO_BYTES(key_bits) + 1)</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span> </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span> <span class="comment">/* Maximum size of the export encoding of an ECC key pair.</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span> <span class="comment"> *</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span> <span class="comment"> * An ECC key pair is represented by the secret value.</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span> <span class="comment"> */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span> <span class="preprocessor">#define PSA_KEY_EXPORT_ECC_KEY_PAIR_MAX_SIZE(key_bits)   \</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span> <span class="preprocessor">    (PSA_BITS_TO_BYTES(key_bits))</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span> <span class="comment"></span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span> <span class="comment">/** Sufficient output buffer size for psa_export_key() or psa_export_public_key().</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span> <span class="comment"> *</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span> <span class="comment"> * This macro returns a compile-time constant if its arguments are</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span> <span class="comment"> * compile-time constants.</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span> <span class="comment"> *</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span> <span class="comment"> * \warning This function may call its arguments multiple times or</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span> <span class="comment"> *</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span> <span class="comment"> * The following code illustrates how to allocate enough memory to export</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span> <span class="comment"> * a key by querying the key type and size at runtime.</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span> <span class="comment"> * \code{c}</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span> <span class="comment"> * psa_key_attributes_t attributes = PSA_KEY_ATTRIBUTES_INIT;</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span> <span class="comment"> * psa_status_t status;</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span> <span class="comment"> * status = psa_get_key_attributes(key, &amp;attributes);</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span> <span class="comment"> * if (status != PSA_SUCCESS) handle_error(...);</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span> <span class="comment"> * psa_key_type_t key_type = psa_get_key_type(&amp;attributes);</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span> <span class="comment"> * size_t key_bits = psa_get_key_bits(&amp;attributes);</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span> <span class="comment"> * size_t buffer_size = PSA_KEY_EXPORT_MAX_SIZE(key_type, key_bits);</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span> <span class="comment"> * psa_reset_key_attributes(&amp;attributes);</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span> <span class="comment"> * uint8_t *buffer = malloc(buffer_size);</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span> <span class="comment"> * if (buffer == NULL) handle_error(...);</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span> <span class="comment"> * size_t buffer_length;</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span> <span class="comment"> * status = psa_export_key(key, buffer, buffer_size, &amp;buffer_length);</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span> <span class="comment"> * if (status != PSA_SUCCESS) handle_error(...);</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span> <span class="comment"> * \endcode</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span> <span class="comment"> *</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span> <span class="comment"> * For psa_export_public_key(), calculate the buffer size from the</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span> <span class="comment"> * public key type. You can use the macro #PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span> <span class="comment"> * to convert a key pair type to the corresponding public key type.</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span> <span class="comment"> * \code{c}</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span> <span class="comment"> * psa_key_attributes_t attributes = PSA_KEY_ATTRIBUTES_INIT;</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span> <span class="comment"> * psa_status_t status;</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span> <span class="comment"> * status = psa_get_key_attributes(key, &amp;attributes);</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span> <span class="comment"> * if (status != PSA_SUCCESS) handle_error(...);</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span> <span class="comment"> * psa_key_type_t key_type = psa_get_key_type(&amp;attributes);</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span> <span class="comment"> * psa_key_type_t public_key_type = PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(key_type);</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span> <span class="comment"> * size_t key_bits = psa_get_key_bits(&amp;attributes);</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span> <span class="comment"> * size_t buffer_size = PSA_KEY_EXPORT_MAX_SIZE(public_key_type, key_bits);</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span> <span class="comment"> * psa_reset_key_attributes(&amp;attributes);</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span> <span class="comment"> * uint8_t *buffer = malloc(buffer_size);</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span> <span class="comment"> * if (buffer == NULL) handle_error(...);</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span> <span class="comment"> * size_t buffer_length;</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span> <span class="comment"> * status = psa_export_public_key(key, buffer, buffer_size, &amp;buffer_length);</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span> <span class="comment"> * if (status != PSA_SUCCESS) handle_error(...);</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span> <span class="comment"> * \endcode</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span> <span class="comment"> *</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span> <span class="comment"> * \param key_type  A supported key type.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span> <span class="comment"> * \param key_bits  The size of the key in bits.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span> <span class="comment"> *</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span> <span class="comment"> * \return If the parameters are valid and supported, return</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span> <span class="comment"> *         a buffer size in bytes that guarantees that</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span> <span class="comment"> *         psa_sign_hash() will not fail with</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span> <span class="comment"> *         #PSA_ERROR_BUFFER_TOO_SMALL.</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span> <span class="comment"> *         If the parameters are a valid combination that is not supported</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span> <span class="comment"> *         by the implementation, this macro shall return either a</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span> <span class="comment"> *         sensible size or 0.</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span> <span class="comment"> *         If the parameters are not valid, the</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span> <span class="comment"> *         return value is unspecified.</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span> <span class="comment"> */</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span> <span class="preprocessor">#define PSA_KEY_EXPORT_MAX_SIZE(key_type, key_bits)                     \</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span> <span class="preprocessor">    (PSA_KEY_TYPE_IS_UNSTRUCTURED(key_type) ? PSA_BITS_TO_BYTES(key_bits) : \</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span> <span class="preprocessor">     (key_type) == PSA_KEY_TYPE_RSA_KEY_PAIR ? PSA_KEY_EXPORT_RSA_KEY_PAIR_MAX_SIZE(key_bits) : \</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span> <span class="preprocessor">     (key_type) == PSA_KEY_TYPE_RSA_PUBLIC_KEY ? PSA_KEY_EXPORT_RSA_PUBLIC_KEY_MAX_SIZE(key_bits) : \</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span> <span class="preprocessor">     (key_type) == PSA_KEY_TYPE_DSA_KEY_PAIR ? PSA_KEY_EXPORT_DSA_KEY_PAIR_MAX_SIZE(key_bits) : \</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span> <span class="preprocessor">     (key_type) == PSA_KEY_TYPE_DSA_PUBLIC_KEY ? PSA_KEY_EXPORT_DSA_PUBLIC_KEY_MAX_SIZE(key_bits) : \</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span> <span class="preprocessor">     PSA_KEY_TYPE_IS_ECC_KEY_PAIR(key_type) ? PSA_KEY_EXPORT_ECC_KEY_PAIR_MAX_SIZE(key_bits) : \</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span> <span class="preprocessor">     PSA_KEY_TYPE_IS_ECC_PUBLIC_KEY(key_type) ? PSA_KEY_EXPORT_ECC_PUBLIC_KEY_MAX_SIZE(key_bits) : \</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span> <span class="comment"></span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span> <span class="comment">/** The default nonce size for an AEAD algorithm, in bytes.</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span> <span class="comment"> *</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span> <span class="comment"> * This macro can be used to allocate a buffer of sufficient size to</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span> <span class="comment"> * store the nonce output from #psa_aead_generate_nonce().</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span> <span class="comment"> *</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span> <span class="comment"> * See also #PSA_AEAD_NONCE_MAX_SIZE.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span> <span class="comment"> *</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span> <span class="comment"> * \note This is not the maximum size of nonce supported as input to #psa_aead_set_nonce(),</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span> <span class="comment"> *       #psa_aead_encrypt() or #psa_aead_decrypt(), just the default size that is generated by</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span> <span class="comment"> *       #psa_aead_generate_nonce().</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span> <span class="comment"> *</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span> <span class="comment"> * \warning This macro may evaluate its arguments multiple times or</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span> <span class="comment"> *</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span> <span class="comment"> * \param key_type  A symmetric key type that is compatible with algorithm \p alg.</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span> <span class="comment"> *</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span> <span class="comment"> * \param alg       An AEAD algorithm (\c PSA_ALG_XXX value such that #PSA_ALG_IS_AEAD(\p alg) is true).</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span> <span class="comment"> *</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span> <span class="comment"> * \return The default nonce size for the specified key type and algorithm.</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span> <span class="comment"> *         If the key type or AEAD algorithm is not recognized,</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span> <span class="comment"> *         or the parameters are incompatible, return 0.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span> <span class="comment"> *         An implementation can return either 0 or a correct size for a key type</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span> <span class="comment"> *         and AEAD algorithm that it recognizes, but does not support.</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span> <span class="comment"> */</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span> <span class="preprocessor">#define PSA_AEAD_NONCE_LENGTH(key_type, alg) \</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span> <span class="preprocessor">    (PSA_BLOCK_CIPHER_BLOCK_SIZE(key_type) == 16 &amp;&amp; \</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span> <span class="preprocessor">         (PSA_ALG_AEAD_WITH_DEFAULT_TAG_LENGTH(alg) == PSA_ALG_CCM || \</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span> <span class="preprocessor">          PSA_ALG_AEAD_WITH_DEFAULT_TAG_LENGTH(alg) == PSA_ALG_GCM) ? 12 : \</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span> <span class="preprocessor">     (key_type) == PSA_KEY_TYPE_CHACHA20 &amp;&amp; \</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span> <span class="preprocessor">          PSA_ALG_AEAD_WITH_DEFAULT_TAG_LENGTH(alg) == PSA_ALG_CHACHA20_POLY1305 ? 12 : \</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span> <span class="comment"></span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span> <span class="comment">/** The maximum default nonce size among all supported pairs of key types and AEAD algorithms, in bytes.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span> <span class="comment"> *</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span> <span class="comment"> * This is equal to or greater than any value that #PSA_AEAD_NONCE_LENGTH() may return.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span> <span class="comment"> *</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span> <span class="comment"> * \note This is not the maximum size of nonce supported as input to #psa_aead_set_nonce(),</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span> <span class="comment"> *       #psa_aead_encrypt() or #psa_aead_decrypt(), just the largest size that may be generated by</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span> <span class="comment"> *       #psa_aead_generate_nonce().</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span> <span class="comment"> */</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span> <span class="preprocessor">#define PSA_AEAD_NONCE_MAX_SIZE 12</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span> <span class="comment"></span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span> <span class="comment">/** The default IV size for a cipher algorithm, in bytes.</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span> <span class="comment"> *</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span> <span class="comment"> * The IV that is generated as part of a call to #psa_cipher_encrypt() is always</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span> <span class="comment"> * the default IV length for the algorithm.</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span> <span class="comment"> *</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span> <span class="comment"> * This macro can be used to allocate a buffer of sufficient size to</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span> <span class="comment"> * store the IV output from #psa_cipher_generate_iv() when using</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span> <span class="comment"> * a multi-part cipher operation.</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span> <span class="comment"> *</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span> <span class="comment"> * See also #PSA_CIPHER_IV_MAX_SIZE.</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span> <span class="comment"> *</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span> <span class="comment"> * \warning This macro may evaluate its arguments multiple times or</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span> <span class="comment"> *</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span> <span class="comment"> * \param key_type  A symmetric key type that is compatible with algorithm \p alg.</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span> <span class="comment"> *</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span> <span class="comment"> * \param alg       A cipher algorithm (\c PSA_ALG_XXX value such that #PSA_ALG_IS_CIPHER(\p alg) is true).</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span> <span class="comment"> *</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span> <span class="comment"> * \return The default IV size for the specified key type and algorithm.</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span> <span class="comment"> *         If the algorithm does not use an IV, return 0.</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span> <span class="comment"> *         If the key type or cipher algorithm is not recognized,</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span> <span class="comment"> *         or the parameters are incompatible, return 0.</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span> <span class="comment"> *         An implementation can return either 0 or a correct size for a key type</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span> <span class="comment"> *         and cipher algorithm that it recognizes, but does not support.</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span> <span class="comment"> */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span> <span class="preprocessor">#define PSA_CIPHER_IV_LENGTH(key_type, alg) \</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span> <span class="preprocessor">    (PSA_BLOCK_CIPHER_BLOCK_SIZE(key_type) &gt; 1 &amp;&amp; \</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span> <span class="preprocessor">        ((alg) == PSA_ALG_CTR || \</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span> <span class="preprocessor">         (alg) == PSA_ALG_CFB || \</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span> <span class="preprocessor">         (alg) == PSA_ALG_OFB || \</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span> <span class="preprocessor">         (alg) == PSA_ALG_XTS || \</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span> <span class="preprocessor">         (alg) == PSA_ALG_CBC_NO_PADDING || \</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span> <span class="preprocessor">         (alg) == PSA_ALG_CBC_PKCS7) ? PSA_BLOCK_CIPHER_BLOCK_SIZE(key_type) : \</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span> <span class="preprocessor">     (key_type) == PSA_KEY_TYPE_CHACHA20 &amp;&amp; \</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span> <span class="preprocessor">         (alg) == PSA_ALG_STREAM_CIPHER ? 12 : \</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span> <span class="comment"></span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span> <span class="comment">/** The maximum IV size for all supported cipher algorithms, in bytes.</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span> <span class="comment"> *</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span> <span class="comment"> * See also #PSA_CIPHER_IV_LENGTH().</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span> <span class="comment"> */</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span> <span class="preprocessor">#define PSA_CIPHER_IV_MAX_SIZE 16</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span> </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span> <span class="preprocessor">#endif </span><span class="comment">/* PSA_CRYPTO_SIZES_H */</span><span class="preprocessor"></span></div></div><!-- fragment --></div><!-- contents -->
        
    


        
<footer class="global-footer">
    <ul class="global-footer-media global-footer-row">
        <li>
            <a class="footer-media-icon" title="Twitter" href="https://twitter.com/ArmSoftwareDev">
                <span class="fab fa-twitter-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Twitter</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="YouTube" href="https://www.youtube.com/c/ArmSoftwareDevelopers">
                <span class="fab fa-youtube-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">YouTube</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Forum" href="http://forums.mbed.com/">
                <span class="fas fa-comments fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Forum</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Blog" href="http://blog.mbed.com/">
                <span class="fas fa-pen-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Blog</span>
            </a>
        </li>
    </ul>

    <div class="global-footer-copyright global-footer-row">
        <div class="copyright-statement">Copyright © <script>document.write(new Date().getFullYear());</script> Arm Limited (or its affiliates).</div>
        <ul class="copyright-links">
            <li><a href="https://os.mbed.com/">Home</a></li>
            <li><a href="https://www.arm.com/company/policies/terms-and-conditions">Website Terms</a></li>
            <li><a href="https://www.arm.com/company/policies/privacy">Privacy</a></li>
            <li><a href="https://www.arm.com/company/policies/cookies">Cookies</a></li>
            <li><a href="http://www.arm.com/company/policies/trademarks">Trademarks</a></li>
        </ul>
    </div>
</footer>



    <div id="cookiemodule">
    <h5>Important Information for this Arm website</h5>
    <div id="cookiecontent">
        <p>
            This site uses cookies to store information on your computer.
            By continuing to use our site, you consent to our cookies.
            If you are not happy with the use of these cookies, please review our
            <a href="https://www.arm.com/company/policies/cookies">Cookie Policy</a>
            to learn how they can be disabled.
            By disabling cookies, some features of the site will not work.
        </p>
        <button id="acceptcookie">Accept and hide this message</button>
    </div>
</div>
<script src="../../../../static/js/cookie_law.js"></script>




    </body>

<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__sizes_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:22:32 GMT -->
</html>
