<!DOCTYPE html>
<html>
    
<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:22:31 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        
        <meta charset="utf-8"/>
        <title>Mbed OS Reference | crypto_extra.h Source File</title>
        <link href="../static/css/vendor/foundation-6.2.4.min.mbed-cache-4c48f6c816971070eb1e4eca75f0ec30.css" rel="stylesheet"/>
        <link href="search/search.css" rel="stylesheet"/>
        <link href="../static/css/app.mbed-cache-a44289fe9f5ca07036a335d6ad7ed8ad.css" rel="stylesheet"/>
        <script src="../static/js/vendor/jquery-3.2.1.min.mbed-cache-c9f5aeeca3ad37bf2aa006139b935f0a.js"></script>
        <script src="dynsections.js"></script>
        <script src="search/searchdata.js"></script>
        <script src="search/search.js"></script>
        <script>
            $(document).ready(function() {
                init_search();
            });
        </script>
    
        

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1447836-8');
ga('require', 'GTM-WXMLD4S')
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl+'&gtm_auth=SMYNPwM0ICsV00c1ZHETqQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M6FZ495');</script>


    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:971746,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>



<!-- Favicons -->
<link rel="apple-touch-icon" sizes="57x57" href="../../../../static/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../../static/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../../static/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../../static/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../../static/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../../static/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../../../static/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../../../static/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../../../static/img/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../../../static/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../static/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../../../static/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../static/img/favicons/favicon-16x16.png">
<link rel="manifest" href="https://os.mbed.com/static/img/favicons/manifest.json">
<link rel="shortcut icon" href="https://os.mbed.com/static/img/favicon.ico?">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">

<link rel="stylesheet" href="../../../../static/CACHE/css/output.811e2930ab34.css" type="text/css">

<link href="../../../../static/docs/css/doc_viewer.css" rel="stylesheet">
<link href="../../../../static/fonts.css" rel="stylesheet">
<link href="../../../../static/docs-nav-and-footer1b26.css?v2" rel="stylesheet">


<link rel="canonical" href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html">
<script src="../../../../static/mbed-nav-vertical-menu.js"></script>


    </head>
    <body>
        








<div class="mbed-nav">
    <div class="mbed-nav__mobile-menu-control">
        <i class="mbed-nav__mobile-menu-control-open fas fa-bars fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-close fas fa-times is-hidden fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-back fas fa-angle-left is-hidden fa-fw"></i>
    </div>
    <div class="mbed-nav__logo">
        <a href="https://os.mbed.com/">
            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#logo"></use></svg>
        </a>
    </div>
    <div class="mbed-nav__menu">

        <!-- Main menu -->
        <nav class="mbed-nav__main-menu">
            <ul class="mbed-nav__dropdown-menu">
                <li class="has-dropdown">
                    Overview

                    <div class="mbed-nav__dropdown-menu-content">

                        <!-- Overview dropdown menu -->
                        <div class="mbed-nav__overview-menu">
                            <section>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <div>
                                                <p>Mbed OS</p>
                                                <p>The open source OS for Cortex-M devices</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link-detail">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <div>
                                                <p>Keil Studio Cloud</p>
                                                <p>Arm's IDE for IoT, embedded and Mbed development</p>
                                            </div>
                                         </a>
                                     </li>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <div>
                                                <p>Mbed Studio</p>
                                                <p>Download the desktop IDE for Mbed OS</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link-detail">

                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <div>
                                               <p>Mbed CLI</p>
                                               <p>Command line access to Mbed tools and services</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Security and Connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <div>
                                                <p>Mbed TLS and Mbed Crypto</p>
                                                <p>Industry standard TLS stack and crypto library</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <div>
                                                <p>Connectivity</p>
                                                <p>BLE, WiFi, Cellular, LoRaWAN and more</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </li>
                <li class="has-dropdown">
                    Hardware

                    <!-- Hardware dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__hardware-dropdown">
                            <ul class="mbed-nav__hardware-menu">
                                <li>
                                    <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                        <div>
                                            <p>Boards</p>
                                            <p>Build your Mbed projects with development boards for Arm Cortex processors and MCUs</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                        <div>
                                            <p>Modules</p>
                                            <p>Modules include a MCU, connectivity and onboard memory, making them ideal for designing IoT products for mass production</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                        <div>
                                            <p>Components</p>
                                            <p>The component database hosts libraries for different sensors, actuators, radios, inputs, middleware and IoT services</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                        <div>
                                            <p>Hardware overview & Mbed Enabled</p>
                                            <p>Learn about hardware support for Mbed, as well as the Mbed Enabled program, which identifies Mbed compatible products</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                        <div>
                                            <p>Mbed HDK</p>
                                            <p>Reference designs, schematics and board layouts to develop production hardware and Mbed-compatible development boards</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li class="has-dropdown">
                    Documentation

                    <!-- Documentation dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__documentation-dropdown">
                            <ul class="mbed-nav__documentation-menu">
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a>
                                </li>
                                <li>
                                    <a
                                        href="https://developer.arm.com/documentation/102497/latest/Arm-Keil-Studio-Cloud">
                                        Keil Studio
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li class="has-dropdown">
                    Community

                    <!-- Community dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__community-dropdown">
                            <ul class="mbed-nav__community-menu">
                                <li>
                                    <a href="https://forums.mbed.com/">Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a>
                                </li>
                                <li>
                                    <a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/support/">Report a problem</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://os.mbed.com/blog/">Blog</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="mbed-nav__user-controls">
        <div class="mbed-nav__user-controls-top">
            <div class="mbed-nav__search">
                <form id="mbed-nav__search-box" class="is-hidden" action="https://os.mbed.com/search" method="GET">
                    <div class="mbed-nav__search-box">
                        <input type="search" name="q" placeholder="Search...">
                        <button type="submit">
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                        </button>
                    </div>
                </form>
                <i class="mbed-nav__search-close fas fa-times is-hidden"></i>
                <svg class="mbed-nav__search-open stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
            </div>
            <a class="mbed-nav__cta" href="https://studio.keil.arm.com/mbed" target="_blank">
                Keil Studio Cloud
            </a>

            
                
                <nav class="mbed-nav__logged-out-nav">
                    <ul class="mbed-nav__dropdown-menu">
                        <li>
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#profile"></use></svg>

                            <!-- Logged out dropdown menu -->
                            <div class="mbed-nav__dropdown-menu-content">
                                <div class="mbed-nav__logged-out-dropdown">
                                    <ul class="mbed-nav__logged-out-menu">
                                        <li><a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html">Log in or Sign up</a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </nav>
                
            
        </div>
    </div>
    <div class="mbed-nav__spacer"></div>
</div>
<div class="mbed-nav__mobile-menu-cover is-hidden">
    <div class="mbed-nav__mobile-menu">

        <div id="mbed-nav__main-menu-mobile">
            <div class="mbed-nav__user-controls-mobile">
                <div class="mbed-nav__user-controls-top-mobile">
                    <form action="https://os.mbed.com/search" method="GET">
                        <div class="mbed-nav__search-box mbed-nav__search-box--light">
                            <input type="search" name="q" placeholder="Search...">
                            <button type="submit">
                                <svg class="stroke-dark-grey"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                            </button>
                        </div>
                    </form>
                    
                        
                        <a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html">Log in or Sign up</a>
                        
                    
                </div>
            </div>

            <ul class="mbed-nav__side-menu">
                <li>
                    <input type="checkbox" name="accordion-toggle" id="overview-accordion">
                    <label for="overview-accordion">Overview</label>
                    <div class="accordion_content">
                        <ul class="overview-menu-mobile">
                            <li>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <p>Mbed OS</p>
                                        </a>
                                    </li>
                                    

                                </ul>
                            </li>
                            <li>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <p>Mbed Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <p>Keil Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <p>Mbed CLI</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Security and connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <p>Mbed TLS and Mbed Crypto</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <p>Connectivity</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="hardware-accordion">
                    <label for="hardware-accordion">Hardware</label>
                    <div class="accordion_content">
                        <ul>
                            <li>
                                <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                    <p>Boards</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                    <p>Modules</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                    <p>Components</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                    <p>Hardware overview & Mbed Enabled</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                    <p>Mbed HDK</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="documentation-accordion">
                    <label for="documentation-accordion">Documentation</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a></li>
                            <li>
                              <a
                                href="https://developer.arm.com/documentation/102497/1-5/Arm-Keil-Studio/?utm_source=mbed_com&amp;utm_medium=nav_docs_link&amp;utm_campaign=mbed_com_promo">
                                Keil Studio
                              </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="community-accordion">
                    <label for="community-accordion">Community</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://forums.mbed.com/">Forum</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a></li>
                            <li><a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a></li>
                            <li><a href="https://os.mbed.com/support/">Report a problem</a></li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/blog/">Blog</a></li>
            </ul>
        </div>

        
    </div>
</div>



<div class="version-picker-container">
    
    <select class="version-picker" onchange="goToVersion(this.value)">
        
            <option
                value="v6.16"
                selected
            >
                v6.16
            </option>
        
            <option
                value="v6.15"
                
            >
                v6.15
            </option>
        
            <option
                value="v6.14"
                
            >
                v6.14
            </option>
        
            <option
                value="v6.13"
                
            >
                v6.13
            </option>
        
            <option
                value="v6.12"
                
            >
                v6.12
            </option>
        
            <option
                value="v6.11"
                
            >
                v6.11
            </option>
        
            <option
                value="v6.10"
                
            >
                v6.10
            </option>
        
            <option
                value="v6.9"
                
            >
                v6.9
            </option>
        
            <option
                value="v6.8"
                
            >
                v6.8
            </option>
        
            <option
                value="v6.7"
                
            >
                v6.7
            </option>
        
            <option
                value="v6.6"
                
            >
                v6.6
            </option>
        
            <option
                value="v6.5"
                
            >
                v6.5
            </option>
        
            <option
                value="v5.15"
                
            >
                v5.15
            </option>
        
    </select>
    

    <div class="contact-us">
        Mistake on this page?
        
            <br>
            <a href="https://github.com/ARMmbed/mbed-os-5-docs/issues">
                Report an issue in GitHub
                <i class="fab fa-github"></i>
            </a>
            or
            <a href="mailto:mbed-support@arm.com">
                email us
                <i class="fas fa-envelope"></i>
            </a>
        
    </div>
</div>

<script>
    function goToVersion(version) {
        window.location.href = window.location.href.replace(
            "v6.16",
            version
        )
    }
</script>

        
        <div class="topbar" id="top">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div class="tabs" id="navrow1">
    <ul class="tablist">
      <li><a href="index.html"><span>Main Page</span></a></li>
      <li><a href="pages.html"><span>Related Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div class="MSearchBoxInactive" id="MSearchBox">
        <span class="left">
          <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png"/>
          <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
          </span><span class="right">
            <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png"/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2" id="navrow2">
    <ul class="tablist">
      <li><a href="files.html"><span>File List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="navpath" id="nav-path">
  <ul>
<li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_d00fafdb9414f6e624fcf4d73ffde065.html">platform</a></li><li class="navelem"><a class="el" href="dir_a72924067aea8bbead751f11070268f4.html">FEATURE_EXPERIMENTAL_API</a></li><li class="navelem"><a class="el" href="dir_007a19531d3d09289f9f9c2cf309e91b.html">FEATURE_PSA</a></li><li class="navelem"><a class="el" href="dir_05e0d8a557d855fa23572451f1c8ea18.html">TARGET_MBED_PSA_SRV</a></li><li class="navelem"><a class="el" href="dir_4873970fac28857be75ffc795d800217.html">inc</a></li><li class="navelem"><a class="el" href="dir_8dc47cca0505aa6837fa09ab8303288c.html">psa</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> <span class="comment">/**</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> <span class="comment"> * \file psa/crypto_extra.h</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span> <span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span> <span class="comment"> * \brief PSA cryptography module: Mbed TLS vendor extensions</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span> <span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span> <span class="comment"> * \note This file may not be included directly. Applications must</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span> <span class="comment"> * include psa/crypto.h.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span> <span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span> <span class="comment"> * This file is reserved for vendor-specific definitions.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span> <span class="comment"> */</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span> <span class="comment">/*</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span> <span class="comment"> *  Copyright The Mbed TLS Contributors</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span> <span class="comment"> *  SPDX-License-Identifier: Apache-2.0</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span> <span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span> <span class="comment"> *  Licensed under the Apache License, Version 2.0 (the "License"); you may</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span> <span class="comment"> *  not use this file except in compliance with the License.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span> <span class="comment"> *  You may obtain a copy of the License at</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span> <span class="comment"> *</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span> <span class="comment"> *  http://www.apache.org/licenses/LICENSE-2.0</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span> <span class="comment"> *</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span> <span class="comment"> *  Unless required by applicable law or agreed to in writing, software</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span> <span class="comment"> *  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span> <span class="comment"> *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span> <span class="comment"> *  See the License for the specific language governing permissions and</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span> <span class="comment"> *  limitations under the License.</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span> <span class="comment"> */</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span> </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span> <span class="preprocessor">#ifndef PSA_CRYPTO_EXTRA_H</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span> <span class="preprocessor">#define PSA_CRYPTO_EXTRA_H</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span> </div><div class="line"><a name="l00031"></a><span class="lineno">   31</span> <span class="preprocessor">#include "mbedtls/platform_util.h"</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span> </div><div class="line"><a name="l00033"></a><span class="lineno">   33</span> <span class="preprocessor">#include "crypto_compat.h"</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span> </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span> <span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span> <span class="keyword">extern</span> <span class="stringliteral">"C"</span> {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span> </div><div class="line"><a name="l00039"></a><span class="lineno">   39</span> <span class="comment">/* UID for secure storage seed */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span> <span class="preprocessor">#define PSA_CRYPTO_ITS_RANDOM_SEED_UID 0xFFFFFF52</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span> </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span> <span class="comment"></span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span> <span class="comment">/** \addtogroup attributes</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span> <span class="comment"> * @{</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span> <span class="comment"> */</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span> <span class="comment"></span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span> <span class="comment">/** \brief Declare the enrollment algorithm for a key.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span> <span class="comment"> *</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span> <span class="comment"> * An operation on a key may indifferently use the algorithm set with</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span> <span class="comment"> * psa_set_key_algorithm() or with this function.</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span> <span class="comment"> *</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span> <span class="comment"> * \param[out] attributes       The attribute structure to write to.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span> <span class="comment"> * \param alg2                  A second algorithm that the key may be used</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span> <span class="comment"> *                              for, in addition to the algorithm set with</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span> <span class="comment"> *                              psa_set_key_algorithm().</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span> <span class="comment"> *</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span> <span class="comment"> * \warning Setting an enrollment algorithm is not recommended, because</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span> <span class="comment"> *          using the same key with different algorithms can allow some</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span> <span class="comment"> *          attacks based on arithmetic relations between different</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span> <span class="comment"> *          computations made with the same key, or can escalate harmless</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span> <span class="comment"> *          side channels into exploitable ones. Use this function only</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span> <span class="comment"> *          if it is necessary to support a protocol for which it has been</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span> <span class="comment"> *          verified that the usage of the key with multiple algorithms</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span> <span class="comment"> *          is safe.</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span> <span class="comment"> */</span></div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="group__attributes.html#gaffa134b74aa52aa3ed9397fcab4005aa">   66</a></span> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="group__attributes.html#gaffa134b74aa52aa3ed9397fcab4005aa">psa_set_key_enrollment_algorithm</a>(</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>     <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>     <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg2)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span> {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>     attributes-&gt;core.policy.alg2 = alg2;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span> }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span> <span class="comment"></span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span> <span class="comment">/** Retrieve the enrollment algorithm policy from key attributes.</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span> <span class="comment"> *</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span> <span class="comment"> * \param[in] attributes        The key attribute structure to query.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span> <span class="comment"> *</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span> <span class="comment"> * \return The enrollment algorithm stored in the attribute structure.</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span> <span class="comment"> */</span></div><div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="group__attributes.html#ga39803b62a97198cf630854db9b53c588">   79</a></span> <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> <a class="code" href="group__attributes.html#ga39803b62a97198cf630854db9b53c588">psa_get_key_enrollment_algorithm</a>(</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>     <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span> {</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>     <span class="keywordflow">return</span>( attributes-&gt;core.policy.alg2 );</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span> }</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span> </div><div class="line"><a name="l00085"></a><span class="lineno">   85</span> <span class="preprocessor">#if defined(MBEDTLS_PSA_CRYPTO_SE_C)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span> <span class="comment"></span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span> <span class="comment">/** Retrieve the slot number where a key is stored.</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span> <span class="comment"> *</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span> <span class="comment"> * A slot number is only defined for keys that are stored in a secure</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span> <span class="comment"> * element.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span> <span class="comment"> *</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span> <span class="comment"> * This information is only useful if the secure element is not entirely</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span> <span class="comment"> * managed through the PSA Cryptography API. It is up to the secure</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span> <span class="comment"> * element driver to decide how PSA slot numbers map to any other interface</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span> <span class="comment"> * that the secure element may have.</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span> <span class="comment"> *</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span> <span class="comment"> * \param[in] attributes        The key attribute structure to query.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span> <span class="comment"> * \param[out] slot_number      On success, the slot number containing the key.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span> <span class="comment"> *</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span> <span class="comment"> * \retval #PSA_SUCCESS</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span> <span class="comment"> *         The key is located in a secure element, and \p *slot_number</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span> <span class="comment"> *         indicates the slot number that contains it.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span> <span class="comment"> * \retval #PSA_ERROR_NOT_PERMITTED</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span> <span class="comment"> *         The caller is not permitted to query the slot number.</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span> <span class="comment"> *         Mbed Crypto currently does not return this error.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span> <span class="comment"> * \retval #PSA_ERROR_INVALID_ARGUMENT</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span> <span class="comment"> *         The key is not located in a secure element.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span> <span class="comment"> */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span> <a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_get_key_slot_number(</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>     <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>     <a class="code" href="group__se__init.html#ga90828ba6e282dd39260c81af68532e1d">psa_key_slot_number_t</a> *slot_number );</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span> <span class="comment"></span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span> <span class="comment">/** Choose the slot number where a key is stored.</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span> <span class="comment"> *</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span> <span class="comment"> * This function declares a slot number in the specified attribute</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span> <span class="comment"> * structure.</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span> <span class="comment"> *</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span> <span class="comment"> * A slot number is only meaningful for keys that are stored in a secure</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span> <span class="comment"> * element. It is up to the secure element driver to decide how PSA slot</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span> <span class="comment"> * numbers map to any other interface that the secure element may have.</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span> <span class="comment"> *</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span> <span class="comment"> * \note Setting a slot number in key attributes for a key creation can</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span> <span class="comment"> *       cause the following errors when creating the key:</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span> <span class="comment"> *       - #PSA_ERROR_NOT_SUPPORTED if the selected secure element does</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span> <span class="comment"> *         not support choosing a specific slot number.</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span> <span class="comment"> *       - #PSA_ERROR_NOT_PERMITTED if the caller is not permitted to</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span> <span class="comment"> *         choose slot numbers in general or to choose this specific slot.</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span> <span class="comment"> *       - #PSA_ERROR_INVALID_ARGUMENT if the chosen slot number is not</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span> <span class="comment"> *         valid in general or not valid for this specific key.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span> <span class="comment"> *       - #PSA_ERROR_ALREADY_EXISTS if there is already a key in the</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span> <span class="comment"> *         selected slot.</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span> <span class="comment"> *</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span> <span class="comment"> * \param[out] attributes       The attribute structure to write to.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span> <span class="comment"> * \param slot_number           The slot number to set.</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span> <span class="comment"> */</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_set_key_slot_number(</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>     <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>     <a class="code" href="group__se__init.html#ga90828ba6e282dd39260c81af68532e1d">psa_key_slot_number_t</a> slot_number )</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span> {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>     attributes-&gt;core.flags |= MBEDTLS_PSA_KA_FLAG_HAS_SLOT_NUMBER;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>     attributes-&gt;slot_number = slot_number;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span> }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span> <span class="comment"></span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span> <span class="comment">/** Remove the slot number attribute from a key attribute structure.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span> <span class="comment"> *</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span> <span class="comment"> * This function undoes the action of psa_set_key_slot_number().</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span> <span class="comment"> *</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span> <span class="comment"> * \param[out] attributes       The attribute structure to write to.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span> <span class="comment"> */</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span> <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> psa_clear_key_slot_number(</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>     <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes )</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span> {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>     attributes-&gt;core.flags &amp;= ~MBEDTLS_PSA_KA_FLAG_HAS_SLOT_NUMBER;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span> }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span> <span class="comment"></span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span> <span class="comment">/** Register a key that is already present in a secure element.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span> <span class="comment"> *</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span> <span class="comment"> * The key must be located in a secure element designated by the</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span> <span class="comment"> * lifetime field in \p attributes, in the slot set with</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span> <span class="comment"> * psa_set_key_slot_number() in the attribute structure.</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span> <span class="comment"> * This function makes the key available through the key identifier</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span> <span class="comment"> * specified in \p attributes.</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span> <span class="comment"> *</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span> <span class="comment"> * \param[in] attributes        The attributes of the existing key.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span> <span class="comment"> *</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span> <span class="comment"> * \retval #PSA_SUCCESS</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span> <span class="comment"> *         The key was successfully registered.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span> <span class="comment"> *         Note that depending on the design of the driver, this may or may</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span> <span class="comment"> *         not guarantee that a key actually exists in the designated slot</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span> <span class="comment"> *         and is compatible with the specified attributes.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span> <span class="comment"> * \retval #PSA_ERROR_ALREADY_EXISTS</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span> <span class="comment"> *         There is already a key with the identifier specified in</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span> <span class="comment"> *         \p attributes.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span> <span class="comment"> * \retval #PSA_ERROR_NOT_SUPPORTED</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span> <span class="comment"> *         The secure element driver for the specified lifetime does not</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span> <span class="comment"> *         support registering a key.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span> <span class="comment"> * \retval #PSA_ERROR_INVALID_ARGUMENT</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span> <span class="comment"> *         \p attributes specifies a lifetime which is not located</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span> <span class="comment"> *         in a secure element.</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span> <span class="comment"> * \retval #PSA_ERROR_INVALID_ARGUMENT</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span> <span class="comment"> *         No slot number is specified in \p attributes,</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span> <span class="comment"> *         or the specified slot number is not valid.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span> <span class="comment"> * \retval #PSA_ERROR_NOT_PERMITTED</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span> <span class="comment"> *         The caller is not authorized to register the specified key slot.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span> <span class="comment"> * \retval #PSA_ERROR_INSUFFICIENT_MEMORY</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span> <span class="comment"> * \retval #PSA_ERROR_COMMUNICATION_FAILURE</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span> <span class="comment"> * \retval #PSA_ERROR_HARDWARE_FAILURE</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span> <span class="comment"> * \retval #PSA_ERROR_CORRUPTION_DETECTED</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span> <span class="comment"> * \retval #PSA_ERROR_BAD_STATE</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span> <span class="comment"> *         The library has not been previously initialized by psa_crypto_init().</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span> <span class="comment"> *         It is implementation-dependent whether a failure to initialize</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span> <span class="comment"> *         results in this error code.</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span> <span class="comment"> */</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span> <a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> mbedtls_psa_register_se_key(</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>     <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span> </div><div class="line"><a name="l00197"></a><span class="lineno">  197</span> <span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_PSA_CRYPTO_SE_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span> <span class="comment"></span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span> <span class="comment"></span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span> <span class="comment">/**</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span> <span class="comment"> * \brief Library deinitialization.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span> <span class="comment"> *</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span> <span class="comment"> * This function clears all data associated with the PSA layer,</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span> <span class="comment"> * including the whole key store.</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span> <span class="comment"> *</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span> <span class="comment"> * This is an Mbed TLS extension.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span> <span class="comment"> */</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span> <span class="keywordtype">void</span> mbedtls_psa_crypto_free( <span class="keywordtype">void</span> );</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span> <span class="comment"></span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span> <span class="comment">/** \brief Statistics about</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span> <span class="comment"> * resource consumption related to the PSA keystore.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span> <span class="comment"> *</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span> <span class="comment"> * \note The content of this structure is not part of the stable API and ABI</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span> <span class="comment"> *       of Mbed Crypto and may change arbitrarily from version to version.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span> <span class="comment"> */</span></div><div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html">  217</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span> {<span class="comment"></span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span> <span class="comment">    /** Number of slots containing key material for a volatile key. */</span></div><div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#a1bdb5b67e8c73b7c109ed9ee2c0ab39b">  220</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a1bdb5b67e8c73b7c109ed9ee2c0ab39b">volatile_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span> <span class="comment">    /** Number of slots containing key material for a key which is in</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span> <span class="comment">     * internal persistent storage. */</span></div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#ad6c6b04feecbcd99da1d83d79ee04ef0">  223</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#ad6c6b04feecbcd99da1d83d79ee04ef0">persistent_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span> <span class="comment">    /** Number of slots containing a reference to a key in a</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span> <span class="comment">     * secure element. */</span></div><div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#a29fbe18105fcd97a86a9cab555b18fa8">  226</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a29fbe18105fcd97a86a9cab555b18fa8">external_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span> <span class="comment">    /** Number of slots which are occupied, but do not contain</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span> <span class="comment">     * key material yet. */</span></div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#a1800174c9a19f8f6c76699bec5cfc674">  229</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a1800174c9a19f8f6c76699bec5cfc674">half_filled_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span> <span class="comment">    /** Number of slots that contain cache data. */</span></div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#ae9e86c6d3f9b74feaece926be8433ee4">  231</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#ae9e86c6d3f9b74feaece926be8433ee4">cache_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span> <span class="comment">    /** Number of slots that are not used for anything. */</span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#ad3f22a4dd89f132af2cada7ea68ae502">  233</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#ad3f22a4dd89f132af2cada7ea68ae502">empty_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span> <span class="comment">    /** Number of slots that are locked. */</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#a9ca5dfbe9c5e8bf7338243a0c7f07640">  235</a></span>     <span class="keywordtype">size_t</span> <a class="code" href="structmbedtls__psa__stats__s.html#a9ca5dfbe9c5e8bf7338243a0c7f07640">locked_slots</a>;<span class="comment"></span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span> <span class="comment">    /** Largest key id value among open keys in internal persistent storage. */</span></div><div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#aae936233b2c364553e62e72f90bb2f8b">  237</a></span>     <a class="code" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> <a class="code" href="structmbedtls__psa__stats__s.html#aae936233b2c364553e62e72f90bb2f8b">max_open_internal_key_id</a>;<span class="comment"></span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span> <span class="comment">    /** Largest key id value among open keys in secure elements. */</span></div><div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="structmbedtls__psa__stats__s.html#acc2fad2f6d3c10c28d61c25d017afe9a">  239</a></span>     <a class="code" href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a> <a class="code" href="structmbedtls__psa__stats__s.html#acc2fad2f6d3c10c28d61c25d017afe9a">max_open_external_key_id</a>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span> } <a class="code" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_t</a>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span> <span class="comment"></span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span> <span class="comment">/** \brief Get statistics about</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span> <span class="comment"> * resource consumption related to the PSA keystore.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span> <span class="comment"> *</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span> <span class="comment"> * \note When Mbed Crypto is built as part of a service, with isolation</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span> <span class="comment"> *       between the application and the keystore, the service may or</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span> <span class="comment"> *       may not expose this function.</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span> <span class="comment"> */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span> <span class="keywordtype">void</span> mbedtls_psa_get_stats( <a class="code" href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_t</a> *stats );</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span> <span class="comment"></span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span> <span class="comment">/**</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span> <span class="comment"> * \brief Inject an initial entropy seed for the random generator into</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span> <span class="comment"> *        secure storage.</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span> <span class="comment"> *</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span> <span class="comment"> * This function injects data to be used as a seed for the random generator</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span> <span class="comment"> * used by the PSA Crypto implementation. On devices that lack a trusted</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span> <span class="comment"> * entropy source (preferably a hardware random number generator),</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span> <span class="comment"> * the Mbed PSA Crypto implementation uses this value to seed its</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span> <span class="comment"> * random generator.</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span> <span class="comment"> *</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span> <span class="comment"> * On devices without a trusted entropy source, this function must be</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span> <span class="comment"> * called exactly once in the lifetime of the device. On devices with</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span> <span class="comment"> * a trusted entropy source, calling this function is optional.</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span> <span class="comment"> * In all cases, this function may only be called before calling any</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span> <span class="comment"> * other function in the PSA Crypto API, including psa_crypto_init().</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span> <span class="comment"> *</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span> <span class="comment"> * When this function returns successfully, it populates a file in</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span> <span class="comment"> * persistent storage. Once the file has been created, this function</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span> <span class="comment"> * can no longer succeed.</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span> <span class="comment"> *</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span> <span class="comment"> * If any error occurs, this function does not change the system state.</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span> <span class="comment"> * You can call this function again after correcting the reason for the</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span> <span class="comment"> * error if possible.</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span> <span class="comment"> *</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span> <span class="comment"> * \warning This function **can** fail! Callers MUST check the return status.</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span> <span class="comment"> *</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span> <span class="comment"> * \warning If you use this function, you should use it as part of a</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span> <span class="comment"> *          factory provisioning process. The value of the injected seed</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span> <span class="comment"> *          is critical to the security of the device. It must be</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span> <span class="comment"> *          *secret*, *unpredictable* and (statistically) *unique per device*.</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span> <span class="comment"> *          You should be generate it randomly using a cryptographically</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span> <span class="comment"> *          secure random generator seeded from trusted entropy sources.</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span> <span class="comment"> *          You should transmit it securely to the device and ensure</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span> <span class="comment"> *          that its value is not leaked or stored anywhere beyond the</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span> <span class="comment"> *          needs of transmitting it from the point of generation to</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span> <span class="comment"> *          the call of this function, and erase all copies of the value</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span> <span class="comment"> *          once this function returns.</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span> <span class="comment"> *</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span> <span class="comment"> * This is an Mbed TLS extension.</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span> <span class="comment"> *</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span> <span class="comment"> * \note This function is only available on the following platforms:</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span> <span class="comment"> * * If the compile-time option MBEDTLS_PSA_INJECT_ENTROPY is enabled.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span> <span class="comment"> *   Note that you must provide compatible implementations of</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span> <span class="comment"> *   mbedtls_nv_seed_read and mbedtls_nv_seed_write.</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span> <span class="comment"> * * In a client-server integration of PSA Cryptography, on the client side,</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span> <span class="comment"> *   if the server supports this feature.</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span> <span class="comment"> * \param[in] seed          Buffer containing the seed value to inject.</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span> <span class="comment"> * \param[in] seed_size     Size of the \p seed buffer.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span> <span class="comment"> *                          The size of the seed in bytes must be greater</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span> <span class="comment"> *                          or equal to both #MBEDTLS_ENTROPY_MIN_PLATFORM</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span> <span class="comment"> *                          and #MBEDTLS_ENTROPY_BLOCK_SIZE.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span> <span class="comment"> *                          It must be less or equal to</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span> <span class="comment"> *                          #MBEDTLS_ENTROPY_MAX_SEED_SIZE.</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span> <span class="comment"> *</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span> <span class="comment"> * \retval #PSA_SUCCESS</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span> <span class="comment"> *         The seed value was injected successfully. The random generator</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span> <span class="comment"> *         of the PSA Crypto implementation is now ready for use.</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span> <span class="comment"> *         You may now call psa_crypto_init() and use the PSA Crypto</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span> <span class="comment"> *         implementation.</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span> <span class="comment"> * \retval #PSA_ERROR_INVALID_ARGUMENT</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span> <span class="comment"> *         \p seed_size is out of range.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span> <span class="comment"> * \retval #PSA_ERROR_STORAGE_FAILURE</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span> <span class="comment"> *         There was a failure reading or writing from storage.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span> <span class="comment"> * \retval #PSA_ERROR_NOT_PERMITTED</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span> <span class="comment"> *         The library has already been initialized. It is no longer</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span> <span class="comment"> *         possible to call this function.</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span> <span class="comment"> */</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span> <a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> mbedtls_psa_inject_entropy(<span class="keyword">const</span> uint8_t *seed,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>                                         <span class="keywordtype">size_t</span> seed_size);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span> <span class="comment"></span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span> <span class="comment">/** \addtogroup crypto_types</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span> <span class="comment"> * @{</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span> <span class="comment"> */</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span> <span class="comment"></span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span> <span class="comment">/** DSA public key.</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span> <span class="comment"> *</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span> <span class="comment"> * The import and export format is the</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span> <span class="comment"> * representation of the public key `y = g^x mod p` as a big-endian byte</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span> <span class="comment"> * string. The length of the byte string is the length of the base prime `p`</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span> <span class="comment"> * in bytes.</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span> <span class="comment"> */</span></div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga5e7439c2905136366c3a876e62e5ddfc">  332</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DSA_PUBLIC_KEY                 ((psa_key_type_t)0x4002)</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span> <span class="comment"></span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span> <span class="comment">/** DSA key pair (private and public key).</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span> <span class="comment"> *</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span> <span class="comment"> * The import and export format is the</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span> <span class="comment"> * representation of the private key `x` as a big-endian byte string. The</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span> <span class="comment"> * length of the byte string is the private key size in bytes (leading zeroes</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span> <span class="comment"> * are not stripped).</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span> <span class="comment"> *</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span> <span class="comment"> * Determinstic DSA key derivation with psa_generate_derived_key follows</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span> <span class="comment"> * FIPS 186-4 &amp;sect;B.1.2: interpret the byte string as integer</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span> <span class="comment"> * in big-endian order. Discard it if it is not in the range</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span> <span class="comment"> * [0, *N* - 2] where *N* is the boundary of the private key domain</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span> <span class="comment"> * (the prime *p* for Diffie-Hellman, the subprime *q* for DSA,</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span> <span class="comment"> * or the order of the curve's base point for ECC).</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span> <span class="comment"> * Add 1 to the resulting integer and use this as the private key *x*.</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span> <span class="comment"> *</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span> <span class="comment"> */</span></div><div class="line"><a name="l00350"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga7d4a45c147cb0ecb55d01d9c04bfed76">  350</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_DSA_KEY_PAIR                    ((psa_key_type_t)0x7002)</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span> <span class="comment"></span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span> <span class="comment">/** Whether a key type is an DSA key (pair or public-only). */</span></div><div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gac9df788941f57444fa3c4cac9bea2538">  353</a></span> <span class="preprocessor">#define PSA_KEY_TYPE_IS_DSA(type)                                       \</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span> <span class="preprocessor">    (PSA_KEY_TYPE_PUBLIC_KEY_OF_KEY_PAIR(type) == PSA_KEY_TYPE_DSA_PUBLIC_KEY)</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span> </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span> <span class="preprocessor">#define PSA_ALG_DSA_BASE                        ((psa_algorithm_t)0x06000400)</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span> <span class="comment">/** DSA signature with hashing.</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span> <span class="comment"> *</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span> <span class="comment"> * This is the signature scheme defined by FIPS 186-4,</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span> <span class="comment"> * with a random per-message secret number (*k*).</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span> <span class="comment"> *</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span> <span class="comment"> *                      This includes #PSA_ALG_ANY_HASH</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span> <span class="comment"> *                      when specifying the algorithm in a usage policy.</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span> <span class="comment"> *</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span> <span class="comment"> * \return              The corresponding DSA signature algorithm.</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span> <span class="comment"> */</span></div><div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="group__crypto__types.html#ga76407de3dd06efc8572b586d9d2cf9f9">  371</a></span> <span class="preprocessor">#define PSA_ALG_DSA(hash_alg)                             \</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span> <span class="preprocessor">    (PSA_ALG_DSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span> <span class="preprocessor">#define PSA_ALG_DETERMINISTIC_DSA_BASE          ((psa_algorithm_t)0x06000500)</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span> <span class="preprocessor">#define PSA_ALG_DSA_DETERMINISTIC_FLAG PSA_ALG_ECDSA_DETERMINISTIC_FLAG</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span> <span class="comment">/** Deterministic DSA signature with hashing.</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span> <span class="comment"> *</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span> <span class="comment"> * This is the deterministic variant defined by RFC 6979 of</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span> <span class="comment"> * the signature scheme defined by FIPS 186-4.</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span> <span class="comment"> *</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span> <span class="comment"> * \param hash_alg      A hash algorithm (\c PSA_ALG_XXX value such that</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span> <span class="comment"> *                      #PSA_ALG_IS_HASH(\p hash_alg) is true).</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span> <span class="comment"> *                      This includes #PSA_ALG_ANY_HASH</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span> <span class="comment"> *                      when specifying the algorithm in a usage policy.</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span> <span class="comment"> *</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span> <span class="comment"> * \return              The corresponding DSA signature algorithm.</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span> <span class="comment"> * \return              Unspecified if \p hash_alg is not a supported</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span> <span class="comment"> *                      hash algorithm.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span> <span class="comment"> */</span></div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="group__crypto__types.html#gabfdf1ec88582f31f3a74347b41295cdb">  389</a></span> <span class="preprocessor">#define PSA_ALG_DETERMINISTIC_DSA(hash_alg)                             \</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span> <span class="preprocessor">    (PSA_ALG_DETERMINISTIC_DSA_BASE | ((hash_alg) &amp; PSA_ALG_HASH_MASK))</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span> <span class="preprocessor">#define PSA_ALG_IS_DSA(alg)                                             \</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span> <span class="preprocessor">    (((alg) &amp; ~PSA_ALG_HASH_MASK &amp; ~PSA_ALG_DSA_DETERMINISTIC_FLAG) ==  \</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span> <span class="preprocessor">     PSA_ALG_DSA_BASE)</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span> <span class="preprocessor">#define PSA_ALG_DSA_IS_DETERMINISTIC(alg)               \</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span> <span class="preprocessor">    (((alg) &amp; PSA_ALG_DSA_DETERMINISTIC_FLAG) != 0)</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span> <span class="preprocessor">#define PSA_ALG_IS_DETERMINISTIC_DSA(alg)                       \</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span> <span class="preprocessor">    (PSA_ALG_IS_DSA(alg) &amp;&amp; PSA_ALG_DSA_IS_DETERMINISTIC(alg))</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span> <span class="preprocessor">#define PSA_ALG_IS_RANDOMIZED_DSA(alg)                          \</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span> <span class="preprocessor">    (PSA_ALG_IS_DSA(alg) &amp;&amp; !PSA_ALG_DSA_IS_DETERMINISTIC(alg))</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span> </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span> </div><div class="line"><a name="l00402"></a><span class="lineno">  402</span> <span class="comment">/* We need to expand the sample definition of this macro from</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span> <span class="comment"> * the API definition. */</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span> <span class="preprocessor">#undef PSA_ALG_IS_HASH_AND_SIGN</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span> <span class="preprocessor">#define PSA_ALG_IS_HASH_AND_SIGN(alg)                                   \</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span> <span class="preprocessor">    (PSA_ALG_IS_RSA_PSS(alg) || PSA_ALG_IS_RSA_PKCS1V15_SIGN(alg) ||    \</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span> <span class="preprocessor">     PSA_ALG_IS_DSA(alg) || PSA_ALG_IS_ECDSA(alg))</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span> <span class="comment"></span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span> <span class="comment"></span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span> <span class="comment">/** \addtogroup attributes</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span> <span class="comment"> * @{</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span> <span class="comment"> */</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span> <span class="comment"></span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span> <span class="comment">/** Custom Diffie-Hellman group.</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span> <span class="comment"> *</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span> <span class="comment"> * For keys of type #PSA_KEY_TYPE_DH_PUBLIC_KEY(#PSA_DH_FAMILY_CUSTOM) or</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span> <span class="comment"> * #PSA_KEY_TYPE_DH_KEY_PAIR(#PSA_DH_FAMILY_CUSTOM), the group data comes</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span> <span class="comment"> * from domain parameters set by psa_set_key_domain_parameters().</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span> <span class="comment"> */</span></div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="group__attributes.html#gab930304ccac92e0729fb5535c87a9fc2">  421</a></span> <span class="preprocessor">#define PSA_DH_FAMILY_CUSTOM             ((psa_dh_family_t) 0x7e)</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span> </div><div class="line"><a name="l00423"></a><span class="lineno">  423</span> <span class="comment"></span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span> <span class="comment">/**</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span> <span class="comment"> * \brief Set domain parameters for a key.</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span> <span class="comment"> *</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span> <span class="comment"> * Some key types require additional domain parameters in addition to</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span> <span class="comment"> * the key type identifier and the key size. Use this function instead</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span> <span class="comment"> * of psa_set_key_type() when you need to specify domain parameters.</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span> <span class="comment"> *</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span> <span class="comment"> * The format for the required domain parameters varies based on the key type.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span> <span class="comment"> *</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span> <span class="comment"> * - For RSA keys (#PSA_KEY_TYPE_RSA_PUBLIC_KEY or #PSA_KEY_TYPE_RSA_KEY_PAIR),</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span> <span class="comment"> *   the domain parameter data consists of the public exponent,</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span> <span class="comment"> *   represented as a big-endian integer with no leading zeros.</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span> <span class="comment"> *   This information is used when generating an RSA key pair.</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span> <span class="comment"> *   When importing a key, the public exponent is read from the imported</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span> <span class="comment"> *   key data and the exponent recorded in the attribute structure is ignored.</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span> <span class="comment"> *   As an exception, the public exponent 65537 is represented by an empty</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span> <span class="comment"> *   byte string.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span> <span class="comment"> * - For DSA keys (#PSA_KEY_TYPE_DSA_PUBLIC_KEY or #PSA_KEY_TYPE_DSA_KEY_PAIR),</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span> <span class="comment"> *   the `Dss-Parms` format as defined by RFC 3279 &amp;sect;2.3.2.</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span> <span class="comment"> *   Dss-Parms ::= SEQUENCE  {</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span> <span class="comment"> *      p       INTEGER,</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span> <span class="comment"> *      q       INTEGER,</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span> <span class="comment"> *      g       INTEGER</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span> <span class="comment"> *   }</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span> <span class="comment"> * - For Diffie-Hellman key exchange keys</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span> <span class="comment"> *   (#PSA_KEY_TYPE_DH_PUBLIC_KEY(#PSA_DH_FAMILY_CUSTOM) or</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span> <span class="comment"> *   #PSA_KEY_TYPE_DH_KEY_PAIR(#PSA_DH_FAMILY_CUSTOM)), the</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span> <span class="comment"> *   `DomainParameters` format as defined by RFC 3279 &amp;sect;2.3.3.</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span> <span class="comment"> *   DomainParameters ::= SEQUENCE {</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span> <span class="comment"> *      p               INTEGER,                    -- odd prime, p=jq +1</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span> <span class="comment"> *      g               INTEGER,                    -- generator, g</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span> <span class="comment"> *      q               INTEGER,                    -- factor of p-1</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span> <span class="comment"> *      j               INTEGER OPTIONAL,           -- subgroup factor</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span> <span class="comment"> *      validationParms ValidationParms OPTIONAL</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span> <span class="comment"> *   }</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span> <span class="comment"> *   ValidationParms ::= SEQUENCE {</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span> <span class="comment"> *      seed            BIT STRING,</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span> <span class="comment"> *      pgenCounter     INTEGER</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span> <span class="comment"> *   }</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span> <span class="comment"> *   ```</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span> <span class="comment"> *</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span> <span class="comment"> * \note This function may allocate memory or other resources.</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span> <span class="comment"> *       Once you have called this function on an attribute structure,</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span> <span class="comment"> *       you must call psa_reset_key_attributes() to free these resources.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span> <span class="comment"> *</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span> <span class="comment"> * \note This is an experimental extension to the interface. It may change</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span> <span class="comment"> *       in future versions of the library.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span> <span class="comment"> *</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span> <span class="comment"> * \param[in,out] attributes    Attribute structure where the specified domain</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span> <span class="comment"> *                              parameters will be stored.</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span> <span class="comment"> *                              If this function fails, the content of</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span> <span class="comment"> *                              \p attributes is not modified.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span> <span class="comment"> * \param type                  Key type (a \c PSA_KEY_TYPE_XXX value).</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span> <span class="comment"> * \param[in] data              Buffer containing the key domain parameters.</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span> <span class="comment"> *                              The content of this buffer is interpreted</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span> <span class="comment"> *                              according to \p type as described above.</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span> <span class="comment"> * \param data_length           Size of the \p data buffer in bytes.</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span> <span class="comment"> *</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span> <span class="comment"> * \retval #PSA_SUCCESS</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span> <span class="comment"> * \retval #PSA_ERROR_INVALID_ARGUMENT</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span> <span class="comment"> * \retval #PSA_ERROR_NOT_SUPPORTED</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span> <span class="comment"> * \retval #PSA_ERROR_INSUFFICIENT_MEMORY</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span> <span class="comment"> */</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span> <a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__attributes.html#ga8909d3f2ee48121ea0dff198276bdd38">psa_set_key_domain_parameters</a>(<a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>                                            <a class="code" href="group__crypto__types.html#ga63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a> type,</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>                                            <span class="keyword">const</span> uint8_t *data,</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>                                            <span class="keywordtype">size_t</span> data_length);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span> <span class="comment"></span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span> <span class="comment">/**</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span> <span class="comment"> * \brief Get domain parameters for a key.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span> <span class="comment"> *</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span> <span class="comment"> * Get the domain parameters for a key with this function, if any. The format</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span> <span class="comment"> * of the domain parameters written to \p data is specified in the</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span> <span class="comment"> * documentation for psa_set_key_domain_parameters().</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span> <span class="comment"> *</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span> <span class="comment"> * \note This is an experimental extension to the interface. It may change</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span> <span class="comment"> *       in future versions of the library.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span> <span class="comment"> *</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span> <span class="comment"> * \param[in] attributes        The key attribute structure to query.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span> <span class="comment"> * \param[out] data             On success, the key domain parameters.</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span> <span class="comment"> * \param data_size             Size of the \p data buffer in bytes.</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span> <span class="comment"> *                              The buffer is guaranteed to be large</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span> <span class="comment"> *                              enough if its size in bytes is at least</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span> <span class="comment"> *                              the value given by</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span> <span class="comment"> *                              PSA_KEY_DOMAIN_PARAMETERS_SIZE().</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span> <span class="comment"> * \param[out] data_length      On success, the number of bytes</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span> <span class="comment"> *                              that make up the key domain parameters data.</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span> <span class="comment"> *</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span> <span class="comment"> * \retval #PSA_SUCCESS</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span> <span class="comment"> * \retval #PSA_ERROR_BUFFER_TOO_SMALL</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span> <span class="comment"> */</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span> <a class="code" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> <a class="code" href="group__attributes.html#gae42b480d8ffa161eb2a0a3e391010347">psa_get_key_domain_parameters</a>(</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>     <span class="keyword">const</span> <a class="code" href="structpsa__key__attributes__s.html">psa_key_attributes_t</a> *attributes,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>     uint8_t *data,</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>     <span class="keywordtype">size_t</span> data_size,</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>     <span class="keywordtype">size_t</span> *data_length);</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span> <span class="comment"></span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span> <span class="comment">/** Safe output buffer size for psa_get_key_domain_parameters().</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span> <span class="comment"> *</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span> <span class="comment"> * This macro returns a compile-time constant if its arguments are</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span> <span class="comment"> * compile-time constants.</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span> <span class="comment"> *</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span> <span class="comment"> * \warning This function may call its arguments multiple times or</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span> <span class="comment"> *          zero times, so you should not pass arguments that contain</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span> <span class="comment"> *          side effects.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span> <span class="comment"> *</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span> <span class="comment"> * \note This is an experimental extension to the interface. It may change</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span> <span class="comment"> *       in future versions of the library.</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span> <span class="comment"> *</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span> <span class="comment"> * \param key_type  A supported key type.</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span> <span class="comment"> * \param key_bits  The size of the key in bits.</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span> <span class="comment"> *</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span> <span class="comment"> * \return If the parameters are valid and supported, return</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span> <span class="comment"> *         a buffer size in bytes that guarantees that</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span> <span class="comment"> *         psa_get_key_domain_parameters() will not fail with</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span> <span class="comment"> *         #PSA_ERROR_BUFFER_TOO_SMALL.</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span> <span class="comment"> *         If the parameters are a valid combination that is not supported</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span> <span class="comment"> *         by the implementation, this macro shall return either a</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span> <span class="comment"> *         sensible size or 0.</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span> <span class="comment"> *         If the parameters are not valid, the</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span> <span class="comment"> *         return value is unspecified.</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span> <span class="comment"> */</span></div><div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="group__attributes.html#gabc5917860076ce1f8c01c4d678c9e989">  549</a></span> <span class="preprocessor">#define PSA_KEY_DOMAIN_PARAMETERS_SIZE(key_type, key_bits)              \</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span> <span class="preprocessor">    (PSA_KEY_TYPE_IS_RSA(key_type) ? sizeof(int) :                      \</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span> <span class="preprocessor">     PSA_KEY_TYPE_IS_DH(key_type) ? PSA_DH_KEY_DOMAIN_PARAMETERS_SIZE(key_bits) : \</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span> <span class="preprocessor">     PSA_KEY_TYPE_IS_DSA(key_type) ? PSA_DSA_KEY_DOMAIN_PARAMETERS_SIZE(key_bits) : \</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span> <span class="preprocessor">     0)</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span> <span class="preprocessor">#define PSA_DH_KEY_DOMAIN_PARAMETERS_SIZE(key_bits)     \</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span> <span class="preprocessor">    (4 + (PSA_BITS_TO_BYTES(key_bits) + 5) * 3 </span><span class="comment">/*without optional parts*/</span><span class="preprocessor">)</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span> <span class="preprocessor">#define PSA_DSA_KEY_DOMAIN_PARAMETERS_SIZE(key_bits)    \</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span> <span class="preprocessor">    (4 + (PSA_BITS_TO_BYTES(key_bits) + 5) * 2 </span><span class="comment">/*p, g*/</span><span class="preprocessor"> + 34 </span><span class="comment">/*q*/</span><span class="preprocessor">)</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span> <span class="comment"></span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span> <span class="comment"></span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span> <span class="comment">/** \defgroup psa_tls_helpers TLS helper functions</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span> <span class="comment"> * @{</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span> <span class="comment"> */</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span> </div><div class="line"><a name="l00565"></a><span class="lineno">  565</span> <span class="preprocessor">#if defined(MBEDTLS_ECP_C)</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span> <span class="preprocessor">#include &lt;mbedtls/ecp.h&gt;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span> <span class="comment"></span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span> <span class="comment">/** Convert an ECC curve identifier from the Mbed TLS encoding to PSA.</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span> <span class="comment"> *</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span> <span class="comment"> * \note This function is provided solely for the convenience of</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span> <span class="comment"> *       Mbed TLS and may be removed at any time without notice.</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span> <span class="comment"> *</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span> <span class="comment"> * \param grpid         An Mbed TLS elliptic curve identifier</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span> <span class="comment"> *                      (`MBEDTLS_ECP_DP_xxx`).</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span> <span class="comment"> * \param[out] bits     On success, the bit size of the curve.</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span> <span class="comment"> *</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span> <span class="comment"> * \return              The corresponding PSA elliptic curve identifier</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span> <span class="comment"> *                      (`PSA_ECC_FAMILY_xxx`).</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span> <span class="comment"> * \return              \c 0 on failure (\p grpid is not recognized).</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span> <span class="comment"> */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span> <span class="keyword">static</span> <span class="keyword">inline</span> <a class="code" href="group__crypto__types.html#gae7ad3569cb9c91b1ebe59a056edb2fc6">psa_ecc_family_t</a> mbedtls_ecc_group_to_psa( mbedtls_ecp_group_id grpid,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>                                                         <span class="keywordtype">size_t</span> *bits )</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span> {</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>     <span class="keywordflow">switch</span>( grpid )</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>     {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP192R1:</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>             *bits = 192;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">PSA_ECC_FAMILY_SECP_R1</a> );</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP224R1:</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>             *bits = 224;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">PSA_ECC_FAMILY_SECP_R1</a> );</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP256R1:</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>             *bits = 256;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">PSA_ECC_FAMILY_SECP_R1</a> );</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP384R1:</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>             *bits = 384;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">PSA_ECC_FAMILY_SECP_R1</a> );</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP521R1:</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>             *bits = 521;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">PSA_ECC_FAMILY_SECP_R1</a> );</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_BP256R1:</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>             *bits = 256;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#gac1643f1baf38b30d07c20a6eac697f15">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a> );</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_BP384R1:</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>             *bits = 384;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#gac1643f1baf38b30d07c20a6eac697f15">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a> );</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_BP512R1:</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>             *bits = 512;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#gac1643f1baf38b30d07c20a6eac697f15">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a> );</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_CURVE25519:</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>             *bits = 255;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a> );</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP192K1:</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>             *bits = 192;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga5cf2405c6e23b93cea0aac092d1aa0f7">PSA_ECC_FAMILY_SECP_K1</a> );</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP224K1:</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>             *bits = 224;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga5cf2405c6e23b93cea0aac092d1aa0f7">PSA_ECC_FAMILY_SECP_K1</a> );</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_SECP256K1:</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>             *bits = 256;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga5cf2405c6e23b93cea0aac092d1aa0f7">PSA_ECC_FAMILY_SECP_K1</a> );</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>         <span class="keywordflow">case</span> MBEDTLS_ECP_DP_CURVE448:</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>             *bits = 448;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>             <span class="keywordflow">return</span>( <a class="code" href="group__crypto__types.html#ga1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a> );</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>         <span class="keywordflow">default</span>:</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>             *bits = 0;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>             <span class="keywordflow">return</span>( 0 );</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>     }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span> }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span> <span class="comment"></span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span> <span class="comment">/** Convert an ECC curve identifier from the PSA encoding to Mbed TLS.</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span> <span class="comment"> *</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span> <span class="comment"> * \note This function is provided solely for the convenience of</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span> <span class="comment"> *       Mbed TLS and may be removed at any time without notice.</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span> <span class="comment"> *</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span> <span class="comment"> * \param curve         A PSA elliptic curve identifier</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span> <span class="comment"> *                      (`PSA_ECC_FAMILY_xxx`).</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span> <span class="comment"> * \param byte_length   The byte-length of a private key on \p curve.</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span> <span class="comment"> *</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span> <span class="comment"> * \return              The corresponding Mbed TLS elliptic curve identifier</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span> <span class="comment"> *                      (`MBEDTLS_ECP_DP_xxx`).</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span> <span class="comment"> * \return              #MBEDTLS_ECP_DP_NONE if \c curve is not recognized.</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span> <span class="comment"> * \return              #MBEDTLS_ECP_DP_NONE if \p byte_length is not</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span> <span class="comment"> *                      correct for \p curve.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span> <span class="comment"> */</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span> mbedtls_ecp_group_id mbedtls_ecc_group_of_psa( <a class="code" href="group__crypto__types.html#gae7ad3569cb9c91b1ebe59a056edb2fc6">psa_ecc_family_t</a> curve,</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>                                                <span class="keywordtype">size_t</span> byte_length );</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span> <span class="preprocessor">#endif </span><span class="comment">/* MBEDTLS_ECP_C */</span><span class="preprocessor"></span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span> <span class="comment"></span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span> <span class="comment">/**@}*/</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span> </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span> <span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span> }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span> </div><div class="line"><a name="l00656"></a><span class="lineno">  656</span> <span class="preprocessor">#endif </span><span class="comment">/* PSA_CRYPTO_EXTRA_H */</span><span class="preprocessor"></span></div><div class="ttc" id="structmbedtls__psa__stats__s_html_ad3f22a4dd89f132af2cada7ea68ae502"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#ad3f22a4dd89f132af2cada7ea68ae502">mbedtls_psa_stats_s::empty_slots</a></div><div class="ttdeci">size_t empty_slots</div><div class="ttdoc">Number of slots that are not used for anything. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00233">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:233</a></div></div>
<div class="ttc" id="structpsa__key__attributes__s_html"><div class="ttname"><a href="structpsa__key__attributes__s.html">psa_key_attributes_s</a></div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2mbedtls_2crypto__struct_8h_source.html#l00352">TARGET_MBED_PSA_SRV/mbedtls/crypto_struct.h:352</a></div></div>
<div class="ttc" id="group__crypto__types_html_ga1f624c5cdaf25b21287af33024e1aff8"><div class="ttname"><a href="group__crypto__types.html#ga1f624c5cdaf25b21287af33024e1aff8">PSA_ECC_FAMILY_MONTGOMERY</a></div><div class="ttdeci">#define PSA_ECC_FAMILY_MONTGOMERY</div><div class="ttdoc">Curve25519 and Curve448. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__values_8h_source.html#l00530">TARGET_MBED_PSA_SRV/inc/psa/crypto_values.h:530</a></div></div>
<div class="ttc" id="group__attributes_html_gaffa134b74aa52aa3ed9397fcab4005aa"><div class="ttname"><a href="group__attributes.html#gaffa134b74aa52aa3ed9397fcab4005aa">psa_set_key_enrollment_algorithm</a></div><div class="ttdeci">static void psa_set_key_enrollment_algorithm(psa_key_attributes_t *attributes, psa_algorithm_t alg2)</div><div class="ttdoc">Declare the enrollment algorithm for a key. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00066">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:66</a></div></div>
<div class="ttc" id="group__key__lifetimes_html_ga11e986351c65bd3dc3c0fe2cd9926e4b"><div class="ttname"><a href="group__key__lifetimes.html#ga11e986351c65bd3dc3c0fe2cd9926e4b">psa_key_id_t</a></div><div class="ttdeci">uint32_t psa_key_id_t</div><div class="ttdoc">Encoding of identifiers of persistent keys. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__types_8h_source.html#l00231">TARGET_MBED_PSA_SRV/inc/psa/crypto_types.h:231</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_ae9e86c6d3f9b74feaece926be8433ee4"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#ae9e86c6d3f9b74feaece926be8433ee4">mbedtls_psa_stats_s::cache_slots</a></div><div class="ttdeci">size_t cache_slots</div><div class="ttdoc">Number of slots that contain cache data. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00231">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:231</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_a1800174c9a19f8f6c76699bec5cfc674"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#a1800174c9a19f8f6c76699bec5cfc674">mbedtls_psa_stats_s::half_filled_slots</a></div><div class="ttdeci">size_t half_filled_slots</div><div class="ttdoc">Number of slots which are occupied, but do not contain key material yet. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00229">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:229</a></div></div>
<div class="ttc" id="group__attributes_html_ga8909d3f2ee48121ea0dff198276bdd38"><div class="ttname"><a href="group__attributes.html#ga8909d3f2ee48121ea0dff198276bdd38">psa_set_key_domain_parameters</a></div><div class="ttdeci">psa_status_t psa_set_key_domain_parameters(psa_key_attributes_t *attributes, psa_key_type_t type, const uint8_t *data, size_t data_length)</div><div class="ttdoc">Set domain parameters for a key. </div></div>
<div class="ttc" id="group__crypto__types_html_gac1643f1baf38b30d07c20a6eac697f15"><div class="ttname"><a href="group__crypto__types.html#gac1643f1baf38b30d07c20a6eac697f15">PSA_ECC_FAMILY_BRAINPOOL_P_R1</a></div><div class="ttdeci">#define PSA_ECC_FAMILY_BRAINPOOL_P_R1</div><div class="ttdoc">Brainpool P random curves. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__values_8h_source.html#l00518">TARGET_MBED_PSA_SRV/inc/psa/crypto_values.h:518</a></div></div>
<div class="ttc" id="group__se__init_html_ga90828ba6e282dd39260c81af68532e1d"><div class="ttname"><a href="group__se__init.html#ga90828ba6e282dd39260c81af68532e1d">psa_key_slot_number_t</a></div><div class="ttdeci">uint64_t psa_key_slot_number_t</div><div class="ttdoc">An internal designation of a key slot between the core part of the PSA Crypto implementation and the ...</div><div class="ttdef"><b>Definition:</b> <a href="crypto__se__driver_8h_source.html#l00148">crypto_se_driver.h:148</a></div></div>
<div class="ttc" id="group__attributes_html_ga39803b62a97198cf630854db9b53c588"><div class="ttname"><a href="group__attributes.html#ga39803b62a97198cf630854db9b53c588">psa_get_key_enrollment_algorithm</a></div><div class="ttdeci">static psa_algorithm_t psa_get_key_enrollment_algorithm(const psa_key_attributes_t *attributes)</div><div class="ttdoc">Retrieve the enrollment algorithm policy from key attributes. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00079">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:79</a></div></div>
<div class="ttc" id="group__crypto__types_html_gac2e4d47f1300d73c2f829a6d99252d69"><div class="ttname"><a href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a></div><div class="ttdeci">uint32_t psa_algorithm_t</div><div class="ttdoc">Encoding of a cryptographic algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__types_8h_source.html#l00098">TARGET_MBED_PSA_SRV/inc/psa/crypto_types.h:98</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_a29fbe18105fcd97a86a9cab555b18fa8"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#a29fbe18105fcd97a86a9cab555b18fa8">mbedtls_psa_stats_s::external_slots</a></div><div class="ttdeci">size_t external_slots</div><div class="ttdoc">Number of slots containing a reference to a key in a secure element. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00226">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:226</a></div></div>
<div class="ttc" id="group__crypto__types_html_ga48bb340b5544ba617b0f5b89542665a7"><div class="ttname"><a href="group__crypto__types.html#ga48bb340b5544ba617b0f5b89542665a7">PSA_ECC_FAMILY_SECP_R1</a></div><div class="ttdeci">#define PSA_ECC_FAMILY_SECP_R1</div><div class="ttdoc">SEC random curves over prime fields. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__values_8h_source.html#l00477">TARGET_MBED_PSA_SRV/inc/psa/crypto_values.h:477</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_ad6c6b04feecbcd99da1d83d79ee04ef0"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#ad6c6b04feecbcd99da1d83d79ee04ef0">mbedtls_psa_stats_s::persistent_slots</a></div><div class="ttdeci">size_t persistent_slots</div><div class="ttdoc">Number of slots containing key material for a key which is in internal persistent storage...</div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00223">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:223</a></div></div>
<div class="ttc" id="group__crypto__types_html_ga63fce6880ca5933b5d6baa257febf1f6"><div class="ttname"><a href="group__crypto__types.html#ga63fce6880ca5933b5d6baa257febf1f6">psa_key_type_t</a></div><div class="ttdeci">uint16_t psa_key_type_t</div><div class="ttdoc">Encoding of a key type. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__types_8h_source.html#l00066">TARGET_MBED_PSA_SRV/inc/psa/crypto_types.h:66</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_a9ca5dfbe9c5e8bf7338243a0c7f07640"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#a9ca5dfbe9c5e8bf7338243a0c7f07640">mbedtls_psa_stats_s::locked_slots</a></div><div class="ttdeci">size_t locked_slots</div><div class="ttdoc">Number of slots that are locked. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00235">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:235</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_a1bdb5b67e8c73b7c109ed9ee2c0ab39b"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#a1bdb5b67e8c73b7c109ed9ee2c0ab39b">mbedtls_psa_stats_s::volatile_slots</a></div><div class="ttdeci">size_t volatile_slots</div><div class="ttdoc">Number of slots containing key material for a volatile key. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00220">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:220</a></div></div>
<div class="ttc" id="group__attributes_html_gae42b480d8ffa161eb2a0a3e391010347"><div class="ttname"><a href="group__attributes.html#gae42b480d8ffa161eb2a0a3e391010347">psa_get_key_domain_parameters</a></div><div class="ttdeci">psa_status_t psa_get_key_domain_parameters(const psa_key_attributes_t *attributes, uint8_t *data, size_t data_size, size_t *data_length)</div><div class="ttdoc">Get domain parameters for a key. </div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_acc2fad2f6d3c10c28d61c25d017afe9a"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#acc2fad2f6d3c10c28d61c25d017afe9a">mbedtls_psa_stats_s::max_open_external_key_id</a></div><div class="ttdeci">psa_key_id_t max_open_external_key_id</div><div class="ttdoc">Largest key id value among open keys in secure elements. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00239">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:239</a></div></div>
<div class="ttc" id="group__crypto__types_html_ga5cf2405c6e23b93cea0aac092d1aa0f7"><div class="ttname"><a href="group__crypto__types.html#ga5cf2405c6e23b93cea0aac092d1aa0f7">PSA_ECC_FAMILY_SECP_K1</a></div><div class="ttdeci">#define PSA_ECC_FAMILY_SECP_K1</div><div class="ttdoc">SEC Koblitz curves over prime fields. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__values_8h_source.html#l00467">TARGET_MBED_PSA_SRV/inc/psa/crypto_values.h:467</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html_aae936233b2c364553e62e72f90bb2f8b"><div class="ttname"><a href="structmbedtls__psa__stats__s.html#aae936233b2c364553e62e72f90bb2f8b">mbedtls_psa_stats_s::max_open_internal_key_id</a></div><div class="ttdeci">psa_key_id_t max_open_internal_key_id</div><div class="ttdoc">Largest key id value among open keys in internal persistent storage. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00237">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:237</a></div></div>
<div class="ttc" id="group__crypto__types_html_gae7ad3569cb9c91b1ebe59a056edb2fc6"><div class="ttname"><a href="group__crypto__types.html#gae7ad3569cb9c91b1ebe59a056edb2fc6">psa_ecc_family_t</a></div><div class="ttdeci">uint8_t psa_ecc_family_t</div><div class="ttdoc">The type of PSA elliptic curve family identifiers. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__types_8h_source.html#l00077">TARGET_MBED_PSA_SRV/inc/psa/crypto_types.h:77</a></div></div>
<div class="ttc" id="group__error_html_ga05676e70ba5c6a7565aff3c36677c1f9"><div class="ttname"><a href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a></div><div class="ttdeci">int32_t psa_status_t</div><div class="ttdoc">Function return status. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__types_8h_source.html#l00055">TARGET_MBED_PSA_SRV/inc/psa/crypto_types.h:55</a></div></div>
<div class="ttc" id="structmbedtls__psa__stats__s_html"><div class="ttname"><a href="structmbedtls__psa__stats__s.html">mbedtls_psa_stats_s</a></div><div class="ttdoc">Statistics about resource consumption related to the PSA keystore. </div><div class="ttdef"><b>Definition:</b> <a href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html#l00217">TARGET_MBED_PSA_SRV/inc/psa/crypto_extra.h:217</a></div></div>
</div><!-- fragment --></div><!-- contents -->
        
    


        
<footer class="global-footer">
    <ul class="global-footer-media global-footer-row">
        <li>
            <a class="footer-media-icon" title="Twitter" href="https://twitter.com/ArmSoftwareDev">
                <span class="fab fa-twitter-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Twitter</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="YouTube" href="https://www.youtube.com/c/ArmSoftwareDevelopers">
                <span class="fab fa-youtube-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">YouTube</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Forum" href="http://forums.mbed.com/">
                <span class="fas fa-comments fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Forum</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Blog" href="http://blog.mbed.com/">
                <span class="fas fa-pen-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Blog</span>
            </a>
        </li>
    </ul>

    <div class="global-footer-copyright global-footer-row">
        <div class="copyright-statement">Copyright © <script>document.write(new Date().getFullYear());</script> Arm Limited (or its affiliates).</div>
        <ul class="copyright-links">
            <li><a href="https://os.mbed.com/">Home</a></li>
            <li><a href="https://www.arm.com/company/policies/terms-and-conditions">Website Terms</a></li>
            <li><a href="https://www.arm.com/company/policies/privacy">Privacy</a></li>
            <li><a href="https://www.arm.com/company/policies/cookies">Cookies</a></li>
            <li><a href="http://www.arm.com/company/policies/trademarks">Trademarks</a></li>
        </ul>
    </div>
</footer>



    <div id="cookiemodule">
    <h5>Important Information for this Arm website</h5>
    <div id="cookiecontent">
        <p>
            This site uses cookies to store information on your computer.
            By continuing to use our site, you consent to our cookies.
            If you are not happy with the use of these cookies, please review our
            <a href="https://www.arm.com/company/policies/cookies">Cookie Policy</a>
            to learn how they can be disabled.
            By disabling cookies, some features of the site will not work.
        </p>
        <button id="acceptcookie">Accept and hide this message</button>
    </div>
</div>
<script src="../../../../static/js/cookie_law.js"></script>




    </body>

<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto__extra_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:22:31 GMT -->
</html>
