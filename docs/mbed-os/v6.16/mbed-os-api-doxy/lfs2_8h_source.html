<!DOCTYPE html>
<html>
    
<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/lfs2_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:24:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        
        <meta charset="utf-8"/>
        <title>Mbed OS Reference | lfs2.h Source File</title>
        <link href="../static/css/vendor/foundation-6.2.4.min.mbed-cache-4c48f6c816971070eb1e4eca75f0ec30.css" rel="stylesheet"/>
        <link href="search/search.css" rel="stylesheet"/>
        <link href="../static/css/app.mbed-cache-a44289fe9f5ca07036a335d6ad7ed8ad.css" rel="stylesheet"/>
        <script src="../static/js/vendor/jquery-3.2.1.min.mbed-cache-c9f5aeeca3ad37bf2aa006139b935f0a.js"></script>
        <script src="dynsections.js"></script>
        <script src="search/searchdata.js"></script>
        <script src="search/search.js"></script>
        <script>
            $(document).ready(function() {
                init_search();
            });
        </script>
    
        

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1447836-8');
ga('require', 'GTM-WXMLD4S')
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl+'&gtm_auth=SMYNPwM0ICsV00c1ZHETqQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M6FZ495');</script>


    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:971746,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>



<!-- Favicons -->
<link rel="apple-touch-icon" sizes="57x57" href="../../../../static/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../../static/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../../static/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../../static/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../../static/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../../static/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../../../static/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../../../static/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../../../static/img/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../../../static/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../static/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../../../static/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../static/img/favicons/favicon-16x16.png">
<link rel="manifest" href="https://os.mbed.com/static/img/favicons/manifest.json">
<link rel="shortcut icon" href="https://os.mbed.com/static/img/favicon.ico?">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">

<link rel="stylesheet" href="../../../../static/CACHE/css/output.811e2930ab34.css" type="text/css">

<link href="../../../../static/docs/css/doc_viewer.css" rel="stylesheet">
<link href="../../../../static/fonts.css" rel="stylesheet">
<link href="../../../../static/docs-nav-and-footer1b26.css?v2" rel="stylesheet">


<link rel="canonical" href="lfs2_8h_source.html">
<script src="../../../../static/mbed-nav-vertical-menu.js"></script>


    </head>
    <body>
        








<div class="mbed-nav">
    <div class="mbed-nav__mobile-menu-control">
        <i class="mbed-nav__mobile-menu-control-open fas fa-bars fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-close fas fa-times is-hidden fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-back fas fa-angle-left is-hidden fa-fw"></i>
    </div>
    <div class="mbed-nav__logo">
        <a href="https://os.mbed.com/">
            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#logo"></use></svg>
        </a>
    </div>
    <div class="mbed-nav__menu">

        <!-- Main menu -->
        <nav class="mbed-nav__main-menu">
            <ul class="mbed-nav__dropdown-menu">
                <li class="has-dropdown">
                    Overview

                    <div class="mbed-nav__dropdown-menu-content">

                        <!-- Overview dropdown menu -->
                        <div class="mbed-nav__overview-menu">
                            <section>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <div>
                                                <p>Mbed OS</p>
                                                <p>The open source OS for Cortex-M devices</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link-detail">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <div>
                                                <p>Keil Studio Cloud</p>
                                                <p>Arm's IDE for IoT, embedded and Mbed development</p>
                                            </div>
                                         </a>
                                     </li>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <div>
                                                <p>Mbed Studio</p>
                                                <p>Download the desktop IDE for Mbed OS</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link-detail">

                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <div>
                                               <p>Mbed CLI</p>
                                               <p>Command line access to Mbed tools and services</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Security and Connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <div>
                                                <p>Mbed TLS and Mbed Crypto</p>
                                                <p>Industry standard TLS stack and crypto library</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <div>
                                                <p>Connectivity</p>
                                                <p>BLE, WiFi, Cellular, LoRaWAN and more</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </li>
                <li class="has-dropdown">
                    Hardware

                    <!-- Hardware dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__hardware-dropdown">
                            <ul class="mbed-nav__hardware-menu">
                                <li>
                                    <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                        <div>
                                            <p>Boards</p>
                                            <p>Build your Mbed projects with development boards for Arm Cortex processors and MCUs</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                        <div>
                                            <p>Modules</p>
                                            <p>Modules include a MCU, connectivity and onboard memory, making them ideal for designing IoT products for mass production</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                        <div>
                                            <p>Components</p>
                                            <p>The component database hosts libraries for different sensors, actuators, radios, inputs, middleware and IoT services</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                        <div>
                                            <p>Hardware overview & Mbed Enabled</p>
                                            <p>Learn about hardware support for Mbed, as well as the Mbed Enabled program, which identifies Mbed compatible products</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                        <div>
                                            <p>Mbed HDK</p>
                                            <p>Reference designs, schematics and board layouts to develop production hardware and Mbed-compatible development boards</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li class="has-dropdown">
                    Documentation

                    <!-- Documentation dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__documentation-dropdown">
                            <ul class="mbed-nav__documentation-menu">
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a>
                                </li>
                                <li>
                                    <a
                                        href="https://developer.arm.com/documentation/102497/latest/Arm-Keil-Studio-Cloud">
                                        Keil Studio
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li class="has-dropdown">
                    Community

                    <!-- Community dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__community-dropdown">
                            <ul class="mbed-nav__community-menu">
                                <li>
                                    <a href="https://forums.mbed.com/">Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a>
                                </li>
                                <li>
                                    <a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/support/">Report a problem</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://os.mbed.com/blog/">Blog</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="mbed-nav__user-controls">
        <div class="mbed-nav__user-controls-top">
            <div class="mbed-nav__search">
                <form id="mbed-nav__search-box" class="is-hidden" action="https://os.mbed.com/search" method="GET">
                    <div class="mbed-nav__search-box">
                        <input type="search" name="q" placeholder="Search...">
                        <button type="submit">
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                        </button>
                    </div>
                </form>
                <i class="mbed-nav__search-close fas fa-times is-hidden"></i>
                <svg class="mbed-nav__search-open stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
            </div>
            <a class="mbed-nav__cta" href="https://studio.keil.arm.com/mbed" target="_blank">
                Keil Studio Cloud
            </a>

            
                
                <nav class="mbed-nav__logged-out-nav">
                    <ul class="mbed-nav__dropdown-menu">
                        <li>
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#profile"></use></svg>

                            <!-- Logged out dropdown menu -->
                            <div class="mbed-nav__dropdown-menu-content">
                                <div class="mbed-nav__logged-out-dropdown">
                                    <ul class="mbed-nav__logged-out-menu">
                                        <li><a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/lfs2_8h_source.html">Log in or Sign up</a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </nav>
                
            
        </div>
    </div>
    <div class="mbed-nav__spacer"></div>
</div>
<div class="mbed-nav__mobile-menu-cover is-hidden">
    <div class="mbed-nav__mobile-menu">

        <div id="mbed-nav__main-menu-mobile">
            <div class="mbed-nav__user-controls-mobile">
                <div class="mbed-nav__user-controls-top-mobile">
                    <form action="https://os.mbed.com/search" method="GET">
                        <div class="mbed-nav__search-box mbed-nav__search-box--light">
                            <input type="search" name="q" placeholder="Search...">
                            <button type="submit">
                                <svg class="stroke-dark-grey"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                            </button>
                        </div>
                    </form>
                    
                        
                        <a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/lfs2_8h_source.html">Log in or Sign up</a>
                        
                    
                </div>
            </div>

            <ul class="mbed-nav__side-menu">
                <li>
                    <input type="checkbox" name="accordion-toggle" id="overview-accordion">
                    <label for="overview-accordion">Overview</label>
                    <div class="accordion_content">
                        <ul class="overview-menu-mobile">
                            <li>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <p>Mbed OS</p>
                                        </a>
                                    </li>
                                    

                                </ul>
                            </li>
                            <li>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <p>Mbed Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <p>Keil Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <p>Mbed CLI</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Security and connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <p>Mbed TLS and Mbed Crypto</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <p>Connectivity</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="hardware-accordion">
                    <label for="hardware-accordion">Hardware</label>
                    <div class="accordion_content">
                        <ul>
                            <li>
                                <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                    <p>Boards</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                    <p>Modules</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                    <p>Components</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                    <p>Hardware overview & Mbed Enabled</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                    <p>Mbed HDK</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="documentation-accordion">
                    <label for="documentation-accordion">Documentation</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a></li>
                            <li>
                              <a
                                href="https://developer.arm.com/documentation/102497/1-5/Arm-Keil-Studio/?utm_source=mbed_com&amp;utm_medium=nav_docs_link&amp;utm_campaign=mbed_com_promo">
                                Keil Studio
                              </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="community-accordion">
                    <label for="community-accordion">Community</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://forums.mbed.com/">Forum</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a></li>
                            <li><a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a></li>
                            <li><a href="https://os.mbed.com/support/">Report a problem</a></li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/blog/">Blog</a></li>
            </ul>
        </div>

        
    </div>
</div>



<div class="version-picker-container">
    
    <select class="version-picker" onchange="goToVersion(this.value)">
        
            <option
                value="v6.16"
                selected
            >
                v6.16
            </option>
        
            <option
                value="v6.15"
                
            >
                v6.15
            </option>
        
            <option
                value="v6.14"
                
            >
                v6.14
            </option>
        
            <option
                value="v6.13"
                
            >
                v6.13
            </option>
        
            <option
                value="v6.12"
                
            >
                v6.12
            </option>
        
            <option
                value="v6.11"
                
            >
                v6.11
            </option>
        
            <option
                value="v6.10"
                
            >
                v6.10
            </option>
        
            <option
                value="v6.9"
                
            >
                v6.9
            </option>
        
            <option
                value="v6.8"
                
            >
                v6.8
            </option>
        
            <option
                value="v6.7"
                
            >
                v6.7
            </option>
        
            <option
                value="v6.6"
                
            >
                v6.6
            </option>
        
            <option
                value="v6.5"
                
            >
                v6.5
            </option>
        
            <option
                value="v5.15"
                
            >
                v5.15
            </option>
        
    </select>
    

    <div class="contact-us">
        Mistake on this page?
        
            <br>
            <a href="https://github.com/ARMmbed/mbed-os-5-docs/issues">
                Report an issue in GitHub
                <i class="fab fa-github"></i>
            </a>
            or
            <a href="mailto:mbed-support@arm.com">
                email us
                <i class="fas fa-envelope"></i>
            </a>
        
    </div>
</div>

<script>
    function goToVersion(version) {
        window.location.href = window.location.href.replace(
            "v6.16",
            version
        )
    }
</script>

        
        <div class="topbar" id="top">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div class="tabs" id="navrow1">
    <ul class="tablist">
      <li><a href="index.html"><span>Main Page</span></a></li>
      <li><a href="pages.html"><span>Related Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div class="MSearchBoxInactive" id="MSearchBox">
        <span class="left">
          <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png"/>
          <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
          </span><span class="right">
            <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png"/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2" id="navrow2">
    <ul class="tablist">
      <li><a href="files.html"><span>File List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="navpath" id="nav-path">
  <ul>
<li class="navelem"><a class="el" href="dir_5fdebfbd0a4b5643a5e85bf3c8b1558b.html">mbed-os</a></li><li class="navelem"><a class="el" href="dir_80349e94800a79a1c710cf3d270cb12e.html">storage</a></li><li class="navelem"><a class="el" href="dir_ac73eca27924dbea0696e9dea05b9067.html">filesystem</a></li><li class="navelem"><a class="el" href="dir_1725f8e3c58acbe0aa061d1a5d3af32f.html">littlefsv2</a></li><li class="navelem"><a class="el" href="dir_c64ff0388737b2b71057e42024acf0b8.html">littlefs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lfs2.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> <span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> <span class="comment"> * The little filesystem</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span> <span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span> <span class="comment"> * Copyright (c) 2017, Arm Limited. All rights reserved.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span> <span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span> <span class="comment"> */</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span> <span class="preprocessor">#ifndef LFS2_H</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span> <span class="preprocessor">#define LFS2_H</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span> </div><div class="line"><a name="l00010"></a><span class="lineno">   10</span> <span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span> <span class="preprocessor">#include &lt;stdbool.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span> </div><div class="line"><a name="l00013"></a><span class="lineno">   13</span> <span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span> <span class="keyword">extern</span> <span class="stringliteral">"C"</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span> {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span> </div><div class="line"><a name="l00018"></a><span class="lineno">   18</span> <span class="comment"></span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span> <span class="comment">/// Version info ///</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span> <span class="comment"></span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span> <span class="comment">// Software library version</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span> <span class="comment">// Major (top-nibble), incremented on backwards incompatible changes</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span> <span class="comment">// Minor (bottom-nibble), incremented on feature additions</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span> <span class="preprocessor">#define LFS2_VERSION 0x00020002</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span> <span class="preprocessor">#define LFS2_VERSION_MAJOR (0xffff &amp; (LFS2_VERSION &gt;&gt; 16))</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span> <span class="preprocessor">#define LFS2_VERSION_MINOR (0xffff &amp; (LFS2_VERSION &gt;&gt;  0))</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span> </div><div class="line"><a name="l00028"></a><span class="lineno">   28</span> <span class="comment">// Version of On-disk data structures</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span> <span class="comment">// Major (top-nibble), incremented on backwards incompatible changes</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span> <span class="comment">// Minor (bottom-nibble), incremented on feature additions</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span> <span class="preprocessor">#define LFS2_DISK_VERSION 0x00020000</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span> <span class="preprocessor">#define LFS2_DISK_VERSION_MAJOR (0xffff &amp; (LFS2_DISK_VERSION &gt;&gt; 16))</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span> <span class="preprocessor">#define LFS2_DISK_VERSION_MINOR (0xffff &amp; (LFS2_DISK_VERSION &gt;&gt;  0))</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span> </div><div class="line"><a name="l00035"></a><span class="lineno">   35</span> <span class="comment"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span> <span class="comment">/// Definitions ///</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span> <span class="comment"></span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span> <span class="comment">// Type definitions</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span> <span class="keyword">typedef</span> uint32_t lfs2_size_t;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span> <span class="keyword">typedef</span> uint32_t lfs2_off_t;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span> </div><div class="line"><a name="l00042"></a><span class="lineno">   42</span> <span class="keyword">typedef</span> int32_t  lfs2_ssize_t;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span> <span class="keyword">typedef</span> int32_t  lfs2_soff_t;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span> </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span> <span class="keyword">typedef</span> uint32_t lfs2_block_t;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span> </div><div class="line"><a name="l00047"></a><span class="lineno">   47</span> <span class="comment">// Maximum name size in bytes, may be redefined to reduce the size of the</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span> <span class="comment">// info struct. Limited to &lt;= 1022. Stored in superblock and must be</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span> <span class="comment">// respected by other littlefs drivers.</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span> <span class="preprocessor">#ifndef LFS2_NAME_MAX</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span> <span class="preprocessor">#define LFS2_NAME_MAX 255</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span> </div><div class="line"><a name="l00054"></a><span class="lineno">   54</span> <span class="comment">// Maximum size of a file in bytes, may be redefined to limit to support other</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span> <span class="comment">// drivers. Limited on disk to &lt;= 4294967296. However, above 2147483647 the</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span> <span class="comment">// functions lfs2_file_seek, lfs2_file_size, and lfs2_file_tell will return</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span> <span class="comment">// incorrect values due to using signed integers. Stored in superblock and</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span> <span class="comment">// must be respected by other littlefs drivers.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span> <span class="preprocessor">#ifndef LFS2_FILE_MAX</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span> <span class="preprocessor">#define LFS2_FILE_MAX 2147483647</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span> </div><div class="line"><a name="l00063"></a><span class="lineno">   63</span> <span class="comment">// Maximum size of custom attributes in bytes, may be redefined, but there is</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span> <span class="comment">// no real benefit to using a smaller LFS2_ATTR_MAX. Limited to &lt;= 1022.</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span> <span class="preprocessor">#ifndef LFS2_ATTR_MAX</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span> <span class="preprocessor">#define LFS2_ATTR_MAX 1022</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span> </div><div class="line"><a name="l00069"></a><span class="lineno">   69</span> <span class="comment">// Possible error codes, these are negative to allow</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span> <span class="comment">// valid positive return values</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span> <span class="keyword">enum</span> lfs2_error {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>     LFS2_ERR_OK          = 0,    <span class="comment">// No error</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>     LFS2_ERR_IO          = -5,   <span class="comment">// Error during device operation</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>     LFS2_ERR_CORRUPT     = -84,  <span class="comment">// Corrupted</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>     LFS2_ERR_NOENT       = -2,   <span class="comment">// No directory entry</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>     LFS2_ERR_EXIST       = -17,  <span class="comment">// Entry already exists</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>     LFS2_ERR_NOTDIR      = -20,  <span class="comment">// Entry is not a dir</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>     LFS2_ERR_ISDIR       = -21,  <span class="comment">// Entry is a dir</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>     LFS2_ERR_NOTEMPTY    = -39,  <span class="comment">// Dir is not empty</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>     LFS2_ERR_BADF        = -9,   <span class="comment">// Bad file number</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>     LFS2_ERR_FBIG        = -27,  <span class="comment">// File too large</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>     LFS2_ERR_INVAL       = -22,  <span class="comment">// Invalid parameter</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>     LFS2_ERR_NOSPC       = -28,  <span class="comment">// No space left on device</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>     LFS2_ERR_NOMEM       = -12,  <span class="comment">// No more memory available</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>     LFS2_ERR_NOATTR      = -61,  <span class="comment">// No data/attr available</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>     LFS2_ERR_NAMETOOLONG = -36,  <span class="comment">// File name too long</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span> };</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span> </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span> <span class="comment">// File types</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span> <span class="keyword">enum</span> lfs2_type {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>     <span class="comment">// file types</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>     LFS2_TYPE_REG            = 0x001,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>     LFS2_TYPE_DIR            = 0x002,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span> </div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>     <span class="comment">// internally used types</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>     LFS2_TYPE_SPLICE         = 0x400,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>     LFS2_TYPE_NAME           = 0x000,</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>     LFS2_TYPE_STRUCT         = 0x200,</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>     LFS2_TYPE_USERATTR       = 0x300,</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>     LFS2_TYPE_FROM           = 0x100,</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>     LFS2_TYPE_TAIL           = 0x600,</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>     LFS2_TYPE_GLOBALS        = 0x700,</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>     LFS2_TYPE_CRC            = 0x500,</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span> </div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>     <span class="comment">// internally used type specializations</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>     LFS2_TYPE_CREATE         = 0x401,</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>     LFS2_TYPE_DELETE         = 0x4ff,</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>     LFS2_TYPE_SUPERBLOCK     = 0x0ff,</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>     LFS2_TYPE_DIRSTRUCT      = 0x200,</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>     LFS2_TYPE_CTZSTRUCT      = 0x202,</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>     LFS2_TYPE_INLINESTRUCT   = 0x201,</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>     LFS2_TYPE_SOFTTAIL       = 0x600,</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>     LFS2_TYPE_HARDTAIL       = 0x601,</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>     LFS2_TYPE_MOVESTATE      = 0x7ff,</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span> </div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>     <span class="comment">// internal chip sources</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>     LFS2_FROM_NOOP           = 0x000,</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>     LFS2_FROM_MOVE           = 0x101,</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>     LFS2_FROM_USERATTRS      = 0x102,</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span> };</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span> </div><div class="line"><a name="l00122"></a><span class="lineno">  122</span> <span class="comment">// File open flags</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span> <span class="keyword">enum</span> lfs2_open_flags {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>     <span class="comment">// open flags</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>     LFS2_O_RDONLY = 1,         <span class="comment">// Open a file as read only</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>     LFS2_O_WRONLY = 2,         <span class="comment">// Open a file as write only</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>     LFS2_O_RDWR   = 3,         <span class="comment">// Open a file as read and write</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>     LFS2_O_CREAT  = 0x0100,    <span class="comment">// Create a file if it does not exist</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>     LFS2_O_EXCL   = 0x0200,    <span class="comment">// Fail if a file already exists</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>     LFS2_O_TRUNC  = 0x0400,    <span class="comment">// Truncate the existing file to zero size</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>     LFS2_O_APPEND = 0x0800,    <span class="comment">// Move to end of file on every write</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span> </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>     <span class="comment">// internally used flags</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>     LFS2_F_DIRTY   = 0x010000, <span class="comment">// File does not match storage</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>     LFS2_F_WRITING = 0x020000, <span class="comment">// File has been written since last flush</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>     LFS2_F_READING = 0x040000, <span class="comment">// File has been read since last flush</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>     LFS2_F_ERRED   = 0x080000, <span class="comment">// An error occured during write</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>     LFS2_F_INLINE  = 0x100000, <span class="comment">// Currently inlined in directory entry</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>     LFS2_F_OPENED  = 0x200000, <span class="comment">// File has been opened</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span> };</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span> </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span> <span class="comment">// File seek flags</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span> <span class="keyword">enum</span> lfs2_whence_flags {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>     LFS2_SEEK_SET = 0,   <span class="comment">// Seek relative to an absolute position</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>     LFS2_SEEK_CUR = 1,   <span class="comment">// Seek relative to the current file position</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>     LFS2_SEEK_END = 2,   <span class="comment">// Seek relative to the end of the file</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span> };</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span> </div><div class="line"><a name="l00149"></a><span class="lineno">  149</span> </div><div class="line"><a name="l00150"></a><span class="lineno">  150</span> <span class="comment">// Configuration provided during initialization of the littlefs</span></div><div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="structlfs2__config.html">  151</a></span> <span class="keyword">struct </span><a class="code" href="structlfs2__config.html">lfs2_config</a> {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>     <span class="comment">// Opaque user provided context that can be used to pass</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>     <span class="comment">// information to the block device operations</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>     <span class="keywordtype">void</span> *context;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span> </div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>     <span class="comment">// Read a region in a block. Negative error codes are propogated</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>     <span class="comment">// to the user.</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>     int (*read)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlfs2__config.html">lfs2_config</a> *c, lfs2_block_t block,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>             lfs2_off_t off, <span class="keywordtype">void</span> *buffer, lfs2_size_t size);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span> </div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>     <span class="comment">// Program a region in a block. The block must have previously</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>     <span class="comment">// been erased. Negative error codes are propogated to the user.</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>     <span class="comment">// May return LFS2_ERR_CORRUPT if the block should be considered bad.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>     int (*prog)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlfs2__config.html">lfs2_config</a> *c, lfs2_block_t block,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>             lfs2_off_t off, <span class="keyword">const</span> <span class="keywordtype">void</span> *buffer, lfs2_size_t size);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span> </div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>     <span class="comment">// Erase a block. A block must be erased before being programmed.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>     <span class="comment">// The state of an erased block is undefined. Negative error codes</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>     <span class="comment">// are propogated to the user.</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>     <span class="comment">// May return LFS2_ERR_CORRUPT if the block should be considered bad.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>     int (*erase)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlfs2__config.html">lfs2_config</a> *c, lfs2_block_t block);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span> </div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>     <span class="comment">// Sync the state of the underlying block device. Negative error codes</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>     <span class="comment">// are propogated to the user.</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>     int (*sync)(<span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlfs2__config.html">lfs2_config</a> *c);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span> </div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>     <span class="comment">// Minimum size of a block read. All read operations will be a</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>     <span class="comment">// multiple of this value.</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>     lfs2_size_t read_size;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span> </div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>     <span class="comment">// Minimum size of a block program. All program operations will be a</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>     <span class="comment">// multiple of this value.</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>     lfs2_size_t prog_size;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span> </div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>     <span class="comment">// Size of an erasable block. This does not impact ram consumption and</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>     <span class="comment">// may be larger than the physical erase size. However, non-inlined files</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>     <span class="comment">// take up at minimum one block. Must be a multiple of the read</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>     <span class="comment">// and program sizes.</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>     lfs2_size_t block_size;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span> </div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>     <span class="comment">// Number of erasable blocks on the device.</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>     lfs2_size_t block_count;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span> </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>     <span class="comment">// Number of erase cycles before littlefs evicts metadata logs and moves </span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>     <span class="comment">// the metadata to another block. Suggested values are in the</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>     <span class="comment">// range 100-1000, with large values having better performance at the cost</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>     <span class="comment">// of less consistent wear distribution.</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>     <span class="comment">//</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>     <span class="comment">// Set to -1 to disable block-level wear-leveling.</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>     int32_t block_cycles;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span> </div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>     <span class="comment">// Size of block caches. Each cache buffers a portion of a block in RAM.</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>     <span class="comment">// The littlefs needs a read cache, a program cache, and one additional</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>     <span class="comment">// cache per file. Larger caches can improve performance by storing more</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>     <span class="comment">// data and reducing the number of disk accesses. Must be a multiple of</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>     <span class="comment">// the read and program sizes, and a factor of the block size.</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>     lfs2_size_t cache_size;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span> </div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>     <span class="comment">// Size of the lookahead buffer in bytes. A larger lookahead buffer</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>     <span class="comment">// increases the number of blocks found during an allocation pass. The</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>     <span class="comment">// lookahead buffer is stored as a compact bitmap, so each byte of RAM</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>     <span class="comment">// can track 8 blocks. Must be a multiple of 8.</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>     lfs2_size_t lookahead_size;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span> </div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>     <span class="comment">// Optional statically allocated read buffer. Must be cache_size.</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>     <span class="comment">// By default lfs2_malloc is used to allocate this buffer.</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>     <span class="keywordtype">void</span> *read_buffer;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span> </div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>     <span class="comment">// Optional statically allocated program buffer. Must be cache_size.</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>     <span class="comment">// By default lfs2_malloc is used to allocate this buffer.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>     <span class="keywordtype">void</span> *prog_buffer;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span> </div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>     <span class="comment">// Optional statically allocated lookahead buffer. Must be lookahead_size</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>     <span class="comment">// and aligned to a 32-bit boundary. By default lfs2_malloc is used to</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>     <span class="comment">// allocate this buffer.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>     <span class="keywordtype">void</span> *lookahead_buffer;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span> </div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>     <span class="comment">// Optional upper limit on length of file names in bytes. No downside for</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>     <span class="comment">// larger names except the size of the info struct which is controlled by</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>     <span class="comment">// the LFS2_NAME_MAX define. Defaults to LFS2_NAME_MAX when zero. Stored in</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>     <span class="comment">// superblock and must be respected by other littlefs drivers.</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>     lfs2_size_t name_max;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span> </div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>     <span class="comment">// Optional upper limit on files in bytes. No downside for larger files</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>     <span class="comment">// but must be &lt;= LFS2_FILE_MAX. Defaults to LFS2_FILE_MAX when zero. Stored</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>     <span class="comment">// in superblock and must be respected by other littlefs drivers.</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>     lfs2_size_t file_max;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span> </div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>     <span class="comment">// Optional upper limit on custom attributes in bytes. No downside for</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>     <span class="comment">// larger attributes size but must be &lt;= LFS2_ATTR_MAX. Defaults to</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>     <span class="comment">// LFS2_ATTR_MAX when zero.</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>     lfs2_size_t attr_max;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span> };</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span> </div><div class="line"><a name="l00245"></a><span class="lineno">  245</span> <span class="comment">// File info structure</span></div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structlfs2__info.html">  246</a></span> <span class="keyword">struct </span><a class="code" href="structlfs2__info.html">lfs2_info</a> {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>     <span class="comment">// Type of the file, either LFS2_TYPE_REG or LFS2_TYPE_DIR</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>     uint8_t type;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span> </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>     <span class="comment">// Size of the file, only valid for REG files. Limited to 32-bits.</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>     lfs2_size_t size;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span> </div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>     <span class="comment">// Name of the file stored as a null-terminated string. Limited to</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>     <span class="comment">// LFS2_NAME_MAX+1, which can be changed by redefining LFS2_NAME_MAX to</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>     <span class="comment">// reduce RAM. LFS2_NAME_MAX is stored in superblock and must be</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>     <span class="comment">// respected by other littlefs drivers.</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>     <span class="keywordtype">char</span> name[LFS2_NAME_MAX+1];</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span> };</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span> </div><div class="line"><a name="l00260"></a><span class="lineno">  260</span> <span class="comment">// Custom attribute structure, used to describe custom attributes</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span> <span class="comment">// committed atomically during file writes.</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="structlfs2__attr.html">  262</a></span> <span class="keyword">struct </span><a class="code" href="structlfs2__attr.html">lfs2_attr</a> {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>     <span class="comment">// 8-bit type of attribute, provided by user and used to</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>     <span class="comment">// identify the attribute</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>     uint8_t type;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span> </div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>     <span class="comment">// Pointer to buffer containing the attribute</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>     <span class="keywordtype">void</span> *buffer;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span> </div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>     <span class="comment">// Size of attribute in bytes, limited to LFS2_ATTR_MAX</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>     lfs2_size_t size;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span> };</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span> </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span> <span class="comment">// Optional configuration provided during lfs2_file_opencfg</span></div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="structlfs2__file__config.html">  275</a></span> <span class="keyword">struct </span><a class="code" href="structlfs2__file__config.html">lfs2_file_config</a> {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>     <span class="comment">// Optional statically allocated file buffer. Must be cache_size.</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>     <span class="comment">// By default lfs2_malloc is used to allocate this buffer.</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>     <span class="keywordtype">void</span> *buffer;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span> </div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>     <span class="comment">// Optional list of custom attributes related to the file. If the file</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>     <span class="comment">// is opened with read access, these attributes will be read from disk</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>     <span class="comment">// during the open call. If the file is opened with write access, the</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>     <span class="comment">// attributes will be written to disk every file sync or close. This</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>     <span class="comment">// write occurs atomically with update to the file's contents.</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>     <span class="comment">//</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>     <span class="comment">// Custom attributes are uniquely identified by an 8-bit type and limited</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>     <span class="comment">// to LFS2_ATTR_MAX bytes. When read, if the stored attribute is smaller</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>     <span class="comment">// than the buffer, it will be padded with zeros. If the stored attribute</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>     <span class="comment">// is larger, then it will be silently truncated. If the attribute is not</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>     <span class="comment">// found, it will be created implicitly.</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>     <span class="keyword">struct </span><a class="code" href="structlfs2__attr.html">lfs2_attr</a> *attrs;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span> </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>     <span class="comment">// Number of custom attributes in the list</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>     lfs2_size_t attr_count;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span> };</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span> </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span> <span class="comment"></span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span> <span class="comment">/// internal littlefs data structures ///</span></div><div class="line"><a name="l00299"></a><span class="lineno"><a class="line" href="structlfs2__cache.html">  299</a></span> <span class="comment"></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2__cache.html">lfs2_cache</a> {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>     lfs2_block_t block;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>     lfs2_off_t off;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>     lfs2_size_t size;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>     uint8_t *buffer;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span> } <a class="code" href="structlfs2__cache.html">lfs2_cache_t</a>;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span> </div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="structlfs2__mdir.html">  306</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2__mdir.html">lfs2_mdir</a> {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>     lfs2_block_t pair[2];</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>     uint32_t rev;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>     lfs2_off_t off;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>     uint32_t etag;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>     uint16_t count;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>     <span class="keywordtype">bool</span> erased;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>     <span class="keywordtype">bool</span> split;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>     lfs2_block_t tail[2];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span> } <a class="code" href="structlfs2__mdir.html">lfs2_mdir_t</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span> </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span> <span class="comment">// littlefs directory type</span></div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="structlfs2__dir.html">  318</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2__dir.html">lfs2_dir</a> {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>     <span class="keyword">struct </span><a class="code" href="structlfs2__dir.html">lfs2_dir</a> *next;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>     uint16_t id;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>     uint8_t type;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>     <a class="code" href="structlfs2__mdir.html">lfs2_mdir_t</a> m;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span> </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>     lfs2_off_t pos;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>     lfs2_block_t head[2];</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span> } <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span> </div><div class="line"><a name="l00328"></a><span class="lineno">  328</span> <span class="comment">// littlefs file type</span></div><div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="structlfs2__file.html">  329</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2__file.html">lfs2_file</a> {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>     <span class="keyword">struct </span><a class="code" href="structlfs2__file.html">lfs2_file</a> *next;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>     uint16_t id;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>     uint8_t type;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>     <a class="code" href="structlfs2__mdir.html">lfs2_mdir_t</a> m;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span> </div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="structlfs2__file_1_1lfs2__ctz.html">  335</a></span>     <span class="keyword">struct </span><a class="code" href="structlfs2__file_1_1lfs2__ctz.html">lfs2_ctz</a> {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>         lfs2_block_t head;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>         lfs2_size_t size;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>     } ctz;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span> </div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>     uint32_t flags;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>     lfs2_off_t pos;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>     lfs2_block_t block;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>     lfs2_off_t off;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>     <a class="code" href="structlfs2__cache.html">lfs2_cache_t</a> cache;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span> </div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlfs2__file__config.html">lfs2_file_config</a> *cfg;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span> } <a class="code" href="structlfs2__file.html">lfs2_file_t</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span> </div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="structlfs2__superblock.html">  349</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2__superblock.html">lfs2_superblock</a> {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>     uint32_t version;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>     lfs2_size_t block_size;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>     lfs2_size_t block_count;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>     lfs2_size_t name_max;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>     lfs2_size_t file_max;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>     lfs2_size_t attr_max;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span> } <a class="code" href="structlfs2__superblock.html">lfs2_superblock_t</a>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span> </div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="structlfs2__gstate.html">  358</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2__gstate.html">lfs2_gstate</a> {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>     uint32_t tag;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>     lfs2_block_t pair[2];</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span> } <a class="code" href="structlfs2__gstate.html">lfs2_gstate_t</a>;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span> </div><div class="line"><a name="l00363"></a><span class="lineno">  363</span> <span class="comment">// The littlefs filesystem type</span></div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="structlfs2.html">  364</a></span> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlfs2.html">lfs2</a> {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>     <a class="code" href="structlfs2__cache.html">lfs2_cache_t</a> rcache;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>     <a class="code" href="structlfs2__cache.html">lfs2_cache_t</a> pcache;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span> </div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>     lfs2_block_t root[2];</div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="structlfs2_1_1lfs2__mlist.html">  369</a></span>     <span class="keyword">struct </span><a class="code" href="structlfs2_1_1lfs2__mlist.html">lfs2_mlist</a> {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>         <span class="keyword">struct </span><a class="code" href="structlfs2_1_1lfs2__mlist.html">lfs2_mlist</a> *next;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>         uint16_t id;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>         uint8_t type;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>         <a class="code" href="structlfs2__mdir.html">lfs2_mdir_t</a> m;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>     } *mlist;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>     uint32_t seed;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span> </div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>     <a class="code" href="structlfs2__gstate.html">lfs2_gstate_t</a> gstate;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>     <a class="code" href="structlfs2__gstate.html">lfs2_gstate_t</a> gdisk;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>     <a class="code" href="structlfs2__gstate.html">lfs2_gstate_t</a> gdelta;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span> </div><div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="structlfs2_1_1lfs2__free.html">  381</a></span>     <span class="keyword">struct </span><a class="code" href="structlfs2_1_1lfs2__free.html">lfs2_free</a> {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>         lfs2_block_t off;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>         lfs2_block_t size;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>         lfs2_block_t i;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>         lfs2_block_t ack;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>         uint32_t *buffer;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>     } free;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span> </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structlfs2__config.html">lfs2_config</a> *cfg;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>     lfs2_size_t name_max;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>     lfs2_size_t file_max;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>     lfs2_size_t attr_max;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span> </div><div class="line"><a name="l00394"></a><span class="lineno">  394</span> <span class="preprocessor">#ifdef LFS2_MIGRATE</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>     <span class="keyword">struct </span>lfs21 *lfs21;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span> } <a class="code" href="structlfs2.html">lfs2_t</a>;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span> </div><div class="line"><a name="l00399"></a><span class="lineno">  399</span> <span class="comment"></span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span> <span class="comment">/// Filesystem functions ///</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span> <span class="comment"></span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span> <span class="comment">// Format a block device with the littlefs</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span> <span class="comment">//</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span> <span class="comment">// Requires a littlefs object and config struct. This clobbers the littlefs</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span> <span class="comment">// object, and does not leave the filesystem mounted. The config struct must</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span> <span class="comment">// be zeroed for defaults and backwards compatibility.</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span> <span class="comment">//</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span> <span class="keywordtype">int</span> lfs2_format(<a class="code" href="structlfs2.html">lfs2_t</a> *<a class="code" href="structlfs2.html">lfs2</a>, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfs2__config.html">lfs2_config</a> *config);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span> </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span> <span class="comment">// Mounts a littlefs</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span> <span class="comment">//</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span> <span class="comment">// Requires a littlefs object and config struct. Multiple filesystems</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span> <span class="comment">// may be mounted simultaneously with multiple littlefs objects. Both</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span> <span class="comment">// lfs2 and config must be allocated while mounted. The config struct must</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span> <span class="comment">// be zeroed for defaults and backwards compatibility.</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span> <span class="comment">//</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span> <span class="keywordtype">int</span> lfs2_mount(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfs2__config.html">lfs2_config</a> *config);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span> </div><div class="line"><a name="l00421"></a><span class="lineno">  421</span> <span class="comment">// Unmounts a littlefs</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span> <span class="comment">//</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span> <span class="comment">// Does nothing besides releasing any allocated resources.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span> <span class="keywordtype">int</span> lfs2_unmount(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span> <span class="comment"></span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span> <span class="comment">/// General operations ///</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span> <span class="comment"></span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span> <span class="comment">// Removes a file or directory</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span> <span class="comment">//</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span> <span class="comment">// If removing a directory, the directory must be empty.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span> <span class="keywordtype">int</span> lfs2_remove(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span> </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span> <span class="comment">// Rename or move a file or directory</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span> <span class="comment">//</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span> <span class="comment">// If the destination exists, it must match the source in type.</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span> <span class="comment">// If the destination is a directory, the directory must be empty.</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span> <span class="comment">//</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span> <span class="keywordtype">int</span> lfs2_rename(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *oldpath, <span class="keyword">const</span> <span class="keywordtype">char</span> *newpath);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span> </div><div class="line"><a name="l00443"></a><span class="lineno">  443</span> <span class="comment">// Find info about a file or directory</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span> <span class="comment">//</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span> <span class="comment">// Fills out the info structure, based on the specified file or directory.</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span> <span class="keywordtype">int</span> lfs2_stat(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keyword">struct</span> <a class="code" href="structlfs2__info.html">lfs2_info</a> *<a class="code" href="structinfo.html">info</a>);</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span> </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span> <span class="comment">// Get a custom attribute</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span> <span class="comment">//</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span> <span class="comment">// Custom attributes are uniquely identified by an 8-bit type and limited</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span> <span class="comment">// to LFS2_ATTR_MAX bytes. When read, if the stored attribute is smaller than</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span> <span class="comment">// the buffer, it will be padded with zeros. If the stored attribute is larger,</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span> <span class="comment">// then it will be silently truncated. If no attribute is found, the error</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span> <span class="comment">// LFS2_ERR_NOATTR is returned and the buffer is filled with zeros.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span> <span class="comment">//</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span> <span class="comment">// Returns the size of the attribute, or a negative error code on failure.</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span> <span class="comment">// Note, the returned size is the size of the attribute on disk, irrespective</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span> <span class="comment">// of the size of the buffer. This can be used to dynamically allocate a buffer</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span> <span class="comment">// or check for existance.</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span> lfs2_ssize_t lfs2_getattr(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>         uint8_t type, <span class="keywordtype">void</span> *buffer, lfs2_size_t size);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span> </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span> <span class="comment">// Set custom attributes</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span> <span class="comment">//</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span> <span class="comment">// Custom attributes are uniquely identified by an 8-bit type and limited</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span> <span class="comment">// to LFS2_ATTR_MAX bytes. If an attribute is not found, it will be</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span> <span class="comment">// implicitly created.</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span> <span class="comment">//</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span> <span class="keywordtype">int</span> lfs2_setattr(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *path,</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>         uint8_t type, <span class="keyword">const</span> <span class="keywordtype">void</span> *buffer, lfs2_size_t size);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span> </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span> <span class="comment">// Removes a custom attribute</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span> <span class="comment">//</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span> <span class="comment">// If an attribute is not found, nothing happens.</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span> <span class="comment">//</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span> <span class="keywordtype">int</span> lfs2_removeattr(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *path, uint8_t type);</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span> </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span> <span class="comment"></span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span> <span class="comment">/// File operations ///</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span> <span class="comment"></span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span> <span class="comment">// Open a file</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span> <span class="comment">//</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span> <span class="comment">// The mode that the file is opened in is determined by the flags, which</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span> <span class="comment">// are values from the enum lfs2_open_flags that are bitwise-ored together.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span> <span class="comment">//</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span> <span class="keywordtype">int</span> lfs2_file_open(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file,</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>         <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">int</span> flags);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span> </div><div class="line"><a name="l00493"></a><span class="lineno">  493</span> <span class="comment">// Open a file with extra configuration</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span> <span class="comment">//</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span> <span class="comment">// The mode that the file is opened in is determined by the flags, which</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span> <span class="comment">// are values from the enum lfs2_open_flags that are bitwise-ored together.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span> <span class="comment">//</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span> <span class="comment">// The config struct provides additional config options per file as described</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span> <span class="comment">// above. The config struct must be allocated while the file is open, and the</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span> <span class="comment">// config struct must be zeroed for defaults and backwards compatibility.</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span> <span class="comment">//</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span> <span class="keywordtype">int</span> lfs2_file_opencfg(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>         <span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">int</span> flags,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>         <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfs2__file__config.html">lfs2_file_config</a> *config);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span> </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span> <span class="comment">// Close a file</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span> <span class="comment">//</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span> <span class="comment">// Any pending writes are written out to storage as though</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span> <span class="comment">// sync had been called and releases any allocated resources.</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span> <span class="comment">//</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span> <span class="keywordtype">int</span> lfs2_file_close(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file);</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span> </div><div class="line"><a name="l00515"></a><span class="lineno">  515</span> <span class="comment">// Synchronize a file on storage</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span> <span class="comment">//</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span> <span class="comment">// Any pending writes are written out to storage.</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span> <span class="keywordtype">int</span> lfs2_file_sync(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span> </div><div class="line"><a name="l00521"></a><span class="lineno">  521</span> <span class="comment">// Read data from file</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span> <span class="comment">//</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span> <span class="comment">// Takes a buffer and size indicating where to store the read data.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span> <span class="comment">// Returns the number of bytes read, or a negative error code on failure.</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span> lfs2_ssize_t lfs2_file_read(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file,</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>         <span class="keywordtype">void</span> *buffer, lfs2_size_t size);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span> </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span> <span class="comment">// Write data to file</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span> <span class="comment">//</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span> <span class="comment">// Takes a buffer and size indicating the data to write. The file will not</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span> <span class="comment">// actually be updated on the storage until either sync or close is called.</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span> <span class="comment">//</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span> <span class="comment">// Returns the number of bytes written, or a negative error code on failure.</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span> lfs2_ssize_t lfs2_file_write(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file,</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>         <span class="keyword">const</span> <span class="keywordtype">void</span> *buffer, lfs2_size_t size);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span> </div><div class="line"><a name="l00537"></a><span class="lineno">  537</span> <span class="comment">// Change the position of the file</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span> <span class="comment">//</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span> <span class="comment">// The change in position is determined by the offset and whence flag.</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span> <span class="comment">// Returns the new position of the file, or a negative error code on failure.</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span> lfs2_soff_t lfs2_file_seek(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>         lfs2_soff_t off, <span class="keywordtype">int</span> whence);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span> </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span> <span class="comment">// Truncates the size of the file to the specified size</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span> <span class="comment">//</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span> <span class="keywordtype">int</span> lfs2_file_truncate(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file, lfs2_off_t size);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span> </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span> <span class="comment">// Return the position of the file</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span> <span class="comment">//</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span> <span class="comment">// Equivalent to lfs2_file_seek(lfs2, file, 0, LFS2_SEEK_CUR)</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span> <span class="comment">// Returns the position of the file, or a negative error code on failure.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span> lfs2_soff_t lfs2_file_tell(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span> </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span> <span class="comment">// Change the position of the file to the beginning of the file</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span> <span class="comment">//</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span> <span class="comment">// Equivalent to lfs2_file_seek(lfs2, file, 0, LFS2_SEEK_SET)</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span> <span class="keywordtype">int</span> lfs2_file_rewind(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span> </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span> <span class="comment">// Return the size of the file</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span> <span class="comment">//</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span> <span class="comment">// Similar to lfs2_file_seek(lfs2, file, 0, LFS2_SEEK_END)</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span> <span class="comment">// Returns the size of the file, or a negative error code on failure.</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span> lfs2_soff_t lfs2_file_size(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__file.html">lfs2_file_t</a> *file);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span> </div><div class="line"><a name="l00567"></a><span class="lineno">  567</span> <span class="comment"></span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span> <span class="comment">/// Directory operations ///</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span> <span class="comment"></span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span> <span class="comment">// Create a directory</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span> <span class="comment">//</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span> <span class="keywordtype">int</span> lfs2_mkdir(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span> </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span> <span class="comment">// Open a directory</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span> <span class="comment">//</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span> <span class="comment">// Once open a directory can be used with read to iterate over files.</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span> <span class="keywordtype">int</span> lfs2_dir_open(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a> *dir, <span class="keyword">const</span> <span class="keywordtype">char</span> *path);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span> </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span> <span class="comment">// Close a directory</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span> <span class="comment">//</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span> <span class="comment">// Releases any allocated resources.</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span> <span class="keywordtype">int</span> lfs2_dir_close(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a> *dir);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span> </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span> <span class="comment">// Read an entry in the directory</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span> <span class="comment">//</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span> <span class="comment">// Fills out the info structure, based on the specified file or directory.</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span> <span class="comment">// Returns a positive value on success, 0 at the end of directory,</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span> <span class="comment">// or a negative error code on failure.</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span> <span class="keywordtype">int</span> lfs2_dir_read(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a> *dir, <span class="keyword">struct</span> <a class="code" href="structlfs2__info.html">lfs2_info</a> *info);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span> </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span> <span class="comment">// Change the position of the directory</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span> <span class="comment">//</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span> <span class="comment">// The new off must be a value previous returned from tell and specifies</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span> <span class="comment">// an absolute offset in the directory seek.</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span> <span class="comment">//</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span> <span class="keywordtype">int</span> lfs2_dir_seek(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a> *dir, lfs2_off_t off);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span> </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span> <span class="comment">// Return the position of the directory</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span> <span class="comment">//</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span> <span class="comment">// The returned offset is only meant to be consumed by seek and may not make</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span> <span class="comment">// sense, but does indicate the current position in the directory iteration.</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span> <span class="comment">//</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span> <span class="comment">// Returns the position of the directory, or a negative error code on failure.</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span> lfs2_soff_t lfs2_dir_tell(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a> *dir);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span> </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span> <span class="comment">// Change the position of the directory to the beginning of the directory</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span> <span class="comment">//</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span> <span class="keywordtype">int</span> lfs2_dir_rewind(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <a class="code" href="structlfs2__dir.html">lfs2_dir_t</a> *dir);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span> </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span> <span class="comment"></span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span> <span class="comment">/// Filesystem-level filesystem operations</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span> <span class="comment"></span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span> <span class="comment">// Finds the current size of the filesystem</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span> <span class="comment">//</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span> <span class="comment">// Note: Result is best effort. If files share COW structures, the returned</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span> <span class="comment">// size may be larger than the filesystem actually is.</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span> <span class="comment">//</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span> <span class="comment">// Returns the number of allocated blocks, or a negative error code on failure.</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span> lfs2_ssize_t lfs2_fs_size(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span> </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span> <span class="comment">// Traverse through all blocks in use by the filesystem</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span> <span class="comment">//</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span> <span class="comment">// The provided callback will be called with each block address that is</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span> <span class="comment">// currently in use by the filesystem. This can be used to determine which</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span> <span class="comment">// blocks are in use or how much of the storage is available.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span> <span class="comment">//</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span> <span class="keywordtype">int</span> lfs2_fs_traverse(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keywordtype">int</span> (*cb)(<span class="keywordtype">void</span>*, lfs2_block_t), <span class="keywordtype">void</span> *data);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span> </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span> <span class="preprocessor">#ifdef LFS2_MIGRATE</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span> <span class="comment">// Attempts to migrate a previous version of littlefs</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span> <span class="comment">//</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span> <span class="comment">// Behaves similarly to the lfs2_format function. Attempts to mount</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span> <span class="comment">// the previous version of littlefs and update the filesystem so it can be</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span> <span class="comment">// mounted with the current version of littlefs.</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span> <span class="comment">//</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span> <span class="comment">// Requires a littlefs object and config struct. This clobbers the littlefs</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span> <span class="comment">// object, and does not leave the filesystem mounted. The config struct must</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span> <span class="comment">// be zeroed for defaults and backwards compatibility.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span> <span class="comment">//</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span> <span class="comment">// Returns a negative error code on failure.</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span> <span class="keywordtype">int</span> lfs2_migrate(<a class="code" href="structlfs2.html">lfs2_t</a> *lfs2, <span class="keyword">const</span> <span class="keyword">struct</span> <a class="code" href="structlfs2__config.html">lfs2_config</a> *cfg);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span> </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span> </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span> <span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span> } <span class="comment">/* extern "C" */</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span> <span class="preprocessor">#endif</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span> </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span> <span class="preprocessor">#endif</span></div><div class="ttc" id="structlfs2__cache_html"><div class="ttname"><a href="structlfs2__cache.html">lfs2_cache</a></div><div class="ttdoc">internal littlefs data structures /// </div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00299">lfs2.h:299</a></div></div>
<div class="ttc" id="structlfs2_html"><div class="ttname"><a href="structlfs2.html">lfs2</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00364">lfs2.h:364</a></div></div>
<div class="ttc" id="structlfs2__info_html"><div class="ttname"><a href="structlfs2__info.html">lfs2_info</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00246">lfs2.h:246</a></div></div>
<div class="ttc" id="structinfo_html"><div class="ttname"><a href="structinfo.html">info</a></div><div class="ttdoc">The key size. </div><div class="ttdef"><b>Definition:</b> <a href="kvstore__global__api_8h_source.html#l00038">kvstore_global_api.h:38</a></div></div>
<div class="ttc" id="structlfs2__attr_html"><div class="ttname"><a href="structlfs2__attr.html">lfs2_attr</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00262">lfs2.h:262</a></div></div>
<div class="ttc" id="structlfs2__superblock_html"><div class="ttname"><a href="structlfs2__superblock.html">lfs2_superblock</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00349">lfs2.h:349</a></div></div>
<div class="ttc" id="structlfs2_1_1lfs2__free_html"><div class="ttname"><a href="structlfs2_1_1lfs2__free.html">lfs2::lfs2_free</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00381">lfs2.h:381</a></div></div>
<div class="ttc" id="structlfs2__gstate_html"><div class="ttname"><a href="structlfs2__gstate.html">lfs2_gstate</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00358">lfs2.h:358</a></div></div>
<div class="ttc" id="structlfs2__mdir_html"><div class="ttname"><a href="structlfs2__mdir.html">lfs2_mdir</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00306">lfs2.h:306</a></div></div>
<div class="ttc" id="structlfs2_1_1lfs2__mlist_html"><div class="ttname"><a href="structlfs2_1_1lfs2__mlist.html">lfs2::lfs2_mlist</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00369">lfs2.h:369</a></div></div>
<div class="ttc" id="structlfs2__config_html"><div class="ttname"><a href="structlfs2__config.html">lfs2_config</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00151">lfs2.h:151</a></div></div>
<div class="ttc" id="structlfs2__file__config_html"><div class="ttname"><a href="structlfs2__file__config.html">lfs2_file_config</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00275">lfs2.h:275</a></div></div>
<div class="ttc" id="structlfs2__dir_html"><div class="ttname"><a href="structlfs2__dir.html">lfs2_dir</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00318">lfs2.h:318</a></div></div>
<div class="ttc" id="structlfs2__file_1_1lfs2__ctz_html"><div class="ttname"><a href="structlfs2__file_1_1lfs2__ctz.html">lfs2_file::lfs2_ctz</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00335">lfs2.h:335</a></div></div>
<div class="ttc" id="structlfs2__file_html"><div class="ttname"><a href="structlfs2__file.html">lfs2_file</a></div><div class="ttdef"><b>Definition:</b> <a href="lfs2_8h_source.html#l00329">lfs2.h:329</a></div></div>
</div><!-- fragment --></div><!-- contents -->
        
    


        
<footer class="global-footer">
    <ul class="global-footer-media global-footer-row">
        <li>
            <a class="footer-media-icon" title="Twitter" href="https://twitter.com/ArmSoftwareDev">
                <span class="fab fa-twitter-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Twitter</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="YouTube" href="https://www.youtube.com/c/ArmSoftwareDevelopers">
                <span class="fab fa-youtube-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">YouTube</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Forum" href="http://forums.mbed.com/">
                <span class="fas fa-comments fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Forum</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Blog" href="http://blog.mbed.com/">
                <span class="fas fa-pen-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Blog</span>
            </a>
        </li>
    </ul>

    <div class="global-footer-copyright global-footer-row">
        <div class="copyright-statement">Copyright © <script>document.write(new Date().getFullYear());</script> Arm Limited (or its affiliates).</div>
        <ul class="copyright-links">
            <li><a href="https://os.mbed.com/">Home</a></li>
            <li><a href="https://www.arm.com/company/policies/terms-and-conditions">Website Terms</a></li>
            <li><a href="https://www.arm.com/company/policies/privacy">Privacy</a></li>
            <li><a href="https://www.arm.com/company/policies/cookies">Cookies</a></li>
            <li><a href="http://www.arm.com/company/policies/trademarks">Trademarks</a></li>
        </ul>
    </div>
</footer>



    <div id="cookiemodule">
    <h5>Important Information for this Arm website</h5>
    <div id="cookiecontent">
        <p>
            This site uses cookies to store information on your computer.
            By continuing to use our site, you consent to our cookies.
            If you are not happy with the use of these cookies, please review our
            <a href="https://www.arm.com/company/policies/cookies">Cookie Policy</a>
            to learn how they can be disabled.
            By disabling cookies, some features of the site will not work.
        </p>
        <button id="acceptcookie">Accept and hide this message</button>
    </div>
</div>
<script src="../../../../static/js/cookie_law.js"></script>




    </body>

<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/lfs2_8h_source.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:24:25 GMT -->
</html>
