<!DOCTYPE html>
<html>
    
<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/group__aead.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:15:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        
        <meta charset="utf-8"/>
        <title>Mbed OS Reference | Authenticated encryption with associated data (AEAD)</title>
        <link href="../static/css/vendor/foundation-6.2.4.min.mbed-cache-4c48f6c816971070eb1e4eca75f0ec30.css" rel="stylesheet"/>
        <link href="search/search.css" rel="stylesheet"/>
        <link href="../static/css/app.mbed-cache-a44289fe9f5ca07036a335d6ad7ed8ad.css" rel="stylesheet"/>
        <script src="../static/js/vendor/jquery-3.2.1.min.mbed-cache-c9f5aeeca3ad37bf2aa006139b935f0a.js"></script>
        <script src="dynsections.js"></script>
        <script src="search/searchdata.js"></script>
        <script src="search/search.js"></script>
        <script>
            $(document).ready(function() {
                init_search();
            });
        </script>
    
        

<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','../../../../../www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1447836-8');
ga('require', 'GTM-WXMLD4S')
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'../../../../../www.googletagmanager.com/gtm5445.html?id='+i+dl+'&gtm_auth=SMYNPwM0ICsV00c1ZHETqQ&gtm_preview=env-2&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-M6FZ495');</script>


    <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:971746,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>



<!-- Favicons -->
<link rel="apple-touch-icon" sizes="57x57" href="../../../../static/img/favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../../static/img/favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../../static/img/favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../../static/img/favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../../static/img/favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../../static/img/favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="../../../../static/img/favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="../../../../static/img/favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="../../../../static/img/favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="../../../../static/img/favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../../static/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="../../../../static/img/favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../../static/img/favicons/favicon-16x16.png">
<link rel="manifest" href="https://os.mbed.com/static/img/favicons/manifest.json">
<link rel="shortcut icon" href="https://os.mbed.com/static/img/favicon.ico?">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/static/img/favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">

<link rel="stylesheet" href="../../../../static/CACHE/css/output.811e2930ab34.css" type="text/css">

<link href="../../../../static/docs/css/doc_viewer.css" rel="stylesheet">
<link href="../../../../static/fonts.css" rel="stylesheet">
<link href="../../../../static/docs-nav-and-footer1b26.css?v2" rel="stylesheet">


<link rel="canonical" href="group__aead.html">
<script src="../../../../static/mbed-nav-vertical-menu.js"></script>


    </head>
    <body>
        








<div class="mbed-nav">
    <div class="mbed-nav__mobile-menu-control">
        <i class="mbed-nav__mobile-menu-control-open fas fa-bars fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-close fas fa-times is-hidden fa-fw"></i>
        <i class="mbed-nav__mobile-menu-control-back fas fa-angle-left is-hidden fa-fw"></i>
    </div>
    <div class="mbed-nav__logo">
        <a href="https://os.mbed.com/">
            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#logo"></use></svg>
        </a>
    </div>
    <div class="mbed-nav__menu">

        <!-- Main menu -->
        <nav class="mbed-nav__main-menu">
            <ul class="mbed-nav__dropdown-menu">
                <li class="has-dropdown">
                    Overview

                    <div class="mbed-nav__dropdown-menu-content">

                        <!-- Overview dropdown menu -->
                        <div class="mbed-nav__overview-menu">
                            <section>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <div>
                                                <p>Mbed OS</p>
                                                <p>The open source OS for Cortex-M devices</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link-detail">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <div>
                                                <p>Keil Studio Cloud</p>
                                                <p>Arm's IDE for IoT, embedded and Mbed development</p>
                                            </div>
                                         </a>
                                     </li>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <div>
                                                <p>Mbed Studio</p>
                                                <p>Download the desktop IDE for Mbed OS</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link-detail">

                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <div>
                                               <p>Mbed CLI</p>
                                               <p>Command line access to Mbed tools and services</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>

                            <section>
                                <p>Security and Connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <div>
                                                <p>Mbed TLS and Mbed Crypto</p>
                                                <p>Industry standard TLS stack and crypto library</p>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link-detail">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <div>
                                                <p>Connectivity</p>
                                                <p>BLE, WiFi, Cellular, LoRaWAN and more</p>
                                            </div>
                                        </a>
                                    </li>
                                </ul>
                            </section>
                        </div>
                    </div>
                </li>
                <li class="has-dropdown">
                    Hardware

                    <!-- Hardware dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__hardware-dropdown">
                            <ul class="mbed-nav__hardware-menu">
                                <li>
                                    <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                        <div>
                                            <p>Boards</p>
                                            <p>Build your Mbed projects with development boards for Arm Cortex processors and MCUs</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                        <div>
                                            <p>Modules</p>
                                            <p>Modules include a MCU, connectivity and onboard memory, making them ideal for designing IoT products for mass production</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                        <div>
                                            <p>Components</p>
                                            <p>The component database hosts libraries for different sensors, actuators, radios, inputs, middleware and IoT services</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                        <div>
                                            <p>Hardware overview & Mbed Enabled</p>
                                            <p>Learn about hardware support for Mbed, as well as the Mbed Enabled program, which identifies Mbed compatible products</p>
                                        </div>
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link-detail">
                                        <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                        <div>
                                            <p>Mbed HDK</p>
                                            <p>Reference designs, schematics and board layouts to develop production hardware and Mbed-compatible development boards</p>
                                        </div>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>

                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li class="has-dropdown">
                    Documentation

                    <!-- Documentation dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__documentation-dropdown">
                            <ul class="mbed-nav__documentation-menu">
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a>
                                </li>
                                <li>
                                    <a
                                        href="https://developer.arm.com/documentation/102497/latest/Arm-Keil-Studio-Cloud">
                                        Keil Studio
                                    </a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li class="has-dropdown">
                    Community

                    <!-- Community dropdown menu -->
                    <div class="mbed-nav__dropdown-menu-content">
                        <div class="mbed-nav__community-dropdown">
                            <ul class="mbed-nav__community-menu">
                                <li>
                                    <a href="https://forums.mbed.com/">Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a>
                                </li>
                                <li>
                                    <a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a>
                                </li>
                                <li>
                                    <a href="https://os.mbed.com/support/">Report a problem</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </li>
                <li>
                    <a href="https://os.mbed.com/blog/">Blog</a>
                </li>
            </ul>
        </nav>
    </div>
    <div class="mbed-nav__user-controls">
        <div class="mbed-nav__user-controls-top">
            <div class="mbed-nav__search">
                <form id="mbed-nav__search-box" class="is-hidden" action="https://os.mbed.com/search" method="GET">
                    <div class="mbed-nav__search-box">
                        <input type="search" name="q" placeholder="Search...">
                        <button type="submit">
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                        </button>
                    </div>
                </form>
                <i class="mbed-nav__search-close fas fa-times is-hidden"></i>
                <svg class="mbed-nav__search-open stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
            </div>
            <a class="mbed-nav__cta" href="https://studio.keil.arm.com/mbed" target="_blank">
                Keil Studio Cloud
            </a>

            
                
                <nav class="mbed-nav__logged-out-nav">
                    <ul class="mbed-nav__dropdown-menu">
                        <li>
                            <svg class="stroke-white"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#profile"></use></svg>

                            <!-- Logged out dropdown menu -->
                            <div class="mbed-nav__dropdown-menu-content">
                                <div class="mbed-nav__logged-out-dropdown">
                                    <ul class="mbed-nav__logged-out-menu">
                                        <li><a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/group__aead.html">Log in or Sign up</a></li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </nav>
                
            
        </div>
    </div>
    <div class="mbed-nav__spacer"></div>
</div>
<div class="mbed-nav__mobile-menu-cover is-hidden">
    <div class="mbed-nav__mobile-menu">

        <div id="mbed-nav__main-menu-mobile">
            <div class="mbed-nav__user-controls-mobile">
                <div class="mbed-nav__user-controls-top-mobile">
                    <form action="https://os.mbed.com/search" method="GET">
                        <div class="mbed-nav__search-box mbed-nav__search-box--light">
                            <input type="search" name="q" placeholder="Search...">
                            <button type="submit">
                                <svg class="stroke-dark-grey"><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#search"></use></svg>
                            </button>
                        </div>
                    </form>
                    
                        
                        <a href="https://os.mbed.com/account/login/?next=/docs/mbed-os/v6.16/mbed-os-api-doxy/group__aead.html">Log in or Sign up</a>
                        
                    
                </div>
            </div>

            <ul class="mbed-nav__side-menu">
                <li>
                    <input type="checkbox" name="accordion-toggle" id="overview-accordion">
                    <label for="overview-accordion">Overview</label>
                    <div class="accordion_content">
                        <ul class="overview-menu-mobile">
                            <li>
                                <p>Operating system</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/mbed-os/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_os"></use></svg>
                                            <p>Mbed OS</p>
                                        </a>
                                    </li>
                                    

                                </ul>
                            </li>
                            <li>
                                <p>Development tools</p>
                                <ul>
                                    <li>
                                        <a href="https://os.mbed.com/studio/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_studio"></use></svg>
                                            <p>Mbed Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://www.keil.arm.com/mbed/?utm_source=mbed_com&amp;utm_medium=compiler_button&amp;utm_campaign=mbed_com_promo" class="mbed-nav__icon-link">
                                             <svg><use href="https://os.mbed.com/static/img/keil_studio_icon.2c56c28014c6.svg?#keil_studio_icon"></use></svg>
                                            <p>Keil Studio</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/docs/mbed-os/latest/quick-start/offline-with-mbed-cli.html" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_cli"></use></svg>
                                            <p>Mbed CLI</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Security and connectivity</p>
                                <ul>
                                    <li>
                                        <a href="https://tls.mbed.org/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_tls_crypto"></use></svg>
                                            <p>Mbed TLS and Mbed Crypto</p>
                                        </a>
                                    </li>
                                    <li>
                                        <a href="https://os.mbed.com/connectivity-technologies/" class="mbed-nav__icon-link">
                                            <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#connectivity"></use></svg>
                                            <p>Connectivity</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="hardware-accordion">
                    <label for="hardware-accordion">Hardware</label>
                    <div class="accordion_content">
                        <ul>
                            <li>
                                <a href="https://os.mbed.com/platforms/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#boards"></use></svg>
                                    <p>Boards</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/modules/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#modules"></use></svg>
                                    <p>Modules</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/components/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#components"></use></svg>
                                    <p>Components</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/hardware/" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#hardware_overview"></use></svg>
                                    <p>Hardware overview & Mbed Enabled</p>
                                </a>
                            </li>
                            <li>
                                <a href="https://os.mbed.com/docs/mbed-os/latest/porting/arm-mbed-hdk.html" class="mbed-nav__icon-link">
                                    <svg><use xlink:href="https://os.mbed.com/static/img/mbed_nav_spritesheet.8ac20221a123.svg?v3#mbed_hdk"></use></svg>
                                    <p>Mbed HDK</p>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/code/">Code</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="documentation-accordion">
                    <label for="documentation-accordion">Documentation</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://os.mbed.com/docs/mbed-os/">Mbed OS</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-studio/">Mbed Studio</a></li>
                            <li>
                              <a
                                href="https://developer.arm.com/documentation/102497/1-5/Arm-Keil-Studio/?utm_source=mbed_com&amp;utm_medium=nav_docs_link&amp;utm_campaign=mbed_com_promo">
                                Keil Studio
                              </a>
                            </li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/built-with-mbed/">Case studies</a></li>
                <li>
                    <input type="checkbox" name="accordion-toggle" id="community-accordion">
                    <label for="community-accordion">Community</label>
                    <div class="accordion_content">
                        <ul>
                            <li><a href="https://forums.mbed.com/">Forum</a></li>
                            <li><a href="https://os.mbed.com/docs/mbed-os/latest/contributing/index.html">Contribute</a></li>
                            <li><a href="https://www.youtube.com/playlist?list=PLKjl7IFAwc4R4plIZe4IuHlsn8zW7rvKh">Mbed OS Tech Forum</a></li>
                            <li><a href="https://os.mbed.com/support/">Report a problem</a></li>
                        </ul>
                    </div>
                </li>
                <li><a href="https://os.mbed.com/blog/">Blog</a></li>
            </ul>
        </div>

        
    </div>
</div>



<div class="version-picker-container">
    
    <select class="version-picker" onchange="goToVersion(this.value)">
        
            <option
                value="v6.16"
                selected
            >
                v6.16
            </option>
        
            <option
                value="v6.15"
                
            >
                v6.15
            </option>
        
            <option
                value="v6.14"
                
            >
                v6.14
            </option>
        
            <option
                value="v6.13"
                
            >
                v6.13
            </option>
        
            <option
                value="v6.12"
                
            >
                v6.12
            </option>
        
            <option
                value="v6.11"
                
            >
                v6.11
            </option>
        
            <option
                value="v6.10"
                
            >
                v6.10
            </option>
        
            <option
                value="v6.9"
                
            >
                v6.9
            </option>
        
            <option
                value="v6.8"
                
            >
                v6.8
            </option>
        
            <option
                value="v6.7"
                
            >
                v6.7
            </option>
        
            <option
                value="v6.6"
                
            >
                v6.6
            </option>
        
            <option
                value="v6.5"
                
            >
                v6.5
            </option>
        
            <option
                value="v5.15"
                
            >
                v5.15
            </option>
        
    </select>
    

    <div class="contact-us">
        Mistake on this page?
        
            <br>
            <a href="https://github.com/ARMmbed/mbed-os-5-docs/issues">
                Report an issue in GitHub
                <i class="fab fa-github"></i>
            </a>
            or
            <a href="mailto:mbed-support@arm.com">
                email us
                <i class="fas fa-envelope"></i>
            </a>
        
    </div>
</div>

<script>
    function goToVersion(version) {
        window.location.href = window.location.href.replace(
            "v6.16",
            version
        )
    }
</script>

        
        <div class="topbar" id="top">
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div class="tabs" id="navrow1">
    <ul class="tablist">
      <li><a href="index.html"><span>Main Page</span></a></li>
      <li><a href="pages.html"><span>Related Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div class="MSearchBoxInactive" id="MSearchBox">
        <span class="left">
          <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png"/>
          <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search"/>
          </span><span class="right">
            <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png"/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> |
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Authenticated encryption with associated data (AEAD)</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tbody><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td align="right" class="memItemLeft" valign="top">typedef struct <a class="el" href="structpsa__aead__operation__s.html">psa_aead_operation_s</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a></td></tr>
<tr class="memdesc:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td class="mdescLeft"> </td><td class="mdescRight">The type of the state data structure for multipart AEAD operations.  <a href="#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">More...</a><br/></td></tr>
<tr class="separator:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td align="right" class="memItemLeft" valign="top">typedef struct <a class="el" href="structpsa__aead__operation__s.html">psa_aead_operation_s</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a></td></tr>
<tr class="memdesc:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td class="mdescLeft"> </td><td class="mdescRight">The type of the state data structure for multipart AEAD operations.  <a href="#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">More...</a><br/></td></tr>
<tr class="separator:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td align="right" class="memItemLeft" valign="top">typedef struct <a class="el" href="structpsa__aead__operation__s.html">psa_aead_operation_s</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a></td></tr>
<tr class="memdesc:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td class="mdescLeft"> </td><td class="mdescRight">The type of the state data structure for multipart AEAD operations.  <a href="#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">More...</a><br/></td></tr>
<tr class="separator:ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"><td class="memSeparator" colspan="2"> </td></tr>
</tbody></table><table class="memberdecls">
<tbody><tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae72e1eb3c2da3ebd843bb9c8db8df509"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gae72e1eb3c2da3ebd843bb9c8db8df509">psa_aead_encrypt</a> (mbedtls_svc_key_id_t key, <a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg, const uint8_t *nonce, size_t nonce_length, const uint8_t *additional_data, size_t additional_data_length, const uint8_t *plaintext, size_t plaintext_length, uint8_t *ciphertext, size_t ciphertext_size, size_t *ciphertext_length)</td></tr>
<tr class="memdesc:gae72e1eb3c2da3ebd843bb9c8db8df509"><td class="mdescLeft"> </td><td class="mdescRight">Process an authenticated encryption operation.  <a href="#gae72e1eb3c2da3ebd843bb9c8db8df509">More...</a><br/></td></tr>
<tr class="separator:gae72e1eb3c2da3ebd843bb9c8db8df509"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:gae799f6196a22d50c216c947e0320d3ba"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gae799f6196a22d50c216c947e0320d3ba">psa_aead_decrypt</a> (mbedtls_svc_key_id_t key, <a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg, const uint8_t *nonce, size_t nonce_length, const uint8_t *additional_data, size_t additional_data_length, const uint8_t *ciphertext, size_t ciphertext_length, uint8_t *plaintext, size_t plaintext_size, size_t *plaintext_length)</td></tr>
<tr class="memdesc:gae799f6196a22d50c216c947e0320d3ba"><td class="mdescLeft"> </td><td class="mdescRight">Process an authenticated decryption operation.  <a href="#gae799f6196a22d50c216c947e0320d3ba">More...</a><br/></td></tr>
<tr class="separator:gae799f6196a22d50c216c947e0320d3ba"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga286b61e83f1bdd5017568c4fd1939f89"><td align="right" class="memItemLeft" valign="top">static <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga286b61e83f1bdd5017568c4fd1939f89">psa_aead_operation_init</a> (void)</td></tr>
<tr class="memdesc:ga286b61e83f1bdd5017568c4fd1939f89"><td class="mdescLeft"> </td><td class="mdescRight">Return an initial value for an AEAD operation object.  <a href="#ga286b61e83f1bdd5017568c4fd1939f89">More...</a><br/></td></tr>
<tr class="separator:ga286b61e83f1bdd5017568c4fd1939f89"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga2732c40ce8f3619d41359a329e9b46c4"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4">psa_aead_encrypt_setup</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, mbedtls_svc_key_id_t key, <a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg)</td></tr>
<tr class="memdesc:ga2732c40ce8f3619d41359a329e9b46c4"><td class="mdescLeft"> </td><td class="mdescRight">Set the key for a multipart authenticated encryption operation.  <a href="#ga2732c40ce8f3619d41359a329e9b46c4">More...</a><br/></td></tr>
<tr class="separator:ga2732c40ce8f3619d41359a329e9b46c4"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:gaaa5c5018e67a7a6514b7e76b9a14de26"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26">psa_aead_decrypt_setup</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, mbedtls_svc_key_id_t key, <a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> alg)</td></tr>
<tr class="memdesc:gaaa5c5018e67a7a6514b7e76b9a14de26"><td class="mdescLeft"> </td><td class="mdescRight">Set the key for a multipart authenticated decryption operation.  <a href="#gaaa5c5018e67a7a6514b7e76b9a14de26">More...</a><br/></td></tr>
<tr class="separator:gaaa5c5018e67a7a6514b7e76b9a14de26"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga5799df1c555efd35970b65be51cb07d1"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1">psa_aead_generate_nonce</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, uint8_t *nonce, size_t nonce_size, size_t *nonce_length)</td></tr>
<tr class="memdesc:ga5799df1c555efd35970b65be51cb07d1"><td class="mdescLeft"> </td><td class="mdescRight">Generate a random nonce for an authenticated encryption operation.  <a href="#ga5799df1c555efd35970b65be51cb07d1">More...</a><br/></td></tr>
<tr class="separator:ga5799df1c555efd35970b65be51cb07d1"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga59132751a6f843d038924cb217b5e13b"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b">psa_aead_set_nonce</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, const uint8_t *nonce, size_t nonce_length)</td></tr>
<tr class="memdesc:ga59132751a6f843d038924cb217b5e13b"><td class="mdescLeft"> </td><td class="mdescRight">Set the nonce for an authenticated encryption or decryption operation.  <a href="#ga59132751a6f843d038924cb217b5e13b">More...</a><br/></td></tr>
<tr class="separator:ga59132751a6f843d038924cb217b5e13b"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:gad3431e28d05002c2a7b0760610176050"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050">psa_aead_set_lengths</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, size_t ad_length, size_t plaintext_length)</td></tr>
<tr class="memdesc:gad3431e28d05002c2a7b0760610176050"><td class="mdescLeft"> </td><td class="mdescRight">Declare the lengths of the message and additional data for AEAD.  <a href="#gad3431e28d05002c2a7b0760610176050">More...</a><br/></td></tr>
<tr class="separator:gad3431e28d05002c2a7b0760610176050"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga6d0eed03f832e5c9c91cb8adf2882569"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569">psa_aead_update_ad</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, const uint8_t *input, size_t input_length)</td></tr>
<tr class="memdesc:ga6d0eed03f832e5c9c91cb8adf2882569"><td class="mdescLeft"> </td><td class="mdescRight">Pass additional data to an active AEAD operation.  <a href="#ga6d0eed03f832e5c9c91cb8adf2882569">More...</a><br/></td></tr>
<tr class="separator:ga6d0eed03f832e5c9c91cb8adf2882569"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:gaf6d49864951ca42136b4a9b71ea26e5c"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c">psa_aead_update</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, const uint8_t *input, size_t input_length, uint8_t *output, size_t output_size, size_t *output_length)</td></tr>
<tr class="memdesc:gaf6d49864951ca42136b4a9b71ea26e5c"><td class="mdescLeft"> </td><td class="mdescRight">Encrypt or decrypt a message fragment in an active AEAD operation.  <a href="#gaf6d49864951ca42136b4a9b71ea26e5c">More...</a><br/></td></tr>
<tr class="separator:gaf6d49864951ca42136b4a9b71ea26e5c"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:ga759791bbe1763b377c3b5447641f1fc8"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8">psa_aead_finish</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, uint8_t *ciphertext, size_t ciphertext_size, size_t *ciphertext_length, uint8_t *tag, size_t tag_size, size_t *tag_length)</td></tr>
<tr class="memdesc:ga759791bbe1763b377c3b5447641f1fc8"><td class="mdescLeft"> </td><td class="mdescRight">Finish encrypting a message in an AEAD operation.  <a href="#ga759791bbe1763b377c3b5447641f1fc8">More...</a><br/></td></tr>
<tr class="separator:ga759791bbe1763b377c3b5447641f1fc8"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:gae0280e2e61a185b893c36d858453f0d0"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0">psa_aead_verify</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation, uint8_t *plaintext, size_t plaintext_size, size_t *plaintext_length, const uint8_t *tag, size_t tag_length)</td></tr>
<tr class="memdesc:gae0280e2e61a185b893c36d858453f0d0"><td class="mdescLeft"> </td><td class="mdescRight">Finish authenticating and decrypting a message in an AEAD operation.  <a href="#gae0280e2e61a185b893c36d858453f0d0">More...</a><br/></td></tr>
<tr class="separator:gae0280e2e61a185b893c36d858453f0d0"><td class="memSeparator" colspan="2"> </td></tr>
<tr class="memitem:gae8a5f93d92318c8f592ee9fbb9d36ba0"><td align="right" class="memItemLeft" valign="top"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> </td><td class="memItemRight" valign="bottom"><a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0">psa_aead_abort</a> (<a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> *operation)</td></tr>
<tr class="memdesc:gae8a5f93d92318c8f592ee9fbb9d36ba0"><td class="mdescLeft"> </td><td class="mdescRight">Abort an AEAD operation.  <a href="#gae8a5f93d92318c8f592ee9fbb9d36ba0">More...</a><br/></td></tr>
<tr class="separator:gae8a5f93d92318c8f592ee9fbb9d36ba0"><td class="memSeparator" colspan="2"> </td></tr>
</tbody></table>
<a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">typedef struct <a class="el" href="structpsa__aead__operation__s.html">psa_aead_operation_s</a> <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>The type of the state data structure for multipart AEAD operations. </p>
<p>Before calling any function on an AEAD operation object, the application must initialize it by any of the following means:</p><ul>
<li>Set the structure to all-bits-zero, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> memset(&amp;operation, 0, sizeof(operation));</div></div><!-- fragment --></li>
<li>Initialize the structure to logical zero values, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation = {0};</div></div><!-- fragment --></li>
<li>Initialize the structure to the initializer #PSA_AEAD_OPERATION_INIT, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation = PSA_AEAD_OPERATION_INIT;</div></div><!-- fragment --></li>
<li>Assign the result of the function <a class="el" href="group__aead.html#ga286b61e83f1bdd5017568c4fd1939f89" title="Return an initial value for an AEAD operation object. ">psa_aead_operation_init()</a> to the structure, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> operation = psa_aead_operation_init();</div></div><!-- fragment --></li>
</ul>
<p>This is an implementation-defined <code>struct</code>. Applications should not make any assumptions about the content of this structure. Implementation details can change in future versions without notice. </p>

<p>Definition at line <a class="el" href="_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto_8h_source.html#l02187">2187</a> of file <a class="el" href="_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___l_a_t_e_s_t_2include_2psa_2crypto_8h_source.html">TARGET_TFM/TARGET_TFM_LATEST/include/psa/crypto.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">typedef struct <a class="el" href="structpsa__aead__operation__s.html">psa_aead_operation_s</a> <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>The type of the state data structure for multipart AEAD operations. </p>
<p>Before calling any function on an AEAD operation object, the application must initialize it by any of the following means:</p><ul>
<li>Set the structure to all-bits-zero, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> memset(&amp;operation, 0, sizeof(operation));</div></div><!-- fragment --></li>
<li>Initialize the structure to logical zero values, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation = {0};</div></div><!-- fragment --></li>
<li>Initialize the structure to the initializer #PSA_AEAD_OPERATION_INIT, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation = PSA_AEAD_OPERATION_INIT;</div></div><!-- fragment --></li>
<li>Assign the result of the function <a class="el" href="group__aead.html#ga286b61e83f1bdd5017568c4fd1939f89" title="Return an initial value for an AEAD operation object. ">psa_aead_operation_init()</a> to the structure, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> operation = psa_aead_operation_init();</div></div><!-- fragment --></li>
</ul>
<p>This is an implementation-defined <code>struct</code>. Applications should not make any assumptions about the content of this structure except as directed by the documentation of a specific implementation. </p>

<p>Definition at line <a class="el" href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto_8h_source.html#l02215">2215</a> of file <a class="el" href="_t_a_r_g_e_t___m_b_e_d___p_s_a___s_r_v_2inc_2psa_2crypto_8h_source.html">TARGET_MBED_PSA_SRV/inc/psa/crypto.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga14f6a01afbaa8c5b3d8c5d345cbaa3ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname">typedef struct <a class="el" href="structpsa__aead__operation__s.html">psa_aead_operation_s</a> <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>The type of the state data structure for multipart AEAD operations. </p>
<p>Before calling any function on an AEAD operation object, the application must initialize it by any of the following means:</p><ul>
<li>Set the structure to all-bits-zero, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> memset(&amp;operation, 0, sizeof(operation));</div></div><!-- fragment --></li>
<li>Initialize the structure to logical zero values, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation = {0};</div></div><!-- fragment --></li>
<li>Initialize the structure to the initializer #PSA_AEAD_OPERATION_INIT, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation = PSA_AEAD_OPERATION_INIT;</div></div><!-- fragment --></li>
<li>Assign the result of the function <a class="el" href="group__aead.html#ga286b61e83f1bdd5017568c4fd1939f89" title="Return an initial value for an AEAD operation object. ">psa_aead_operation_init()</a> to the structure, for example: <div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span> psa_aead_operation_t operation;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span> operation = psa_aead_operation_init();</div></div><!-- fragment --></li>
</ul>
<p>This is an implementation-defined <code>struct</code>. Applications should not make any assumptions about the content of this structure except as directed by the documentation of a specific implementation. </p>

<p>Definition at line <a class="el" href="_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___v1__0_2include_2psa_2crypto_8h_source.html#l02247">2247</a> of file <a class="el" href="_t_a_r_g_e_t___t_f_m_2_t_a_r_g_e_t___t_f_m___v1__0_2include_2psa_2crypto_8h_source.html">TARGET_TFM/TARGET_TFM_V1_0/include/psa/crypto.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gae8a5f93d92318c8f592ee9fbb9d36ba0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_abort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Abort an AEAD operation. </p>
<p>Aborting an operation frees all associated resources except for the <code>operation</code> structure itself. Once aborted, the operation object can be reused for another operation by calling <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> or <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a> again.</p>
<p>You may call this function any time after the operation object has been initialized as described in <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a>.</p>
<p>In particular, calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a> after the operation has been terminated by a call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>, <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a> or <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> is safe and has no effect.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Initialized AEAD operation.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gae799f6196a22d50c216c947e0320d3ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_decrypt </td>
          <td>(</td>
          <td class="paramtype">mbedtls_svc_key_id_t </td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> </td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>nonce_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>additional_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>additional_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>ciphertext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>plaintext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>plaintext_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Process an authenticated decryption operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="group__policy.html#gac3f2d2e5983db1edde9f142ca9bf8e6a" title="Whether the key may be used to decrypt a message. ">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">additional_data</td><td>Additional data that has been authenticated but not encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ciphertext</td><td>Data that has been authenticated and encrypted. For algorithms where the encrypted data and the authentication tag are defined as separate inputs, the buffer must contain the encrypted data followed by the authentication tag. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_length</td><td>Size of <code>ciphertext</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext</td><td>Output buffer for the decrypted data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_size</td><td>Size of the <code>plaintext</code> buffer in bytes. This must be at least #PSA_AEAD_DECRYPT_OUTPUT_SIZE(<code>alg</code>, <code>ciphertext_length</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext_length</td><td>On success, the size of the output in the <code>plaintext</code> buffer.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a></td><td>The ciphertext is not authentic. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>key</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>plaintext_size</code> or <code>nonce_length</code> is too small </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="group__policy.html#gac3f2d2e5983db1edde9f142ca9bf8e6a" title="Whether the key may be used to decrypt a message. ">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">additional_data</td><td>Additional data that has been authenticated but not encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ciphertext</td><td>Data that has been authenticated and encrypted. For algorithms where the encrypted data and the authentication tag are defined as separate inputs, the buffer must contain the encrypted data followed by the authentication tag. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_length</td><td>Size of <code>ciphertext</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext</td><td>Output buffer for the decrypted data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_size</td><td>Size of the <code>plaintext</code> buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is #PSA_AEAD_DECRYPT_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>, <code>ciphertext_length</code>) where <code>key_type</code> is the type of <code>key</code>.</li>
<li>#PSA_AEAD_DECRYPT_OUTPUT_MAX_SIZE(<code>ciphertext_length</code>) evaluates to the maximum plaintext size of any supported AEAD decryption. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext_length</td><td>On success, the size of the output in the <code>plaintext</code> buffer.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a></td><td>The ciphertext is not authentic. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>key</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>plaintext_size</code> is too small. #PSA_AEAD_DECRYPT_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>, <code>ciphertext_length</code>) or #PSA_AEAD_DECRYPT_OUTPUT_MAX_SIZE(<code>ciphertext_length</code>) can be used to determine the required buffer size. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir"></td><td class="paramname">handle</td><td>Handle to the key to use for the operation. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">additional_data</td><td>Additional data that has been authenticated but not encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ciphertext</td><td>Data that has been authenticated and encrypted. For algorithms where the encrypted data and the authentication tag are defined as separate inputs, the buffer must contain the encrypted data followed by the authentication tag. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_length</td><td>Size of <code>ciphertext</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext</td><td>Output buffer for the decrypted data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_size</td><td>Size of the <code>plaintext</code> buffer in bytes. This must be at least #PSA_AEAD_DECRYPT_OUTPUT_SIZE(<code>alg</code>, <code>ciphertext_length</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext_length</td><td>On success, the size of the output in the <code>plaintext</code> buffer.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a></td><td>The ciphertext is not authentic. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>handle</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>plaintext_size</code> or <code>nonce_length</code> is too small </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaaa5c5018e67a7a6514b7e76b9a14de26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_decrypt_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mbedtls_svc_key_id_t </td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> </td>
          <td class="paramname"><em>alg</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Set the key for a multipart authenticated decryption operation. </p>
<p>The sequence of operations to decrypt a message with authentication is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a>, e.g. #PSA_AEAD_OPERATION_INIT.</li>
<li>Call <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a> to specify the algorithm and key.</li>
<li>If needed, call <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> to specify the length of the inputs to the subsequent calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> and <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>. See the documentation of <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> for details.</li>
<li>Call <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a> with the nonce for the decryption.</li>
<li>Call <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> zero, one or more times, passing a fragment of the non-encrypted additional authenticated data each time.</li>
<li>Call <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> zero, one or more times, passing a fragment of the ciphertext to decrypt each time.</li>
<li>Call <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>. The application may call <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a>.</li>
<li>A call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="group__policy.html#gac3f2d2e5983db1edde9f142ca9bf8e6a" title="Whether the key may be used to decrypt a message. ">PSA_KEY_USAGE_DECRYPT</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true).</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be inactive). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>key</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<p>The sequence of operations to decrypt a message with authentication is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a>, e.g. #PSA_AEAD_OPERATION_INIT.</li>
<li>Call <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a> to specify the algorithm and key.</li>
<li>If needed, call <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> to specify the length of the inputs to the subsequent calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> and <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>. See the documentation of <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> for details.</li>
<li>Call <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a> with the nonce for the decryption.</li>
<li>Call <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> zero, one or more times, passing a fragment of the non-encrypted additional authenticated data each time.</li>
<li>Call <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> zero, one or more times, passing a fragment of the ciphertext to decrypt each time.</li>
<li>Call <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>. The application may call <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a>.</li>
<li>A call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">handle</td><td>Handle to the key to use for the operation. It must remain valid until the operation terminates. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true).</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be inactive). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>handle</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gae72e1eb3c2da3ebd843bb9c8db8df509"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_encrypt </td>
          <td>(</td>
          <td class="paramtype">mbedtls_svc_key_id_t </td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> </td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>nonce_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>additional_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>additional_data_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>plaintext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>ciphertext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>ciphertext_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Process an authenticated encryption operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="group__policy.html#ga75153b296d045d529d97203a6a995dad" title="Whether the key may be used to encrypt a message. ">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">additional_data</td><td>Additional data that will be authenticated but not encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plaintext</td><td>Data that will be authenticated and encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_length</td><td>Size of <code>plaintext</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext</td><td>Output buffer for the authenticated and encrypted data. The additional data is not part of this output. For algorithms where the encrypted data and the authentication tag are defined as separate outputs, the authentication tag is appended to the encrypted data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_size</td><td>Size of the <code>ciphertext</code> buffer in bytes. This must be at least #PSA_AEAD_ENCRYPT_OUTPUT_SIZE(<code>alg</code>, <code>plaintext_length</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext_length</td><td>On success, the size of the output in the <code>ciphertext</code> buffer.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>key</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>ciphertext_size</code> is too small </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must allow the usage <a class="el" href="group__policy.html#ga75153b296d045d529d97203a6a995dad" title="Whether the key may be used to encrypt a message. ">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">additional_data</td><td>Additional data that will be authenticated but not encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plaintext</td><td>Data that will be authenticated and encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_length</td><td>Size of <code>plaintext</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext</td><td>Output buffer for the authenticated and encrypted data. The additional data is not part of this output. For algorithms where the encrypted data and the authentication tag are defined as separate outputs, the authentication tag is appended to the encrypted data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_size</td><td>Size of the <code>ciphertext</code> buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is #PSA_AEAD_ENCRYPT_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>, <code>plaintext_length</code>) where <code>key_type</code> is the type of <code>key</code>.</li>
<li>#PSA_AEAD_ENCRYPT_OUTPUT_MAX_SIZE(<code>plaintext_length</code>) evaluates to the maximum ciphertext size of any supported AEAD encryption. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext_length</td><td>On success, the size of the output in the <code>ciphertext</code> buffer.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>key</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>ciphertext_size</code> is too small. #PSA_AEAD_ENCRYPT_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>, <code>plaintext_length</code>) or #PSA_AEAD_ENCRYPT_OUTPUT_MAX_SIZE(<code>plaintext_length</code>) can be used to determine the required buffer size. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir"></td><td class="paramname">handle</td><td>Handle to the key to use for the operation. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Nonce or IV to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">additional_data</td><td>Additional data that will be authenticated but not encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">additional_data_length</td><td>Size of <code>additional_data</code> in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">plaintext</td><td>Data that will be authenticated and encrypted. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_length</td><td>Size of <code>plaintext</code> in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext</td><td>Output buffer for the authenticated and encrypted data. The additional data is not part of this output. For algorithms where the encrypted data and the authentication tag are defined as separate outputs, the authentication tag is appended to the encrypted data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_size</td><td>Size of the <code>ciphertext</code> buffer in bytes. This must be at least #PSA_AEAD_ENCRYPT_OUTPUT_SIZE(<code>alg</code>, <code>plaintext_length</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext_length</td><td>On success, the size of the output in the <code>ciphertext</code> buffer.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>handle</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td><code>ciphertext_size</code> is too small </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga2732c40ce8f3619d41359a329e9b46c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_encrypt_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">mbedtls_svc_key_id_t </td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__crypto__types.html#gac2e4d47f1300d73c2f829a6d99252d69">psa_algorithm_t</a> </td>
          <td class="paramname"><em>alg</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Set the key for a multipart authenticated encryption operation. </p>
<p>The sequence of operations to encrypt a message with authentication is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a>, e.g. #PSA_AEAD_OPERATION_INIT.</li>
<li>Call <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> to specify the algorithm and key.</li>
<li>If needed, call <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> to specify the length of the inputs to the subsequent calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> and <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>. See the documentation of <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> for details.</li>
<li>Call either <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> or <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a> to generate or set the nonce. You should use <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> unless the protocol you are implementing requires a specific nonce value.</li>
<li>Call <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> zero, one or more times, passing a fragment of the non-encrypted additional authenticated data each time.</li>
<li>Call <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> zero, one or more times, passing a fragment of the message to encrypt each time.</li>
<li>Call <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>. The application may call <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a>.</li>
<li>A call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>Identifier of the key to use for the operation. It must remain valid until the operation terminates. It must allow the usage <a class="el" href="group__policy.html#ga75153b296d045d529d97203a6a995dad" title="Whether the key may be used to encrypt a message. ">PSA_KEY_USAGE_ENCRYPT</a>. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true).</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be inactive). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>key</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<p>The sequence of operations to encrypt a message with authentication is as follows:</p><ol type="1">
<li>Allocate an operation object which will be passed to all the functions listed here.</li>
<li>Initialize the operation object with one of the methods described in the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a>, e.g. #PSA_AEAD_OPERATION_INIT.</li>
<li>Call <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> to specify the algorithm and key.</li>
<li>If needed, call <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> to specify the length of the inputs to the subsequent calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> and <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>. See the documentation of <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a> for details.</li>
<li>Call either <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> or <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a> to generate or set the nonce. You should use <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> unless the protocol you are implementing requires a specific nonce value.</li>
<li>Call <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> zero, one or more times, passing a fragment of the non-encrypted additional authenticated data each time.</li>
<li>Call <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> zero, one or more times, passing a fragment of the message to encrypt each time.</li>
<li>Call <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a>.</li>
</ol>
<p>If an error occurs at any step after a call to <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>, the operation will need to be reset by a call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>. The application may call <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a> at any time after the operation has been initialized.</p>
<p>After a successful call to <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>, the application must eventually terminate the operation. The following events terminate an operation:</p><ul>
<li>A successful call to <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a>.</li>
<li>A call to <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>The operation object to set up. It must have been initialized as per the documentation for <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed" title="The type of the state data structure for multipart AEAD operations. ">psa_aead_operation_t</a> and not yet in use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">handle</td><td>Handle to the key to use for the operation. It must remain valid until the operation terminates. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">alg</td><td>The AEAD algorithm to compute (<code>PSA_ALG_XXX</code> value such that <a class="el" href="group__crypto__types.html#ga09dbb078cbad35a92a925ac96afcd4ab" title="Whether the specified algorithm is an authenticated encryption with associated data (AEAD) algorithm...">PSA_ALG_IS_AEAD</a>(<code>alg</code>) is true).</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be inactive). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadf22718935657c2c3168c228204085f9" title="The key handle is not valid. ">PSA_ERROR_INVALID_HANDLE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga4d1b8dd8526177a15a210b7afc1accb1" title="The requested action is denied by a policy. ">PSA_ERROR_NOT_PERMITTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td><code>handle</code> is not compatible with <code>alg</code>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga1dcc6d130633ed5db8942257581b55dd" title="The requested operation or a parameter is not supported by this implementation. ">PSA_ERROR_NOT_SUPPORTED</a></td><td><code>alg</code> is not supported or is not an AEAD algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga759791bbe1763b377c3b5447641f1fc8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>ciphertext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>ciphertext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>ciphertext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>tag_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>tag_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Finish encrypting a message in an AEAD operation. </p>
<p>The operation must have been set up with <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>.</p>
<p>This function finishes the authentication of the additional data formed by concatenating the inputs passed to preceding calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> with the plaintext formed by concatenating the inputs passed to preceding calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</p>
<p>This function has two output buffers:</p><ul>
<li><code>ciphertext</code> contains trailing ciphertext that was buffered from preceding calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</li>
<li><code>tag</code> contains the authentication tag. Its length is always #PSA_AEAD_TAG_LENGTH(<code>alg</code>) where <code>alg</code> is the AEAD algorithm that the operation performs.</li>
</ul>
<p>When this function returns successfuly, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext</td><td>Buffer where the last part of the ciphertext is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_size</td><td>Size of the <code>ciphertext</code> buffer in bytes. This must be at least #PSA_AEAD_FINISH_OUTPUT_SIZE(<code>alg</code>) where <code>alg</code> is the algorithm that is being calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext_length</td><td>On success, the number of bytes of returned ciphertext. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tag</td><td>Buffer where the authentication tag is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tag_size</td><td>Size of the <code>tag</code> buffer in bytes. This must be at least #PSA_AEAD_TAG_LENGTH(<code>alg</code>) where <code>alg</code> is the algorithm that is being calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tag_length</td><td>On success, the number of bytes that make up the returned tag.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be an active encryption operation with a nonce set). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>ciphertext</code> or <code>tag</code> buffer is too small. You can determine a sufficient buffer size for <code>ciphertext</code> by calling #PSA_AEAD_FINISH_OUTPUT_SIZE(<code>alg</code>) where <code>alg</code> is the algorithm that is being calculated. You can determine a sufficient buffer size for <code>tag</code> by calling #PSA_AEAD_TAG_LENGTH(<code>alg</code>). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> so far is less than the plaintext length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<p>The operation must have been set up with <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>.</p>
<p>This function finishes the authentication of the additional data formed by concatenating the inputs passed to preceding calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> with the plaintext formed by concatenating the inputs passed to preceding calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</p>
<p>This function has two output buffers:</p><ul>
<li><code>ciphertext</code> contains trailing ciphertext that was buffered from preceding calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</li>
<li><code>tag</code> contains the authentication tag.</li>
</ul>
<p>When this function returns successfuly, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext</td><td>Buffer where the last part of the ciphertext is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphertext_size</td><td>Size of the <code>ciphertext</code> buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is #PSA_AEAD_FINISH_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation.</li>
<li>#PSA_AEAD_FINISH_OUTPUT_MAX_SIZE evaluates to the maximum output size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ciphertext_length</td><td>On success, the number of bytes of returned ciphertext. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tag</td><td>Buffer where the authentication tag is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tag_size</td><td>Size of the <code>tag</code> buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>The exact tag size is #PSA_AEAD_TAG_LENGTH(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) where <code>key_type</code> and <code>key_bits</code> are the type and bit-size of the key, and <code>alg</code> is the algorithm that were used in the call to <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a>.</li>
<li>#PSA_AEAD_TAG_MAX_SIZE evaluates to the maximum tag size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tag_length</td><td>On success, the number of bytes that make up the returned tag.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be an active encryption operation with a nonce set). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>ciphertext</code> or <code>tag</code> buffer is too small. #PSA_AEAD_FINISH_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>) or #PSA_AEAD_FINISH_OUTPUT_MAX_SIZE can be used to determine the required <code>ciphertext</code> buffer size. #PSA_AEAD_TAG_LENGTH(<code>key_type</code>, <code>key_bits</code>, <code>alg</code>) or #PSA_AEAD_TAG_MAX_SIZE can be used to determine the required <code>tag</code> buffer size. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> so far is less than the plaintext length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga5799df1c555efd35970b65be51cb07d1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_generate_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>nonce_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>nonce_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Generate a random nonce for an authenticated encryption operation. </p>
<p>This function generates a random nonce for the authenticated encryption operation with an appropriate size for the chosen algorithm, key type and key size.</p>
<p>The application must call <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nonce</td><td>Buffer where the generated nonce is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_size</td><td>Size of the <code>nonce</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nonce_length</td><td>On success, the number of bytes of the generated nonce.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be an active aead encrypt operation, with no nonce set). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>nonce</code> buffer is too small. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga286b61e83f1bdd5017568c4fd1939f89"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tbody><tr>
  <td class="mlabels-left">
      <table class="memname">
        <tbody><tr>
          <td class="memname">static <a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> psa_aead_operation_init </td>
          <td>(</td>
          <td class="paramtype">void </td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </tbody></table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</tbody></table>
</div><div class="memdoc">

<p>Return an initial value for an AEAD operation object. </p>

</div>
</div>
<a class="anchor" id="gad3431e28d05002c2a7b0760610176050"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_set_lengths </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>ad_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>plaintext_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Declare the lengths of the message and additional data for AEAD. </p>
<p>The application must call this function before calling <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> or <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> if the algorithm for the operation requires it. If the algorithm does not require it, calling this function is optional, but if this function is called then the implementation must enforce the lengths.</p>
<p>You may call this function before or after setting the nonce with <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a> or <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a>.</p>
<ul>
<li>For <a class="el" href="group__crypto__types.html#gac2c0e7d21f1b2df5e76bcb4a8f84273c" title="The CCM authenticated encryption algorithm. ">PSA_ALG_CCM</a>, calling this function is required.</li>
<li>For the other AEAD algorithms defined in this specification, calling this function is not required.</li>
<li>For vendor-defined algorithm, refer to the vendor documentation.</li>
</ul>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ad_length</td><td>Size of the non-encrypted additional authenticated data in bytes. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_length</td><td>Size of the plaintext to encrypt in bytes.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active, and <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> and <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> must not have been called yet). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>At least one of the lengths is not acceptable for the chosen algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga59132751a6f843d038924cb217b5e13b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_set_nonce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>nonce_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Set the nonce for an authenticated encryption or decryption operation. </p>
<p>This function sets the nonce for the authenticated encryption or decryption operation.</p>
<p>The application must call <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> or <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a> before calling this function.</p>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>When encrypting, applications should use <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> instead of this function, unless implementing a protocol that requires a non-random IV.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>Buffer containing the nonce to use. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">nonce_length</td><td>Size of the nonce in bytes.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active, with no nonce set). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The size of <code>nonce</code> is not acceptable for the chosen algorithm. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gaf6d49864951ca42136b4a9b71ea26e5c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>input_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>output_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>output_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Encrypt or decrypt a message fragment in an active AEAD operation. </p>
<p>Before calling this function, you must:</p><ol type="1">
<li>Call either <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> or <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>. The choice of setup function determines whether this function encrypts or decrypts its input.</li>
<li>Set the nonce with <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> or <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a>.</li>
<li>Call <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> to pass all the additional data.</li>
</ol>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting, until <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> has returned <a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a>, there is no guarantee that the input is valid. Therefore, until you have called <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> and it has returned <a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a>:<ul>
<li>Do not use the output in any way other than storing it in a confidential location. If you take any action that depends on the tentative decrypted data, this action will need to be undone if the input turns out not to be valid. Furthermore, if an adversary can observe that this action took place (for example through timing), they may be able to use this fact as an oracle to decrypt any message encrypted with the same key.</li>
<li>In particular, do not copy the output anywhere but to a memory or storage space that you have exclusive access to.</li>
</ul>
</dd></dl>
<p>This function does not require the input to be aligned to any particular block boundary. If the implementation can only process a whole block at a time, it must consume all the input provided, but it may delay the end of the corresponding output until a subsequent call to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>, <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a> or <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> provides sufficient input. The amount of data that can be delayed in this way is bounded by #PSA_AEAD_UPDATE_OUTPUT_SIZE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>Buffer containing the message fragment to encrypt or decrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Buffer where the output is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">output_size</td><td>Size of the <code>output</code> buffer in bytes. This must be at least #PSA_AEAD_UPDATE_OUTPUT_SIZE(<code>alg</code>, <code>input_length</code>) where <code>alg</code> is the algorithm that is being calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active, have a nonce set, and have lengths set if required by the algorithm). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>output</code> buffer is too small. You can determine a sufficient buffer size by calling #PSA_AEAD_UPDATE_OUTPUT_SIZE(<code>alg</code>, <code>input_length</code>) where <code>alg</code> is the algorithm that is being calculated. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total input length overflows the plaintext length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<p>Before calling this function, you must:</p><ol type="1">
<li>Call either <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> or <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>. The choice of setup function determines whether this function encrypts or decrypts its input.</li>
<li>Set the nonce with <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> or <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a>.</li>
<li>Call <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> to pass all the additional data.</li>
</ol>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting, until <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> has returned <a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a>, there is no guarantee that the input is valid. Therefore, until you have called <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> and it has returned <a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a>:<ul>
<li>Do not use the output in any way other than storing it in a confidential location. If you take any action that depends on the tentative decrypted data, this action will need to be undone if the input turns out not to be valid. Furthermore, if an adversary can observe that this action took place (for example through timing), they may be able to use this fact as an oracle to decrypt any message encrypted with the same key.</li>
<li>In particular, do not copy the output anywhere but to a memory or storage space that you have exclusive access to.</li>
</ul>
</dd></dl>
<p>This function does not require the input to be aligned to any particular block boundary. If the implementation can only process a whole block at a time, it must consume all the input provided, but it may delay the end of the corresponding output until a subsequent call to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>, <a class="el" href="group__aead.html#ga759791bbe1763b377c3b5447641f1fc8" title="Finish encrypting a message in an AEAD operation. ">psa_aead_finish()</a> or <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> provides sufficient input. The amount of data that can be delayed in this way is bounded by #PSA_AEAD_UPDATE_OUTPUT_SIZE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>Buffer containing the message fragment to encrypt or decrypt. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>Buffer where the output is to be written. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">output_size</td><td>Size of the <code>output</code> buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is #PSA_AEAD_UPDATE_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>, <code>input_length</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation.</li>
<li>#PSA_AEAD_UPDATE_OUTPUT_MAX_SIZE(<code>input_length</code>) evaluates to the maximum output size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_length</td><td>On success, the number of bytes that make up the returned output.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active, have a nonce set, and have lengths set if required by the algorithm). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>output</code> buffer is too small. #PSA_AEAD_UPDATE_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>, <code>input_length</code>) or #PSA_AEAD_UPDATE_OUTPUT_MAX_SIZE(<code>input_length</code>) can be used to determine the required buffer size. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total input length overflows the plaintext length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga6d0eed03f832e5c9c91cb8adf2882569"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_update_ad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>input_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Pass additional data to an active AEAD operation. </p>
<p>Additional data is authenticated, but not encrypted.</p>
<p>You may call this function multiple times to pass successive fragments of the additional data. You may not call this function after passing data to encrypt or decrypt with <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</p>
<p>Before calling this function, you must:</p><ol type="1">
<li>Call either <a class="el" href="group__aead.html#ga2732c40ce8f3619d41359a329e9b46c4" title="Set the key for a multipart authenticated encryption operation. ">psa_aead_encrypt_setup()</a> or <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>.</li>
<li>Set the nonce with <a class="el" href="group__aead.html#ga5799df1c555efd35970b65be51cb07d1" title="Generate a random nonce for an authenticated encryption operation. ">psa_aead_generate_nonce()</a> or <a class="el" href="group__aead.html#ga59132751a6f843d038924cb217b5e13b" title="Set the nonce for an authenticated encryption or decryption operation. ">psa_aead_set_nonce()</a>.</li>
</ol>
<p>If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="section warning"><dt>Warning</dt><dd>When decrypting, until <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> has returned <a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a>, there is no guarantee that the input is valid. Therefore, until you have called <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> and it has returned <a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a>, treat the input as untrusted and prepare to undo any action that depends on the input if <a class="el" href="group__aead.html#gae0280e2e61a185b893c36d858453f0d0" title="Finish authenticating and decrypting a message in an AEAD operation. ">psa_aead_verify()</a> returns an error status.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>Buffer containing the fragment of additional data. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">input_length</td><td>Size of the <code>input</code> buffer in bytes.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be active, have a nonce set, have lengths set if required by the algorithm, and <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> must not have been called yet). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total input length overflows the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gae0280e2e61a185b893c36d858453f0d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tbody><tr>
          <td class="memname"><a class="el" href="group__error.html#ga05676e70ba5c6a7565aff3c36677c1f9">psa_status_t</a> psa_aead_verify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__aead.html#ga14f6a01afbaa8c5b3d8c5d345cbaa3ed">psa_aead_operation_t</a> * </td>
          <td class="paramname"><em>operation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t * </td>
          <td class="paramname"><em>plaintext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>plaintext_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t * </td>
          <td class="paramname"><em>plaintext_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t * </td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t </td>
          <td class="paramname"><em>tag_length</em> </td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </tbody></table>
</div><div class="memdoc">

<p>Finish authenticating and decrypting a message in an AEAD operation. </p>
<p>The operation must have been set up with <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>.</p>
<p>This function finishes the authenticated decryption of the message components:</p>
<ul>
<li>The additional data consisting of the concatenation of the inputs passed to preceding calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a>.</li>
<li>The ciphertext consisting of the concatenation of the inputs passed to preceding calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</li>
<li>The tag passed to this function call.</li>
</ul>
<p>If the authentication tag is correct, this function outputs any remaining plaintext and reports success. If the authentication tag is not correct, this function returns <a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a>.</p>
<p>When this function returns successfuly, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations shall make the best effort to ensure that the comparison between the actual tag and the expected tag is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext</td><td>Buffer where the last part of the plaintext is to be written. This is the remaining data from previous calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> that could not be processed until the end of the input. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_size</td><td>Size of the <code>plaintext</code> buffer in bytes. This must be at least #PSA_AEAD_VERIFY_OUTPUT_SIZE(<code>alg</code>) where <code>alg</code> is the algorithm that is being calculated. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext_length</td><td>On success, the number of bytes of returned plaintext. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>Buffer containing the authentication tag. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tag_length</td><td>Size of the <code>tag</code> buffer in bytes.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a></td><td>The calculations were successful, but the authentication tag is not correct. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be an active decryption operation with a nonce set). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>plaintext</code> buffer is too small. You can determine a sufficient buffer size for <code>plaintext</code> by calling #PSA_AEAD_VERIFY_OUTPUT_SIZE(<code>alg</code>) where <code>alg</code> is the algorithm that is being calculated. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> so far is less than the plaintext length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code.</td></tr>
  </tbody></table>
  </dd>
</dl>
<p>The operation must have been set up with <a class="el" href="group__aead.html#gaaa5c5018e67a7a6514b7e76b9a14de26" title="Set the key for a multipart authenticated decryption operation. ">psa_aead_decrypt_setup()</a>.</p>
<p>This function finishes the authenticated decryption of the message components:</p>
<ul>
<li>The additional data consisting of the concatenation of the inputs passed to preceding calls to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a>.</li>
<li>The ciphertext consisting of the concatenation of the inputs passed to preceding calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a>.</li>
<li>The tag passed to this function call.</li>
</ul>
<p>If the authentication tag is correct, this function outputs any remaining plaintext and reports success. If the authentication tag is not correct, this function returns <a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a>.</p>
<p>When this function returns successfuly, the operation becomes inactive. If this function returns an error status, the operation enters an error state and must be aborted by calling <a class="el" href="group__aead.html#gae8a5f93d92318c8f592ee9fbb9d36ba0" title="Abort an AEAD operation. ">psa_aead_abort()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>Implementations shall make the best effort to ensure that the comparison between the actual tag and the expected tag is performed in constant time.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tbody><tr><td class="paramdir">[in,out]</td><td class="paramname">operation</td><td>Active AEAD operation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext</td><td>Buffer where the last part of the plaintext is to be written. This is the remaining data from previous calls to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> that could not be processed until the end of the input. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">plaintext_size</td><td>Size of the <code>plaintext</code> buffer in bytes. This must be appropriate for the selected algorithm and key:<ul>
<li>A sufficient output size is #PSA_AEAD_VERIFY_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>) where <code>key_type</code> is the type of key and <code>alg</code> is the algorithm that were used to set up the operation.</li>
<li>#PSA_AEAD_VERIFY_OUTPUT_MAX_SIZE evaluates to the maximum output size of any supported AEAD algorithm. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">plaintext_length</td><td>On success, the number of bytes of returned plaintext. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>Buffer containing the authentication tag. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">tag_length</td><td>Size of the <code>tag</code> buffer in bytes.</td></tr>
  </tbody></table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tbody><tr><td class="paramname"><a class="el" href="group__error.html#ga4cc859e2c66ca381c7418db3527a65e1" title="The action was completed successfully. ">PSA_SUCCESS</a></td><td>Success. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga35927f755d232c4766de600f2c49e9f2" title="The signature, MAC or hash is incorrect. ">PSA_ERROR_INVALID_SIGNATURE</a></td><td>The calculations were successful, but the authentication tag is not correct. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The operation state is not valid (it must be an active decryption operation with a nonce set). </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga695025f4ec11249aee7ea3d0f65e01c8" title="An output buffer is too small. ">PSA_ERROR_BUFFER_TOO_SMALL</a></td><td>The size of the <code>plaintext</code> buffer is too small. #PSA_AEAD_VERIFY_OUTPUT_SIZE(<code>key_type</code>, <code>alg</code>) or #PSA_AEAD_VERIFY_OUTPUT_MAX_SIZE can be used to determine the required buffer size. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#ga6d0eed03f832e5c9c91cb8adf2882569" title="Pass additional data to an active AEAD operation. ">psa_aead_update_ad()</a> so far is less than the additional data length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga798df25a505ebf931f7bec1f80f1f85f" title="The parameters passed to the function are invalid. ">PSA_ERROR_INVALID_ARGUMENT</a></td><td>The total length of input to <a class="el" href="group__aead.html#gaf6d49864951ca42136b4a9b71ea26e5c" title="Encrypt or decrypt a message fragment in an active AEAD operation. ">psa_aead_update()</a> so far is less than the plaintext length that was previously specified with <a class="el" href="group__aead.html#gad3431e28d05002c2a7b0760610176050" title="Declare the lengths of the message and additional data for AEAD. ">psa_aead_set_lengths()</a>. </td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga91b2ad8a867517a2651f1b076c5216e5" title="There is not enough runtime memory. ">PSA_ERROR_INSUFFICIENT_MEMORY</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga5cdb6948371d49e916106249020ea3f7" title="There was a communication failure inside the implementation. ">PSA_ERROR_COMMUNICATION_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga08b10e70fa5ff0b05c631d9f8f6b2c6b" title="A hardware failure was detected. ">PSA_ERROR_HARDWARE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga116f4d4c6a9d9db3397991a8472d8950" title="A tampering attempt was detected. ">PSA_ERROR_CORRUPTION_DETECTED</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#gadd169a1af2707862b95fb9df91dfc37d" title="There was a storage failure that may have led to data loss. ">PSA_ERROR_STORAGE_FAILURE</a></td><td></td></tr>
    <tr><td class="paramname"><a class="el" href="group__error.html#ga933d40fa2a591004f2e93aa91e11db84" title="The requested action cannot be performed in the current state. ">PSA_ERROR_BAD_STATE</a></td><td>The library has not been previously initialized by <a class="el" href="group__initialization.html#ga2de150803fc2f7dc6101d5af7e921dd9" title="Library initialization. ">psa_crypto_init()</a>. It is implementation-dependent whether a failure to initialize results in this error code. </td></tr>
  </tbody></table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
        
    


        
<footer class="global-footer">
    <ul class="global-footer-media global-footer-row">
        <li>
            <a class="footer-media-icon" title="Twitter" href="https://twitter.com/ArmSoftwareDev">
                <span class="fab fa-twitter-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Twitter</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="YouTube" href="https://www.youtube.com/c/ArmSoftwareDevelopers">
                <span class="fab fa-youtube-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">YouTube</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Forum" href="http://forums.mbed.com/">
                <span class="fas fa-comments fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Forum</span>
            </a>
        </li>
        <li>
            <a class="footer-media-icon" title="Blog" href="http://blog.mbed.com/">
                <span class="fas fa-pen-square fa-2x"></span>
                <span class="global-footer-show-on-large-screens">Blog</span>
            </a>
        </li>
    </ul>

    <div class="global-footer-copyright global-footer-row">
        <div class="copyright-statement">Copyright © <script>document.write(new Date().getFullYear());</script> Arm Limited (or its affiliates).</div>
        <ul class="copyright-links">
            <li><a href="https://os.mbed.com/">Home</a></li>
            <li><a href="https://www.arm.com/company/policies/terms-and-conditions">Website Terms</a></li>
            <li><a href="https://www.arm.com/company/policies/privacy">Privacy</a></li>
            <li><a href="https://www.arm.com/company/policies/cookies">Cookies</a></li>
            <li><a href="http://www.arm.com/company/policies/trademarks">Trademarks</a></li>
        </ul>
    </div>
</footer>



    <div id="cookiemodule">
    <h5>Important Information for this Arm website</h5>
    <div id="cookiecontent">
        <p>
            This site uses cookies to store information on your computer.
            By continuing to use our site, you consent to our cookies.
            If you are not happy with the use of these cookies, please review our
            <a href="https://www.arm.com/company/policies/cookies">Cookie Policy</a>
            to learn how they can be disabled.
            By disabling cookies, some features of the site will not work.
        </p>
        <button id="acceptcookie">Accept and hide this message</button>
    </div>
</div>
<script src="../../../../static/js/cookie_law.js"></script>




    </body>

<!-- Mirrored from os.mbed.com/docs/mbed-os/v6.16/mbed-os-api-doxy/group__aead.html by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 16 Sep 2024 15:15:00 GMT -->
</html>
